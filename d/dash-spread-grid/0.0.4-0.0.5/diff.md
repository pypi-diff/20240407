# Comparing `tmp/dash_spread_grid-0.0.4.tar.gz` & `tmp/dash_spread_grid-0.0.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dash_spread_grid-0.0.4.tar", last modified: Sun Apr  7 03:21:35 2024, max compression
+gzip compressed data, was "dash_spread_grid-0.0.5.tar", last modified: Sun Apr  7 11:13:59 2024, max compression
```

## Comparing `dash_spread_grid-0.0.4.tar` & `dash_spread_grid-0.0.5.tar`

### file list

```diff
@@ -1,21 +1,21 @@
-drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-07 03:21:35.849815 dash_spread_grid-0.0.4/
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.4/LICENSE
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      393 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.4/MANIFEST.in
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      259 2024-04-07 03:21:35.849815 dash_spread_grid-0.0.4/PKG-INFO
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     3703 2024-01-20 12:13:37.000000 dash_spread_grid-0.0.4/README.md
-drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-07 03:21:35.839815 dash_spread_grid-0.0.4/dash_spread_grid/
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     3070 2024-04-07 03:21:28.000000 dash_spread_grid-0.0.4/dash_spread_grid/DashSpreadGrid.py
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2261 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.4/dash_spread_grid/__init__.py
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       78 2024-04-07 03:21:28.000000 dash_spread_grid-0.0.4/dash_spread_grid/_imports_.py
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)    49195 2024-04-07 03:21:27.000000 dash_spread_grid-0.0.4/dash_spread_grid/dash_spread_grid.min.js
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)   190498 2024-04-07 03:21:27.000000 dash_spread_grid-0.0.4/dash_spread_grid/dash_spread_grid.min.js.map
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     5579 2024-04-07 03:21:28.000000 dash_spread_grid-0.0.4/dash_spread_grid/metadata.json
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2332 2024-04-07 03:21:27.000000 dash_spread_grid-0.0.4/dash_spread_grid/package-info.json
-drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-07 03:21:35.849815 dash_spread_grid-0.0.4/dash_spread_grid.egg-info/
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      259 2024-04-07 03:21:35.000000 dash_spread_grid-0.0.4/dash_spread_grid.egg-info/PKG-INFO
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      457 2024-04-07 03:21:35.000000 dash_spread_grid-0.0.4/dash_spread_grid.egg-info/SOURCES.txt
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)        1 2024-04-07 03:21:35.000000 dash_spread_grid-0.0.4/dash_spread_grid.egg-info/dependency_links.txt
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       17 2024-04-07 03:21:35.000000 dash_spread_grid-0.0.4/dash_spread_grid.egg-info/top_level.txt
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2332 2024-04-07 03:21:19.000000 dash_spread_grid-0.0.4/package.json
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       38 2024-04-07 03:21:35.849815 dash_spread_grid-0.0.4/setup.cfg
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      510 2024-01-18 13:19:42.000000 dash_spread_grid-0.0.4/setup.py
+drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-07 11:13:59.250877 dash_spread_grid-0.0.5/
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.5/LICENSE
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      393 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.5/MANIFEST.in
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      259 2024-04-07 11:13:59.250877 dash_spread_grid-0.0.5/PKG-INFO
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     3703 2024-01-20 12:13:37.000000 dash_spread_grid-0.0.5/README.md
+drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-07 11:13:59.250877 dash_spread_grid-0.0.5/dash_spread_grid/
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     3070 2024-04-07 11:13:58.000000 dash_spread_grid-0.0.5/dash_spread_grid/DashSpreadGrid.py
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2261 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.5/dash_spread_grid/__init__.py
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       78 2024-04-07 11:13:58.000000 dash_spread_grid-0.0.5/dash_spread_grid/_imports_.py
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)    50314 2024-04-07 11:13:58.000000 dash_spread_grid-0.0.5/dash_spread_grid/dash_spread_grid.min.js
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)   194577 2024-04-07 11:13:58.000000 dash_spread_grid-0.0.5/dash_spread_grid/dash_spread_grid.min.js.map
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     5579 2024-04-07 11:13:58.000000 dash_spread_grid-0.0.5/dash_spread_grid/metadata.json
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2332 2024-04-07 11:13:58.000000 dash_spread_grid-0.0.5/dash_spread_grid/package-info.json
+drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-07 11:13:59.250877 dash_spread_grid-0.0.5/dash_spread_grid.egg-info/
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      259 2024-04-07 11:13:59.000000 dash_spread_grid-0.0.5/dash_spread_grid.egg-info/PKG-INFO
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      457 2024-04-07 11:13:59.000000 dash_spread_grid-0.0.5/dash_spread_grid.egg-info/SOURCES.txt
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)        1 2024-04-07 11:13:59.000000 dash_spread_grid-0.0.5/dash_spread_grid.egg-info/dependency_links.txt
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       17 2024-04-07 11:13:59.000000 dash_spread_grid-0.0.5/dash_spread_grid.egg-info/top_level.txt
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2332 2024-04-07 11:13:25.000000 dash_spread_grid-0.0.5/package.json
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       38 2024-04-07 11:13:59.250877 dash_spread_grid-0.0.5/setup.cfg
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      510 2024-01-18 13:19:42.000000 dash_spread_grid-0.0.5/setup.py
```

### Comparing `dash_spread_grid-0.0.4/README.md` & `dash_spread_grid-0.0.5/README.md`

 * *Files identical despite different names*

### Comparing `dash_spread_grid-0.0.4/dash_spread_grid/DashSpreadGrid.py` & `dash_spread_grid-0.0.5/dash_spread_grid/DashSpreadGrid.py`

 * *Files identical despite different names*

### Comparing `dash_spread_grid-0.0.4/dash_spread_grid/__init__.py` & `dash_spread_grid-0.0.5/dash_spread_grid/__init__.py`

 * *Files identical despite different names*

### Comparing `dash_spread_grid-0.0.4/dash_spread_grid/dash_spread_grid.min.js` & `dash_spread_grid-0.0.5/dash_spread_grid/dash_spread_grid.min.js`

 * *Files 4% similar despite different names*

#### js-beautify {}

```diff
@@ -5,15 +5,15 @@
                 __webpack_require__.d(__webpack_exports__, {
                     Z: () => __WEBPACK_DEFAULT_EXPORT__
                 });
                 var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(196),
                     react__WEBPACK_IMPORTED_MODULE_0___default = __webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),
                     prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(64),
                     prop_types__WEBPACK_IMPORTED_MODULE_1___default = __webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),
-                    js_spread_grid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(672);
+                    js_spread_grid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(649);
 
                 function _typeof(e) {
                     return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                         return typeof e
                     } : function(e) {
                         return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
                     }, _typeof(e)
@@ -259,15 +259,15 @@
             },
             64: e => {
                 e.exports = window.PropTypes
             },
             196: e => {
                 e.exports = window.React
             },
-            672: (e, t, o) => {
+            649: (e, t, o) => {
                 function n(e) {
                     return null === e ? "null" : Array.isArray(e) ? `[${e.map(n).join(",")}]` : "object" == typeof e ? (t = e, `{${Object.keys(t).sort().map((e=>`${e}:${n(t[e])}`)).join(",")}}`) : JSON.stringify(e);
                     var t
                 }
 
                 function r(e, t) {
                     return "FILTER" === e.type ^ "FILTER" === t.type ? "FILTER" : "DATA" === e.type && "DATA" === t.type ? "DATA" : "OTHER"
@@ -285,15 +285,15 @@
                             edit: t.resolve(c, a).edit,
                             cell: e,
                             type: r(a, c)
                         }
                     })).filter((e => e?.edit))
                 }
                 o.d(t, {
-                    Z: () => Be
+                    Z: () => Se
                 });
                 const l = "12px Calibri",
                     s = {
                         top: 2,
                         right: 5,
                         bottom: 2,
                         left: 5
@@ -330,31 +330,31 @@
                         R = c.map((e => e.width)),
                         A = R.reduce(((e, t) => e + t), 0) + x * m,
                         C = v.reduce(((e, t) => e + t), 0) + E * m,
                         k = "center" === o ? p.left : 0,
                         I = "middle" === t ? p.top : 0,
                         D = "center" === o ? p.width : s.width,
                         M = "middle" === t ? p.height : i.height,
-                        O = R.reduce(((e, t, o) => {
+                        T = R.reduce(((e, t, o) => {
                             const n = e[o] + t + m;
                             return e.push(n), e
                         }), [y ? m : 0]),
-                        T = v.reduce(((e, t, o) => {
+                        O = v.reduce(((e, t, o) => {
                             const n = e[o] + t + m;
                             return e.push(n), e
                         }), [_ ? m : 0]),
-                        L = O.slice(0, -1),
-                        P = T.slice(0, -1),
+                        L = T.slice(0, -1),
+                        P = O.slice(0, -1),
                         B = Math.max(L.findLastIndex((e => e <= k)), 0),
                         S = L.findLastIndex((e => e <= k + D)),
                         K = Math.max(P.findLastIndex((e => e <= I)), 0),
                         W = P.findLastIndex((e => e <= I + M)),
                         F = Math.max(B, y ? 0 : 1),
-                        z = S + (w ? 1 : 0),
-                        N = Math.max(K, _ ? 0 : 1),
+                        N = S + (w ? 1 : 0),
+                        z = Math.max(K, _ ? 0 : 1),
                         U = W + (g ? 1 : 0),
                         j = Array.from({
                             length: W - K + 1
                         }, ((e, t) => {
                             const o = u[t + K];
                             return Array.from({
                                 length: S - B + 1
@@ -368,20 +368,20 @@
                     const q = (e, t) => {
                             d.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, (e - k) * devicePixelRatio, (t - I) * devicePixelRatio)
                         },
                         $ = (e, t, o, n) => {
                             d.beginPath(), d.rect(e, t, o, n), d.clip()
                         };
                     for (let e = B; e <= S; e++) {
-                        d.save(), q(O[e], 0), $(0, 0, R[e], C);
+                        d.save(), q(T[e], 0), $(0, 0, R[e], C);
                         for (let t = K; t <= W; t++) {
                             const o = H(t, e),
                                 n = o.style,
-                                r = T[t],
-                                i = O[e],
+                                r = O[t],
+                                i = T[e],
                                 s = R[e],
                                 c = v[t],
                                 u = o.text,
                                 p = n.textAlign || "left",
                                 f = n.textBaseline || "middle",
                                 _ = o.padding;
                             q(i, r), d.fillStyle = n.background || "white", d.fillRect(0, 0, s, c), "draw" in o && o.draw(d), n.highlight && (d.fillStyle = n.highlight, d.fillRect(0, 0, s, c)), n.corner && (d.fillStyle = n.corner, d.beginPath(), d.moveTo(s - 7, c), d.lineTo(s, c), d.lineTo(s, c - 7), d.fill()), d.fillStyle = n.foreground || "black", d.font = n.font || l, d.textAlign = p;
@@ -399,51 +399,57 @@
                                 l = t === n,
                                 s = e - (l ? i / 2 : 0),
                                 a = t - (l ? 0 : i / 2),
                                 c = o + (l ? i / 2 : 0),
                                 u = n + (l ? 0 : i / 2);
                             d.strokeStyle = r.color || "black", d.lineWidth = i, r.dash ? (d.setLineDash(r.dash.map((e => e / devicePixelRatio))), d.lineDashOffset = l ? s : a) : d.setLineDash([]), d.beginPath(), d.moveTo(s, a), d.lineTo(c, u), d.stroke()
                         },
-                        Y = (e, t) => e ? t ? e.index > t.index ? e : t : e : t;
-                    for (let e = N; e <= U; e++) {
+                        G = (e, t) => e ? t ? e.index > t.index ? e : t : e : t;
+                    for (let e = z; e <= U; e++) {
                         const t = e - 1,
                             o = e;
                         for (let e = B; e <= S; e++) {
-                            const n = Y(t >= K ? H(t, e).style.borderBottom : null, o <= W ? H(o, e).style.borderTop : null);
-                            V(O[e] - b, T[o] - b, O[e + 1] - b, T[o] - b, n)
+                            const n = G(t >= K ? H(t, e).style.borderBottom : null, o <= W ? H(o, e).style.borderTop : null);
+                            V(T[e] - b, O[o] - b, T[e + 1] - b, O[o] - b, n)
                         }
                     }
-                    for (let e = F; e <= z; e++) {
+                    for (let e = F; e <= N; e++) {
                         const t = e - 1,
                             o = e;
                         for (let e = K; e <= W; e++) {
-                            const n = Y(t >= B ? H(e, t).style.borderRight : null, o <= S ? H(e, o).style.borderLeft : null);
-                            V(O[o] - b, T[e] - b, O[o] - b, T[e + 1] - b, n)
+                            const n = G(t >= B ? H(e, t).style.borderRight : null, o <= S ? H(e, o).style.borderLeft : null);
+                            V(T[o] - b, O[e] - b, T[o] - b, O[e + 1] - b, n)
                         }
                     }
                 }
 
                 function u(e) {
                     if (!e.error) try {
                         ! function(e) {
                             c(e, "top", "left"), c(e, "top", "center"), c(e, "top", "right"), c(e, "middle", "left"), c(e, "middle", "center"), c(e, "middle", "right"), c(e, "bottom", "left"), c(e, "bottom", "center"), c(e, "bottom", "right"),
                                 function(e) {
                                     const t = e.element,
                                         o = e.input,
                                         n = e.state,
                                         r = n.inputPlacement;
-                                    if (r) {
-                                        if (!o.parentElement) {
-                                            const n = document.activeElement === t;
-                                            e.element.appendChild(o), n && o.focus()
+                                    if (!r) {
+                                        if (o.parentElement) {
+                                            const e = document.activeElement === o;
+                                            o.parentElement.removeChild(o), e && t.focus({
+                                                preventScroll: !0
+                                            })
                                         }
-                                        o.style.left = `${r.left}px`, o.style.top = `${r.top}px`, o.style.width = `${r.width}px`, o.style.height = `${r.height}px`, o.style.backgroundColor = n.isTextValid ? "white" : "#eb3434"
-                                    } else if (o.parentElement) {
-                                        const e = document.activeElement === o;
-                                        o.parentElement.removeChild(o), e && t.focus()
+                                        return
+                                    }
+                                    const i = e.canvases[r.section];
+                                    if (o.style.left = "left" in r ? `${r.left}px` : "0", o.style.top = "top" in r ? `${r.top}px` : "0", o.style.right = "right" in r ? `${r.right}px` : "0", o.style.bottom = "bottom" in r ? `${r.bottom}px` : "0", o.style.marginLeft = "marginLeft" in r ? `${r.marginLeft}px` : "0", o.style.marginTop = "marginTop" in r ? `${r.marginTop}px` : "0", o.style.width = `${r.width}px`, o.style.height = `${r.height}px`, o.style.gridArea = i.style.gridArea, o.style.zIndex = i.style.zIndex, o.style.backgroundColor = n.isTextValid ? "white" : "#eb3434", !o.parentElement) {
+                                        const e = document.activeElement === t;
+                                        t.appendChild(o), e && o.focus({
+                                            preventScroll: !0
+                                        })
                                     }
                                 }(e),
                                 function(e) {
                                     const t = e.element,
                                         o = e.state;
                                     o.resizableColumn && o.resizableRow ? t.style.cursor = "nwse-resize" : o.resizableColumn ? t.style.cursor = "col-resize" : o.resizableRow ? t.style.cursor = "row-resize" : t.style.cursor = "default"
                                 }(e)
@@ -1040,25 +1046,25 @@
                             for (const o of t.labels) e.byLabel.has(o) && n(e.byLabel.get(o))
                         }
                         this.lookup.byKey.has(e.key) && r(this.lookup.byKey.get(e.key)), this.lookup.byIndex.has(e.index) && r(this.lookup.byIndex.get(e.index)), this.lookup.byMatch.has(e.type) && r(this.lookup.byMatch.get(e.type));
                         for (const t of e.labels) this.lookup.byLabel.has(t) && r(this.lookup.byLabel.get(t));
                         return o
                     }
                 }
-                const O = ["borderTop", "borderRight", "borderBottom", "borderLeft"];
+                const T = ["borderTop", "borderRight", "borderBottom", "borderLeft"];
 
-                function T(e, t) {
+                function O(e, t) {
                     const o = {
                         ...e
                     };
                     if ("border" in o) {
-                        for (const e of O) o[e] = o.border;
+                        for (const e of T) o[e] = o.border;
                         delete o.border
                     }
-                    for (const e of O) e in o && (o[e] = {
+                    for (const e of T) e in o && (o[e] = {
                         ...o[e],
                         index: t
                     });
                     return o
                 }
                 class L {
                     constructor(e) {
@@ -1087,15 +1093,15 @@
                         });
                         for (const e of l)
                             if ((!("condition" in e) || e.condition(c)) && ("value" in e && (c = {
                                     ...c,
                                     value: e.value(c)
                                 }), "style" in e && (u = {
                                     ...u,
-                                    ...T(e.style(c), e.index)
+                                    ...O(e.style(c), e.index)
                                 }), "text" in e && (c = {
                                     ...c,
                                     text: e.text(c)
                                 }), "padding" in e && (d = {
                                     ...d,
                                     ...e.padding(c)
                                 }), "edit" in e && (c = {
@@ -1170,24 +1176,24 @@
                                 u = s.get(c.key);
                             if (!t.resolve(n, r, i, c, e, a.value, a.text, u)) return !1
                         }
                         return !0
                     }))
                 }
 
-                function z(e, t, o, n) {
+                function N(e, t, o, n) {
                     return {
                         top: e,
                         bottom: t,
                         left: o,
                         right: n
                     }
                 }
 
-                function N(e, t) {
+                function z(e, t) {
                     return {
                         width: e.length ? e.at(-1).rightWithBorder : 0,
                         height: t.length ? t.at(-1).bottomWithBorder : 0
                     }
                 }
                 class U {
                     constructor() {
@@ -1251,23 +1257,23 @@
                     }
                 }
 
                 function V(e) {
                     return e.width * e.height
                 }
 
-                function Y(e, t) {
+                function G(e, t) {
                     return {
                         top: e.top,
                         left: e.left,
                         width: Math.max(0, e.width - t.left - t.right),
                         height: Math.max(0, e.height - t.top - t.bottom)
                     }
                 }
-                const G = 200,
+                const Y = 200,
                     X = 400,
                     Z = {
                         left: 0,
                         top: 0,
                         width: 0,
                         height: 0
                     };
@@ -1295,100 +1301,130 @@
                         _ = Math.max(a.get(u).index, a.get(p).index);
                     return i.slice(h, f + 1).flatMap((e => l.slice(m, _ + 1).map((t => ({
                         rowId: t.id,
                         columnId: e.id
                     })))))
                 }
 
-                function ee(e, t, o, r) {
+                function ee(e, t) {
+                    const o = function(e) {
+                            return "BEGIN" === e.pinned ? "top" : "END" === e.pinned ? "bottom" : "middle"
+                        }(t),
+                        n = function(e) {
+                            return "BEGIN" === e.pinned ? "left" : "END" === e.pinned ? "right" : "center"
+                        }(e);
+                    return `${o}-${n}`
+                }
+
+                function te(e, t, o, r, i) {
                     if (!t) return null;
-                    const i = n(t.columnId),
-                        l = n(t.rowId);
-                    if (!o.has(i)) return null;
-                    if (!r.has(l)) return null;
-                    const s = o.get(i),
-                        a = r.get(l);
-                    return 0 === e.length ? null : {
-                        left: s.left,
-                        top: a.top,
-                        width: s.width,
-                        height: a.height,
-                        boxSizing: "border-box"
+                    const l = n(t.columnId),
+                        s = n(t.rowId);
+                    if (!o.has(l)) return null;
+                    if (!r.has(s)) return null;
+                    const a = o.get(l),
+                        c = r.get(s);
+                    if (0 === e.length) return null;
+                    const u = {
+                        width: a.width,
+                        height: c.height,
+                        section: ee(a, c)
+                    };
+                    switch (c.pinned) {
+                        case "BEGIN":
+                            u.top = c.top;
+                            break;
+                        case "END":
+                            u.bottom = i.top.height + i.middle.height + i.bottom.height - c.top - c.height;
+                            break;
+                        default:
+                            u.marginTop = c.top - i.top.height
+                    }
+                    switch (a.pinned) {
+                        case "BEGIN":
+                            u.left = a.left;
+                            break;
+                        case "END":
+                            u.right = i.left.width + i.center.width + i.right.width - a.left - a.width;
+                            break;
+                        default:
+                            u.marginLeft = a.left - i.left.width
                     }
+                    return u
                 }
 
-                function te(e, t) {
+                function oe(e, t) {
                     return t.every((t => t.edit.validate({
                         string: e
                     })))
                 }
 
-                function oe(e) {
+                function ne(e) {
                     return Array.isArray(e) ? e.map(((e, t) => t)) : Object.keys(e)
                 }
 
-                function ne(e) {
-                    return oe(e)
+                function re(e) {
+                    return ne(e)
                 }
 
-                function re(e) {
+                function ie(e) {
                     if (Array.isArray(e)) return e.length > 0 ? Object.keys(e[0]) : [];
                     {
                         const t = Object.keys(e);
-                        return t.length > 0 ? oe(e[t[0]]) : []
+                        return t.length > 0 ? ne(e[t[0]]) : []
                     }
                 }
 
-                function ie(e, t) {
+                function le(e, t) {
                     if (!e.some((e => "DATA-BLOCK" === e.type))) return e;
                     const o = [];
                     for (const n of e)
                         if ("DATA-BLOCK" === n.type) {
-                            const e = "selector" in n ? n.selector(t) : re(t);
+                            const e = "selector" in n ? n.selector(t) : ie(t);
                             for (const t of e) o.push({
                                 ...n,
                                 id: t,
                                 type: "DATA"
                             })
                         } else o.push(n);
                     return o
                 }
 
-                function le(e, t) {
+                function se(e, t) {
                     if (!e.some((e => "DATA-BLOCK" === e.type))) return e;
                     const o = [];
                     for (const n of e)
                         if ("DATA-BLOCK" === n.type) {
-                            const e = "selector" in n ? n.selector(t) : ne(t);
+                            const e = "selector" in n ? n.selector(t) : re(t);
                             for (const t of e) o.push({
                                 ...n,
                                 id: t,
                                 type: "DATA"
                             })
                         } else o.push(n);
                     return o
                 }
-                const se = ({
+                const ae = ({
                     text: e,
                     expression: t
                 }) => e.includes(t);
-                class ae {
+                class ce {
                     constructor(e) {
                         this.rulesLookup = new M;
                         for (const t of e) {
                             const e = {
                                 by: n("by" in t ? t.by : "FILTER"),
-                                condition: t.condition || se
+                                condition: t.condition || ae
                             };
                             this.rulesLookup.addRule(t.column, t.row, e)
                         }
                     }
                     resolve(e, t, o, n, r, i, l, s) {
                         const a = this.rulesLookup.getRules(r, n);
-                        if (0 === a.length) return "DATA" !== n.type || "DATA" !== r.type || !s.has('"FILTER"') || se({
+                        if (0 === a.length) return "DATA" !== n.type || "DATA" !== r.type || !s.has('"FILTER"') || ae({
                             text: l,
                             expression: s.get('"FILTER"')
                         });
                         let c = {
                             data: e,
                             rows: t,
                             columns: o,
@@ -1405,27 +1441,27 @@
                             };
                             if (!e.condition(t)) return !1
                         }
                         return !0
                     }
                 }
 
-                function ce(e) {
-                    return new ae(e)
+                function ue(e) {
+                    return new ce(e)
                 }
 
-                function ue(e) {
+                function de(e) {
                     return e
                 }
 
-                function de(e) {
+                function pe(e) {
                     return e
                 }
 
-                function pe(e, t, o, n, r, i) {
+                function he(e, t, o, n, r, i) {
                     if (e.every((e => "number" == typeof e.width))) return e;
                     const l = e => {
                         const i = "width" in e ? e.width : "fit-once";
                         if ("number" == typeof i) return i;
                         if (r.has(e.key)) {
                             const t = r.get(e.key);
                             if ("fit-once" === i && !t.dataOnly) return t.width;
@@ -1450,15 +1486,15 @@
                     for (const e of r.keys()) i.has(e) || r.delete(e);
                     return e.map((e => ({
                         ...e,
                         width: l(e)
                     })))
                 }
 
-                function he(e, t, o, n, r, i) {
+                function fe(e, t, o, n, r, i) {
                     if (t.every((e => "number" == typeof e.height))) return t;
                     const l = t => {
                         const i = "height" in t ? t.height : "fit-once";
                         if ("number" == typeof i) return i;
                         if (r.has(t.key)) {
                             const e = r.get(t.key);
                             if ("fit-once" === i && !e.dataOnly) return e.height;
@@ -1483,153 +1519,153 @@
                     for (const e of r.keys()) i.has(e) || r.delete(e);
                     return t.map((e => ({
                         ...e,
                         height: l(e)
                     })))
                 }
 
-                function fe(e) {
+                function me(e) {
                     return new Set(e.map((e => e.key)))
                 }
 
-                function me(e) {
+                function _e(e) {
                     return e
                 }
-                const _e = (e, t) => e.value < t.value,
-                    ge = (e, t) => e.value > t.value;
-                class ye {
+                const ge = (e, t) => e.value < t.value,
+                    ye = (e, t) => e.value > t.value;
+                class we {
                     constructor(e) {
                         this.rulesLookup = new M;
                         for (const t of e) {
                             const e = {
                                 by: stringifyId("by" in t ? t.by : "HEADER"),
-                                comparatorAsc: t.comparator || _e,
-                                comparatorDesc: (e, o) => -t.comparator(e, o) || ge
+                                comparatorAsc: t.comparator || ge,
+                                comparatorDesc: (e, o) => -t.comparator(e, o) || ye
                             };
                             this.rulesLookup.addRule(t.column, t.row, e)
                         }
                     }
                     resolve(e, t, o) {
                         const n = this.rulesLookup.getRules(e, t);
-                        if (0 === n.length) return "DATA" !== t.type || "DATA" !== e.type ? null : o.has('"HEADER"') ? "ASC" === o.get('"HEADER"') ? _e : ge : null;
+                        if (0 === n.length) return "DATA" !== t.type || "DATA" !== e.type ? null : o.has('"HEADER"') ? "ASC" === o.get('"HEADER"') ? ge : ye : null;
                         if (n.length > 1) throw new Error("Multiple sorting rules for the same cell");
                         const r = n[0];
                         return "ASC" === o.get(r.by) ? r.comparatorAsc : r.comparatorDesc
                     }
                 }
 
-                function we(e) {
-                    return new ye(e)
+                function be(e) {
+                    return new we(e)
                 }
 
-                function be(e, t, o) {
+                function Ee(e, t, o) {
                     const r = new Map;
                     for (const i of e) {
                         const e = n(i[t]),
                             l = n(i[o]);
                         r.has(e) || r.set(e, new Map), r.get(e).set(l, i.direction)
                     }
                     return r
                 }
 
-                function Ee(e, t) {
+                function xe(e, t) {
                     e.sort(((e, t) => {
                         const o = e.comparator(e.cell, t.cell);
                         return "number" == typeof o ? o : o ? -1 : 1
                     })), t.push(...e.map((e => e.entity))), e.length = 0
                 }
 
-                function xe(e, t, o, r, i, l, s) {
+                function ve(e, t, o, r, i, l, s) {
                     if (0 === e.length) return i;
-                    const a = be(e, "columnId", "rowId"),
+                    const a = Ee(e, "columnId", "rowId"),
                         c = new Map(l.map((e => [e.key, e]))),
                         u = e.map((e => n(e.columnId))).filter((e => c.has(e))).map((e => c.get(e))).reverse();
                     if (0 === u.length) return i;
                     for (const e of u) {
                         const n = [],
                             c = [];
                         for (const u of i) {
                             const d = t.resolve(e, u, a.get(e.key));
                             if (!d) {
-                                Ee(c, n), n.push(u);
+                                xe(c, n), n.push(u);
                                 continue
                             }
                             const p = {
                                 entity: u,
                                 comparator: d,
                                 cell: o.resolve(r, i, l, u, e, s)
                             };
-                            0 !== c.length && c[0].comparator !== d ? (Ee(c, n), c.push(p)) : c.push(p)
+                            0 !== c.length && c[0].comparator !== d ? (xe(c, n), c.push(p)) : c.push(p)
                         }
-                        Ee(c, n), i = n
+                        xe(c, n), i = n
                     }
                     return i
                 }
 
-                function ve(e, t, o, r, i, l, s) {
+                function Re(e, t, o, r, i, l, s) {
                     if (0 === e.length) return l;
-                    const a = be(e, "rowId", "columnId"),
+                    const a = Ee(e, "rowId", "columnId"),
                         c = new Map(i.map((e => [e.key, e]))),
                         u = e.map((e => n(e.rowId))).filter((e => c.has(e))).map((e => c.get(e))).reverse();
                     if (0 === u.length) return l;
                     for (const e of u) {
                         const n = [],
                             c = [];
                         for (const u of l) {
                             const d = t.resolve(u, e, a.get(e.key));
                             if (!d) {
-                                Ee(c, n), n.push(u);
+                                xe(c, n), n.push(u);
                                 continue
                             }
                             const p = {
                                 entity: u,
                                 comparator: d,
                                 cell: o.resolve(r, i, l, e, u, s)
                             };
-                            0 !== c.length && c[0].comparator !== d ? (Ee(c, n), c.push(p)) : c.push(p)
+                            0 !== c.length && c[0].comparator !== d ? (xe(c, n), c.push(p)) : c.push(p)
                         }
-                        Ee(c, n), l = n
+                        xe(c, n), l = n
                     }
                     return l
                 }
-                const Re = 5;
+                const Ae = 5;
 
-                function Ae(e, t, o, r, i) {
+                function Ce(e, t, o, r, i) {
                     if (!r) return null;
                     const l = t.get(n(r.columnId)),
                         s = o.get(n(r.rowId)),
                         a = i.x;
-                    return "HEADER" !== s.type ? null : a >= l.right - Re && a <= l.right + Re ? l.id : 0 === l.index || a < l.left - Re || a > l.left + Re ? null : e[l.index - 1].id
+                    return "HEADER" !== s.type ? null : a >= l.right - Ae && a <= l.right + Ae ? l.id : 0 === l.index || a < l.left - Ae || a > l.left + Ae ? null : e[l.index - 1].id
                 }
 
-                function Ce(e, t, o, r, i) {
+                function ke(e, t, o, r, i) {
                     if (!r) return null;
                     const l = t.get(n(r.columnId)),
                         s = o.get(n(r.rowId)),
                         a = i.y;
-                    return "HEADER" !== l.type ? null : a >= s.bottom - Re && a <= s.bottom + Re ? s.id : 0 === s.index || a < s.top - Re || a > s.top + Re ? null : e[s.index - 1].id
+                    return "HEADER" !== l.type ? null : a >= s.bottom - Ae && a <= s.bottom + Ae ? s.id : 0 === s.index || a < s.top - Ae || a > s.top + Ae ? null : e[s.index - 1].id
                 }
 
-                function ke(e) {
+                function Ie(e) {
                     return e.map((e => ({
                         columnId: "columnId" in e ? e.columnId : "HEADER",
                         rowId: "rowId" in e ? e.rowId : "HEADER",
                         direction: e.direction
                     })))
                 }
 
-                function Ie(e) {
+                function De(e) {
                     return e.map((e => ({
                         columnId: "columnId" in e ? e.columnId : "FILTER",
                         rowId: "rowId" in e ? e.rowId : "FILTER",
                         expression: e.expression
                     })))
                 }
 
-                function De(e) {
+                function Me(e) {
                     console.count("updateState");
                     const t = {
                             ...e.localOptions,
                             ...e.externalOptions
                         },
                         o = e.memory,
                         n = e.state;
@@ -1641,54 +1677,54 @@
                             dependencies: n
                         }), o[e].value
                     }
                     const l = window.devicePixelRatio,
                         s = t.borderWidth / l,
                         a = t.data,
                         c = e.input.value,
-                        u = r("sortBy", ke, [t.sortBy]),
-                        h = r("filters", Ie, [t.filters]),
+                        u = r("sortBy", Ie, [t.sortBy]),
+                        h = r("filters", De, [t.filters]),
                         g = r("textResolver", j, []),
                         w = r("dataFormatting", d, [t.formatting, t.dataSelector, u]),
                         x = r("editedCellsAndFilters", _, [t.editedCells, h]),
                         v = r("edition", y, [x]),
                         I = r("invokedColumns", E, [t.columns, a]),
                         D = r("invokedRows", E, [t.rows, a]),
-                        M = r("unfoldedColumns", ie, [I, a]),
-                        O = r("unfoldedRows", le, [D, a]),
-                        T = r("unfilteredColumns", R, [M, t.pinnedLeft, t.pinnedRight, t.columnWidths]),
-                        L = r("unfilteredRows", A, [O, t.pinnedTop, t.pinnedBottom, t.rowHeights]),
-                        B = r("unfilteredColumnKeys", fe, [T]),
-                        K = r("unfilteredRowKeys", fe, [L]),
-                        U = r("filterFormatting", ue, [w]),
-                        oe = r("filterFormattingRules", P, [U]),
-                        ne = r("filteringRules", ce, [t.filtering]),
-                        re = r("filteredColumns", F, [h, ne, oe, a, L, T, v]),
-                        se = r("filteredRows", W, [h, ne, oe, a, L, T, v]),
-                        ae = r("sortingFormatting", me, [w]),
-                        _e = r("sortingFormattingRules", P, [ae]),
-                        ge = r("sortingRules", we, [t.sorting]),
-                        ye = r("sortedColumns", ve, [u, ge, _e, a, se, re, v]),
-                        be = r("sortedRows", xe, [u, ge, _e, a, se, re, v]),
-                        Ee = r("measureFormatting", de, [w]),
-                        Re = r("measureFormattingRules", P, [Ee]),
-                        De = r("measureFormatResolver", S, [Re, a, be, ye, v]),
+                        M = r("unfoldedColumns", le, [I, a]),
+                        T = r("unfoldedRows", se, [D, a]),
+                        O = r("unfilteredColumns", R, [M, t.pinnedLeft, t.pinnedRight, t.columnWidths]),
+                        L = r("unfilteredRows", A, [T, t.pinnedTop, t.pinnedBottom, t.rowHeights]),
+                        B = r("unfilteredColumnKeys", me, [O]),
+                        K = r("unfilteredRowKeys", me, [L]),
+                        U = r("filterFormatting", de, [w]),
+                        ee = r("filterFormattingRules", P, [U]),
+                        ne = r("filteringRules", ue, [t.filtering]),
+                        re = r("filteredColumns", F, [h, ne, ee, a, L, O, v]),
+                        ie = r("filteredRows", W, [h, ne, ee, a, L, O, v]),
+                        ae = r("sortingFormatting", _e, [w]),
+                        ce = r("sortingFormattingRules", P, [ae]),
+                        ge = r("sortingRules", be, [t.sorting]),
+                        ye = r("sortedColumns", Re, [u, ge, ce, a, ie, re, v]),
+                        we = r("sortedRows", ve, [u, ge, ce, a, ie, re, v]),
+                        Ee = r("measureFormatting", pe, [w]),
+                        xe = r("measureFormattingRules", P, [Ee]),
+                        Ae = r("measureFormatResolver", S, [xe, a, we, ye, v]),
                         Me = e.columnWidthCache,
-                        Oe = e.rowHeightCache,
-                        Te = r("measuredColumns", pe, [ye, be, g, De, Me, B]),
-                        Le = r("measuredRows", he, [ye, be, g, De, Oe, K]),
-                        Pe = r("columns", C, [Te, l, s]),
+                        Te = e.rowHeightCache,
+                        Oe = r("measuredColumns", he, [ye, we, g, Ae, Me, B]),
+                        Le = r("measuredRows", fe, [ye, we, g, Ae, Te, K]),
+                        Pe = r("columns", C, [Oe, l, s]),
                         Be = r("rows", k, [Le, l, s]),
                         Se = r("columnLookup", J, [Pe]),
                         Ke = r("rowLookup", J, [Be]),
                         We = t.focusedCell,
                         Fe = r("sections", m, [Pe, Be]),
-                        ze = t.selectedCells,
-                        Ne = r("fixedSize", z, [Fe.top.height, Fe.bottom.height, Fe.left.width, Fe.right.width]),
-                        Ue = r("totalSize", N, [Pe, Be]),
+                        Ne = t.selectedCells,
+                        ze = r("fixedSize", N, [Fe.top.height, Fe.bottom.height, Fe.left.width, Fe.right.width]),
+                        Ue = r("totalSize", z, [Pe, Be]),
                         je = function(e, t, o, n, r, i) {
                             if (!t) return null;
                             if (t.x < 0 || t.y < 0 || t.x > i.width || t.y > i.height) return null;
                             const l = e.scrollLeft,
                                 s = e.scrollTop,
                                 a = e.clientWidth,
                                 c = e.clientHeight,
@@ -1725,145 +1761,145 @@
                                     }
                                     return -1
                                 }(n, u);
                             return -1 === d || -1 === p ? null : {
                                 rowId: o[d].id,
                                 columnId: n[p].id
                             }
-                        }(e.element, e.mousePosition, Be, Pe, Ne, Ue),
-                        He = e.resizingColumn || r("resizableColumn", Ae, [Pe, Se, Ke, je, e.mousePosition]),
-                        qe = e.resizingRow || r("resizableRow", Ce, [Be, Se, Ke, je, e.mousePosition]),
+                        }(e.element, e.mousePosition, Be, Pe, ze, Ue),
+                        He = e.resizingColumn || r("resizableColumn", Ce, [Pe, Se, Ke, je, e.mousePosition]),
+                        qe = e.resizingRow || r("resizableRow", ke, [Be, Se, Ke, je, e.mousePosition]),
                         $e = r("highlightedCells", Q, [e.isMouseDown, !!He || !!qe, We, je, Pe, Be, Se, Ke]),
-                        Ve = r("selection", b, [ze]),
-                        Ye = r("highlight", b, [$e]),
-                        Ge = r("renderFormatting", f, [w, je, We, Ve, Ye, v, He, qe]),
-                        Xe = r("renderFormattingRules", P, [Ge]),
+                        Ve = r("selection", b, [Ne]),
+                        Ge = r("highlight", b, [$e]),
+                        Ye = r("renderFormatting", f, [w, je, We, Ve, Ge, v, He, qe]),
+                        Xe = r("renderFormattingRules", P, [Ye]),
                         Ze = r("renderFormatResolver", S, [Xe, a, Be, Pe, v]),
                         Je = r("inputFormatting", p, [w]),
                         Qe = r("inputFormattingRules", P, [Je]),
                         et = r("inputFormatResolver", S, [Qe, a, Be, Pe, v]),
-                        tt = r("editableCells", i, [ze, et, Se, Ke]),
-                        ot = r("inputPlacement", ee, [tt, We, Se, Ke]),
-                        nt = r("isTextValid", te, [c, tt]),
+                        tt = r("editableCells", i, [Ne, et, Se, Ke]),
+                        ot = r("inputPlacement", te, [tt, We, Se, Ke, Fe]),
+                        nt = r("isTextValid", oe, [c, tt]),
                         rt = function(e, t, o, n) {
                             const r = {
                                     width: n.getBoundingClientRect().width,
                                     height: n.getBoundingClientRect().height
                                 },
                                 i = {
                                     left: n.scrollLeft,
                                     top: n.scrollTop
                                 },
                                 l = e || Z,
-                                s = Y({
+                                s = G({
                                     left: 0,
                                     top: 0,
                                     ...t
                                 }, o),
-                                a = Y({
+                                a = G({
                                     ...i,
                                     ...r
                                 }, o),
-                                c = q(s, $(a, G)),
+                                c = q(s, $(a, Y)),
                                 u = q(s, $(a, X));
                             return H(s, l) && H(l, c) ? V(l) > 2 * V(u) ? u : l : u
-                        }(n?.scrollRect, Ue, Ne, e.element);
+                        }(n?.scrollRect, Ue, ze, e.element);
                     e.state = {
                         options: t,
                         devicePixelRatio: l,
                         borderWidth: s,
                         data: a,
                         dataFormatting: w,
                         edition: v,
                         filteredColumns: re,
-                        filteredRows: se,
+                        filteredRows: ie,
                         columns: Pe,
                         rows: Be,
                         sections: Fe,
-                        selectedCells: ze,
+                        selectedCells: Ne,
                         selection: Ve,
-                        highlight: Ye,
+                        highlight: Ge,
                         hoveredCell: je,
                         focusedCell: We,
-                        renderFormatting: Ge,
+                        renderFormatting: Ye,
                         renderFormatResolver: Ze,
                         inputFormatting: Je,
                         inputFormatResolver: et,
-                        fixedSize: Ne,
+                        fixedSize: ze,
                         totalSize: Ue,
                         textResolver: g,
                         scrollRect: rt,
                         highlightedCells: $e,
                         inputPlacement: ot,
                         columnLookup: Se,
                         rowLookup: Ke,
                         text: c,
                         isTextValid: nt,
                         resizableColumn: He,
                         resizableRow: qe
                     }
                 }
 
-                function Me(e) {
+                function Te(e) {
                     if (!e.error) try {
-                        De(e)
+                        Me(e)
                     } catch (t) {
                         e.error = t
                     }
                 }
 
                 function Oe(e, t) {
                     const o = new w(t);
                     return [...t, ...e.filter((e => !o.isIdSelected(e.rowId, e.columnId)))]
                 }
 
-                function Te(e, t) {
+                function Le(e, t) {
                     const o = new w(t);
                     return e.filter((e => !o.isIdSelected(e.rowId, e.columnId)))
                 }
 
-                function Le(e) {
+                function Pe(e) {
                     const t = e.currentTarget.getBoundingClientRect();
                     return {
                         x: e.clientX - t.left,
                         y: e.clientY - t.top
                     }
                 }
 
-                function Pe(e) {
+                function Be(e) {
                     if ("spread-grid-context" in e) return;
                     console.log("initialize");
                     const t = {
                             "top-left": document.createElement("canvas"),
                             "top-center": document.createElement("canvas"),
                             "top-right": document.createElement("canvas"),
                             "middle-left": document.createElement("canvas"),
                             "middle-center": document.createElement("canvas"),
                             "middle-right": document.createElement("canvas"),
                             "bottom-left": document.createElement("canvas"),
                             "bottom-center": document.createElement("canvas"),
                             "bottom-right": document.createElement("canvas")
                         },
                         o = document.createElement("input");
-                    e.setAttribute("tabindex", "0"), e.setAttribute("style", "max-width: 100vw; max-height: 100vh; overflow: auto; display: grid; position: relative; grid-template-columns: fit-content(0) fit-content(0) fit-content(0); grid-template-rows: fit-content(0) fit-content(0) fit-content(0); outline: none; user-select: none;"), e.classList.add("spread-grid"), t["top-left"].setAttribute("style", "position: sticky; left: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 1;"), t["top-center"].setAttribute("style", "position: sticky; top: 0; z-index: 1; grid-row: 1; grid-column: 2;"), t["top-right"].setAttribute("style", "position: sticky; right: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 3;"), t["middle-left"].setAttribute("style", "position: sticky; left: 0; z-index: 1; grid-row: 2; grid-column: 1;"), t["middle-center"].setAttribute("style", "grid-row: 2; grid-column: 2;"), t["middle-right"].setAttribute("style", "position: sticky; right: 0; z-index: 1; grid-row: 2; grid-column: 3;"), t["bottom-left"].setAttribute("style", "position: sticky; left: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 1;"), t["bottom-center"].setAttribute("style", "position: sticky; bottom: 0; z-index: 1; grid-row: 3; grid-column: 2;"), t["bottom-right"].setAttribute("style", "position: sticky; right: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 3;"), o.setAttribute("style", "position: absolute; z-index: 3; outline: none; border: none; box-shadow: none; padding: 0 5px; font-size: 12px; font-family: Calibri; background-color: white; box-sizing: border-box; opacity: 0; pointer-events: none;");
+                    e.setAttribute("tabindex", "0"), e.setAttribute("style", "max-width: 100vw; max-height: 100vh; overflow: auto; display: grid; position: relative; grid-template-columns: fit-content(0) fit-content(0) fit-content(0); grid-template-rows: fit-content(0) fit-content(0) fit-content(0); outline: none; user-select: none;"), e.classList.add("spread-grid"), t["top-left"].setAttribute("style", "position: sticky; left: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 1;"), t["top-center"].setAttribute("style", "position: sticky; top: 0; z-index: 1; grid-row: 1; grid-column: 2;"), t["top-right"].setAttribute("style", "position: sticky; right: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 3;"), t["middle-left"].setAttribute("style", "position: sticky; left: 0; z-index: 1; grid-row: 2; grid-column: 1;"), t["middle-center"].setAttribute("style", "grid-row: 2; grid-column: 2; z-index: 0;"), t["middle-right"].setAttribute("style", "position: sticky; right: 0; z-index: 1; grid-row: 2; grid-column: 3;"), t["bottom-left"].setAttribute("style", "position: sticky; left: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 1;"), t["bottom-center"].setAttribute("style", "position: sticky; bottom: 0; z-index: 1; grid-row: 3; grid-column: 2;"), t["bottom-right"].setAttribute("style", "position: sticky; right: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 3;"), o.setAttribute("style", "position: sticky; z-index: 3; outline: none; border: none; box-shadow: none; padding: 0 5px; font-size: 12px; font-family: Calibri; background-color: white; box-sizing: border-box; opacity: 0; pointer-events: none;");
                     const r = {
                         externalOptions: {},
                         state: null,
                         memory: {},
                         element: e,
                         canvases: t,
                         input: o,
                         renderRequested: !1,
                         mousePosition: null,
                         isMouseDown: !1,
                         columnWidthCache: new Map,
                         rowHeightCache: new Map,
                         requestNewRender: () => {
                             r.renderRequested || (r.renderRequested = !0, requestAnimationFrame((() => {
-                                r.renderRequested = !1, Me(r), u(r)
+                                r.renderRequested = !1, Te(r), u(r)
                             })))
                         },
                         addEventListener: (e, t, o) => {
                             e.addEventListener(t, (e => {
                                 try {
                                     o(e)
                                 } catch (e) {
@@ -1962,24 +1998,24 @@
                         },
                         a = e => {
                             const t = r.state.options.selectedCells,
                                 o = r.state.options.onEditedCellsChange,
                                 n = r.state.options.onFiltersChange,
                                 l = i(t, r.state.inputFormatResolver, r.state.columnLookup, r.state.rowLookup);
                             var s;
-                            e && !l.every((e => e.edit.autoCommit)) || (s = t, o(Te(r.state.options.editedCells, s)), (e => {
-                                n(Te(r.state.options.filters, e))
+                            e && !l.every((e => e.edit.autoCommit)) || (s = t, o(Le(r.state.options.editedCells, s)), (e => {
+                                n(Le(r.state.options.filters, e))
                             })(t))
                         };
                     r.addEventListener(e, "scroll", (e => {
                         r.requestNewRender()
                     })), r.addEventListener(e, "mouseenter", (e => {
-                        r.mousePosition = Le(e), r.requestNewRender()
+                        r.mousePosition = Pe(e), r.requestNewRender()
                     })), r.addEventListener(e, "mousemove", (e => {
-                        if (r.mousePosition = Le(e), r.resizingColumn) {
+                        if (r.mousePosition = Pe(e), r.resizingColumn) {
                             const e = r.state.columnLookup.get(n(r.resizingColumn)),
                                 t = e.width,
                                 o = e.right,
                                 i = r.mousePosition.x,
                                 l = Math.max(10, i - o + t),
                                 s = r.state.options.columnWidths.filter((t => n(t.columnId) !== e.key)).concat([{
                                     columnId: e.id,
@@ -1999,23 +2035,23 @@
                                 }]);
                             r.state.options.onRowHeightsChange(s)
                         }
                         r.requestNewRender()
                     })), r.addEventListener(e, "mouseleave", (() => {
                         r.mousePosition = null, r.requestNewRender()
                     })), r.addEventListener(e, "mousedown", (e => {
-                        Me(r), l(""), r.isMouseDown = !0, r.mouseDownPosition = r.mousePosition, r.mouseDownCell = r.state.hoveredCell, r.state.resizableColumn && (r.resizingColumn = r.state.resizableColumn), r.state.resizableRow && (r.resizingRow = r.state.resizableRow), r.state.resizableColumn || r.state.resizableRow || r.state.options.onFocusedCellChange(r.state.hoveredCell), e.ctrlKey || r.state.options.onSelectedCellsChange([]), r.requestNewRender()
+                        Te(r), l(""), r.isMouseDown = !0, r.mouseDownPosition = r.mousePosition, r.mouseDownCell = r.state.hoveredCell, r.state.resizableColumn && (r.resizingColumn = r.state.resizableColumn), r.state.resizableRow && (r.resizingRow = r.state.resizableRow), r.state.resizableColumn || r.state.resizableRow || r.state.options.onFocusedCellChange(r.state.hoveredCell), e.ctrlKey || r.state.options.onSelectedCellsChange([]), r.requestNewRender()
                     })), r.addEventListener(e, "mouseup", (e => {
-                        Me(r), r.isMouseDown = !1, r.resizingColumn = null, r.resizingRow = null, r.state.options.onSelectedCellsChange(Oe(r.state.options.selectedCells, r.state.highlightedCells)), r.requestNewRender()
+                        Te(r), r.isMouseDown = !1, r.resizingColumn = null, r.resizingRow = null, r.state.options.onSelectedCellsChange(Oe(r.state.options.selectedCells, r.state.highlightedCells)), r.requestNewRender()
                     })), r.addEventListener(e, "pointerdown", (e => {
                         r.element.setPointerCapture(e.pointerId)
                     })), r.addEventListener(e, "pointerup", (e => {
                         r.element.releasePointerCapture(e.pointerId)
                     })), r.addEventListener(e, "click", (e => {
-                        Me(r);
+                        Te(r);
                         const t = r.state.hoveredCell,
                             o = r.mouseDownCell;
                         if (r.state.resizableColumn || r.state.resizableRow) return;
                         if (null === t) return;
                         if (n(t.columnId) !== n(o.columnId)) return;
                         if (n(t.rowId) !== n(o.rowId)) return;
                         const i = r.state.columnLookup.get(n(t.columnId)),
@@ -2038,15 +2074,15 @@
                                     rowId: o.id,
                                     direction: c
                                 }] : []]
                             }(s, i, l, e.ctrlKey);
                             r.state.options.onSortByChange(t), r.state.options.onSelectedCellsChange([])
                         }
                     })), r.addEventListener(e, "dblclick", (e => {
-                        if (Me(r), r.state.resizableColumn) {
+                        if (Te(r), r.state.resizableColumn) {
                             const e = n(r.state.resizableColumn),
                                 t = r.state.options.columnWidths.filter((t => n(t.columnId) !== e));
                             r.state.options.onColumnWidthsChange(t), r.columnWidthCache.delete(e)
                         }
                         if (r.state.resizableRow) {
                             const e = n(r.state.resizableRow),
                                 t = r.state.options.rowHeights.filter((t => n(t.rowId) !== e));
@@ -2062,17 +2098,19 @@
                         if (!a.has(i)) return;
                         if (!c.has(s)) return;
                         const d = a.get(i),
                             p = c.get(s),
                             h = u.resolve(p, d).text;
                         l(h), o?.select()
                     })), r.addEventListener(e, "focus", (() => {
-                        o.parentElement && o.focus()
+                        o.parentElement && o.focus({
+                            preventScroll: !0
+                        })
                     })), r.addEventListener(e, "keydown", (e => {
-                        Me(r);
+                        Te(r);
                         const t = r.state.focusedCell,
                             o = r.state.columnLookup,
                             i = r.state.rowLookup,
                             c = r.state.options.selectedCells,
                             u = r.state.options.onSelectedCellsChange,
                             d = r.state.options.onFocusedCellChange,
                             p = r.state.options.editedCells,
@@ -2171,21 +2209,25 @@
                                                     }
                                                 }
                                                 e < f && m.push("\n")
                                             }
                                         }
                                         return m.join("")
                                     }(c, f, m, g);
-                                    navigator.clipboard.writeText(t)
+                                    if (navigator.clipboard) navigator.clipboard.writeText(t);
+                                    else {
+                                        const e = document.createElement("textarea");
+                                        e.value = t, document.body.appendChild(e), e.select(), document.execCommand("copy"), document.body.removeChild(e)
+                                    }
                                 })(e)
                         }
                     })), new ResizeObserver((() => {
                         r.requestNewRender()
                     })).observe(e), r.addEventListener(o, "input", (e => {
-                        Me(r), e.target.value ? (s(!0), o.style.opacity = 1, o.style.pointerEvents = "auto") : (e.isTrusted && a(!0), o.style.opacity = 0, o.style.pointerEvents = "none")
+                        Te(r), e.target.value ? (s(!0), o.style.opacity = 1, o.style.pointerEvents = "auto") : (e.isTrusted && a(!0), o.style.opacity = 0, o.style.pointerEvents = "none")
                     })), r.addEventListener(o, "click", (e => {
                         e.stopPropagation()
                     })), r.addEventListener(o, "dblclick", (e => {
                         e.stopPropagation()
                     })), r.addEventListener(o, "mousedown", (e => {
                         e.stopPropagation()
                     })), r.addEventListener(o, "keydown", (e => {
@@ -2203,18 +2245,18 @@
                                 break;
                             default:
                                 e.stopPropagation(), r.requestNewRender()
                         }
                     }))
                 }
 
-                function Be(e, t) {
-                    console.log("createGrid"), Pe(e);
+                function Se(e, t) {
+                    console.log("createGrid"), Be(e);
                     const o = e["spread-grid-context"];
-                    o.externalOptions = t, null === o.state ? (Me(o), u(o)) : o.requestNewRender()
+                    o.externalOptions = t, null === o.state ? (Te(o), u(o)) : o.requestNewRender()
                 }
             }
         },
         __webpack_module_cache__ = {};
 
     function __webpack_require__(e) {
         var t = __webpack_module_cache__[e];
@@ -2264,15 +2306,15 @@
         jsonpScriptSrc = function(e) {
             var t = getCurrentScript(),
                 o = isLocalScript(t),
                 n = __jsonpScriptSrc__(e);
             if (!o) return n;
             var r = n.split("/"),
                 i = r.slice(-1)[0].split(".");
-            return i.splice(1, 0, "v0_0_4m1712460087"), r.splice(-1, 1, i.join(".")), r.join("/")
+            return i.splice(1, 0, "v0_0_5m1712488437"), r.splice(-1, 1, i.join(".")), r.join("/")
         }
     }
     var __webpack_exports__ = {};
     (() => {
         __webpack_require__.r(__webpack_exports__), __webpack_require__.d(__webpack_exports__, {
             DashSpreadGrid: () => e.Z
         });
```

### Comparing `dash_spread_grid-0.0.4/dash_spread_grid/dash_spread_grid.min.js.map` & `dash_spread_grid-0.0.5/dash_spread_grid/dash_spread_grid.min.js.map`

 * *Files 2% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9157112278055328%*

 * *Differences: {"'mappings'": "'2rGAMA,SAASA,SAASC,GACd,MAAwB,iBAAVA,GAAsBA,aAAiBC,MACzD,CAEA,SAASC,sBAAsBC,YAC3B,OAAOC,EAAAA,mCAAAA,UAAQ,WACX,IAAMC,QAAU,oEAEhB,OAAOF,WAAWG,KAAI,SAAAC,MAClB,IAAMC,WAAa,CAAC,EAgBpB,GAdI,WAAYD,OACZC,WAAWC,OAASF,KAAKE,QACzB,QAASF,OACTC,WAAWE,IAAMH,KAAKG,KACtB,cAAeH,OACfC,WAAWG,UAAYC,KAAK,IAADC,OAAKR,QAAO,UAAAQ,OAASN,KAAKI,UAAS,OAC9D,UAAWJ,OACXC,WAAWR,MAAQY,KAAK,IAADC,OAAKR,QAAO,SAAAQ,OAAQN,KAAKP,MAAK,OACrD,SAAUO,OACVC,WAAWM,KAAOF,KAAK,IAADC,OAAKR,QAAO,UAAAQ,OAASN,KAAKO,KAAI,OACpD,UAAWP,OACXC, […]*

```diff
@@ -1,10 +1,10 @@
 {
     "file": "dash_spread_grid.min.js",
-    "mappings": "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",
+    "mappings": "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",
     "names": [
         "isString",
         "value",
         "String",
         "useResolvedFormatting",
         "formatting",
         "useMemo",
@@ -247,14 +247,18 @@
         "error",
         "input",
         "inputPlacement",
         "hasFocus",
         "document",
         "activeElement",
         "focus",
+        "preventScroll",
+        "section",
+        "gridArea",
+        "zIndex",
         "backgroundColor",
         "isTextValid",
         "renderInput",
         "resizableColumn",
         "resizableRow",
         "cursor",
         "renderCursor",
@@ -437,17 +441,20 @@
         "hoveredColumnKey",
         "hoveredRowKey",
         "minColumnIndex",
         "maxColumnIndex",
         "minRowIndex",
         "maxRowIndex",
         "flatMap",
+        "getCellSection",
+        "getVerticalSection",
+        "getHorizontalSection",
         "getInputPlacement",
         "editableCells",
-        "boxSizing",
+        "position",
         "getIsTextValid",
         "every",
         "getDefaultIds",
         "getDefaultRowIds",
         "getDefaultColumnIds",
         "getUnfoldedColumns",
         "some",
@@ -648,14 +655,17 @@
         "selectedRows",
         "stringBuilder",
         "cellData",
         "getClipboardData",
         "navigator",
         "clipboard",
         "writeText",
+        "textArea",
+        "body",
+        "execCommand",
         "copyToClipboard",
         "ResizeObserver",
         "observe",
         "target",
         "opacity",
         "pointerEvents",
         "isTrusted",
@@ -736,14 +746,15 @@
         "webpack:///../lib/src/state-utils/getTotalSize.js",
         "webpack:///../lib/src/types/TextResolver.js",
         "webpack:///../lib/src/state-utils/getTextResolver.js",
         "webpack:///../lib/src/core-utils/rect.js",
         "webpack:///../lib/src/state-utils/getScrollRect.js",
         "webpack:///../lib/src/state-utils/getLookup.js",
         "webpack:///../lib/src/state-utils/getHighlightedCells.js",
+        "webpack:///../lib/src/state-utils/getCellSection.js",
         "webpack:///../lib/src/state-utils/getInputPlacement.js",
         "webpack:///../lib/src/state-utils/getIsTextValid.js",
         "webpack:///../lib/src/state-utils/getUnfolded.js",
         "webpack:///../lib/src/types/FilteringRules.js",
         "webpack:///../lib/src/state-utils/getFilteringRules.js",
         "webpack:///../lib/src/state-utils/getFilterFormatting.js",
         "webpack:///../lib/src/state-utils/getMeasureFormatting.js",
@@ -778,15 +789,15 @@
         "module.exports = window[\"PropTypes\"];",
         "module.exports = window[\"React\"];",
         "function stringifyObject(object) {\n    const keys = Object.keys(object).sort();\n    const stringified = keys.map(key => {\n        return `${key}:${stringifyId(object[key])}`\n    });\n\n    return `{${stringified.join(',')}}`;\n}\n\nfunction stringifyArray(array) {\n    const stringified = array.map(stringifyId);\n\n    return `[${stringified.join(',')}]`;\n}\n\nexport default function stringifyId(key) {\n    if (key === null)\n        return 'null'\n\n    if (Array.isArray(key))\n        return stringifyArray(key)\n\n    if (typeof key === 'object')\n        return stringifyObject(key)\n\n    return JSON.stringify(key)\n}",
         "export default function getCellType(column, row) {\n    if (column.type === 'FILTER' ^ row.type === 'FILTER')\n        return 'FILTER';\n    if (column.type === 'DATA' && row.type === 'DATA')\n        return 'DATA';\n    return 'OTHER';\n}",
         "import stringifyId from \"../core-utils/stringifyId.js\";\nimport getCellType from \"./getCellType.js\";\n\nexport default function getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup) {\n    return selectedCells.map(cell => {\n        const columnKey = stringifyId(cell.columnId);\n        const rowKey = stringifyId(cell.rowId);\n\n        if (!columnLookup.has(columnKey))\n            return null;\n        if (!rowLookup.has(rowKey))\n            return null;\n\n        const column = columnLookup.get(columnKey);\n        const row = rowLookup.get(rowKey);\n\n        return {\n            edit: formatResolver.resolve(row, column).edit,\n            cell: cell,\n            type: getCellType(column, row)\n        }\n    }).filter(cell => cell?.edit);\n}",
         "const defaultFont = '12px Calibri';\nconst defaultPadding = { top: 2, right: 5, bottom: 2, left: 5 };\n\nexport { defaultFont, defaultPadding };",
         "export default function roundToPixels(value, devicePixelRatio) {\n    return Math.round(value * devicePixelRatio) / devicePixelRatio;\n}",
-        "import { defaultFont } from \"../core-utils/defaults.js\";\nimport roundToPixels from \"../core-utils/roundToPixels.js\";\n\nfunction renderSection(context, vertical, horizontal) {\n    const state = context.state;\n    const canvas = context.canvases[`${vertical}-${horizontal}`];\n    const verticalSection = state.sections[vertical];\n    const horizontalSection = state.sections[horizontal];\n    const columns = horizontalSection.columns;\n    const rows = verticalSection.rows;\n\n    if (rows.length === 0 || columns.length === 0) {\n        if (canvas.parentElement)\n            canvas.parentElement.removeChild(canvas);\n        return;\n    }\n\n    if (!canvas.parentElement)\n        context.element.appendChild(canvas);\n\n    // Checking how often this is called\n    console.log('draw');\n\n    // TODO: Borders are still blurry after scrolling at high zoom-out levels\n\n    const ctx = canvas.getContext(\"2d\", { alpha: false });\n    // TODO: Make that \"1\" configurable as cell spacing\n    const scrollRect = state.scrollRect;\n    const textResolver = state.textResolver;\n    // TODO: Make sure those formatters are split based on the rule areas\n    const formatResolver = state.renderFormatResolver;\n    const borderWidth = state.borderWidth;\n    const sectionBorders = {\n        top: verticalSection.showTopBorder,\n        bottom: verticalSection.showBottomBorder,\n        left: horizontalSection.showLeftBorder,\n        right: horizontalSection.showRightBorder\n    };\n    const borderOffset = borderWidth / 2;\n    const rowCount = rows.length;\n    const columnCount = columns.length;\n    const horizontalBorderCount = rowCount - 1 + (sectionBorders.top ? 1 : 0) + (sectionBorders.bottom ? 1 : 0);\n    const verticalBorderCount = columnCount - 1 + (sectionBorders.left ? 1 : 0) + (sectionBorders.right ? 1 : 0);\n    const rowHeights = rows.map(row => row.height);\n    const columnWidths = columns.map(column => column.width);\n    const totalWidth = columnWidths.reduce((a, b) => a + b, 0) + verticalBorderCount * borderWidth;\n    const totalHeight = rowHeights.reduce((a, b) => a + b, 0) + horizontalBorderCount * borderWidth;\n\n    const left = horizontal === 'center'\n        ? scrollRect.left\n        : 0;\n    const top = vertical === 'middle'\n        ? scrollRect.top\n        : 0;\n    const width = horizontal === 'center'\n        ? scrollRect.width\n        : horizontalSection.width;\n    const height = vertical === 'middle'\n        ? scrollRect.height\n        : verticalSection.height;\n\n    // TODO: Move somewhere else\n    const horizontalOffsets = columnWidths.reduce((acc, width, index) => {\n        const prevOffset = acc[index];\n        const offset = prevOffset + width + borderWidth;\n        acc.push(offset);\n        return acc;\n    }, [sectionBorders.left ? borderWidth : 0]);\n    const verticalOffsets = rowHeights.reduce((acc, height, index) => {\n        const prevOffset = acc[index];\n        const offset = prevOffset + height + borderWidth;\n        acc.push(offset);\n        return acc;\n    }, [sectionBorders.top ? borderWidth : 0]);\n\n    const columnOffsets = horizontalOffsets.slice(0, -1);\n    const rowOffsets = verticalOffsets.slice(0, -1);\n\n    const minVisibleColumnIndex = Math.max(columnOffsets.findLastIndex(offset => offset <= left), 0);\n    const maxVisibleColumnIndex = columnOffsets.findLastIndex(offset => offset <= left + width);\n    const minVisibleRowIndex = Math.max(rowOffsets.findLastIndex(offset => offset <= top), 0);\n    const maxVisibleRowIndex = rowOffsets.findLastIndex(offset => offset <= top + height);\n\n    const minVisibleVerticalBorderIndex = Math.max(minVisibleColumnIndex, sectionBorders.left ? 0 : 1);\n    const maxVisibleVerticalBorderIndex = maxVisibleColumnIndex + (sectionBorders.right ? 1 : 0);\n    const minVisibleHorizontalBorderIndex = Math.max(minVisibleRowIndex, sectionBorders.top ? 0 : 1);\n    const maxVisibleHorizontalBorderIndex = maxVisibleRowIndex + (sectionBorders.bottom ? 1 : 0);\n\n    const cells = Array.from({ length: maxVisibleRowIndex - minVisibleRowIndex + 1 }, (_, rowIndex) => {\n        const row = rows[rowIndex + minVisibleRowIndex];\n        return Array.from({ length: maxVisibleColumnIndex - minVisibleColumnIndex + 1 }, (_, columnIndex) => {\n            const column = columns[columnIndex + minVisibleColumnIndex];\n            return formatResolver.resolve(row, column);\n        });\n    });\n    const getCell = (rowIndex, columnIndex) => cells[rowIndex - minVisibleRowIndex][columnIndex - minVisibleColumnIndex];\n\n    canvas.width = Math.round(width * devicePixelRatio);\n    canvas.height = Math.round(height * devicePixelRatio);\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n    canvas.style.marginLeft = `${left}px`;\n    canvas.style.marginTop = `${top}px`;\n    canvas.style.marginRight = `${totalWidth - width - left}px`;\n    canvas.style.marginBottom = `${totalHeight - height - top}px`;;\n\n    ctx.fillStyle = \"#E9E9E9\";\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    const setTransform = (x, y) => {\n        ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, (x - left) * devicePixelRatio, (y - top) * devicePixelRatio);\n    };\n    const setClip = (x, y, width, height) => {\n        ctx.beginPath();\n        ctx.rect(x, y, width, height);\n        ctx.clip();\n    };\n\n    // Draw cells\n    for (let columnIndex = minVisibleColumnIndex; columnIndex <= maxVisibleColumnIndex; columnIndex++) {\n        ctx.save();\n        setTransform(horizontalOffsets[columnIndex], 0);\n        setClip(0, 0, columnWidths[columnIndex], totalHeight);\n\n        for (let rowIndex = minVisibleRowIndex; rowIndex <= maxVisibleRowIndex; rowIndex++) {\n            const cell = getCell(rowIndex, columnIndex);\n            const style = cell.style;\n            const cellTop = verticalOffsets[rowIndex];\n            const cellLeft = horizontalOffsets[columnIndex];\n            const cellWidth = columnWidths[columnIndex];\n            const cellHeight = rowHeights[rowIndex];\n            const text = cell.text;\n            const textAlign = style.textAlign || 'left';\n            const textBaseline = style.textBaseline || 'middle';\n            const padding = cell.padding;\n\n            setTransform(cellLeft, cellTop);\n\n            ctx.fillStyle = style.background || 'white';\n            ctx.fillRect(0, 0, cellWidth, cellHeight);\n\n            if ('draw' in cell)\n                cell.draw(ctx);\n\n            if (style.highlight) {\n                ctx.fillStyle = style.highlight;\n                ctx.fillRect(0, 0, cellWidth, cellHeight);\n            }\n\n            if (style.corner) {\n                ctx.fillStyle = style.corner;\n                ctx.beginPath();\n                ctx.moveTo(cellWidth - 7, cellHeight);\n                ctx.lineTo(cellWidth, cellHeight);\n                ctx.lineTo(cellWidth, cellHeight - 7);\n                ctx.fill();\n            }\n\n            ctx.fillStyle = style.foreground || 'black';\n            ctx.font = style.font || defaultFont;\n            ctx.textAlign = textAlign;\n\n            const fontMetrics = textResolver.getFontMetrics(style.font);\n\n            // TODO: Make sure that values are rounded using devicePixelRatio\n            const textX = roundToPixels(\n                textAlign === 'left' ? padding.left :\n                    textAlign === 'center' ? cellWidth / 2 :\n                        textAlign === 'right' ? cellWidth - padding.right :\n                            0,\n                devicePixelRatio\n            );\n\n            const textY = roundToPixels(\n                textBaseline === 'top' ? fontMetrics.middle + fontMetrics.topOffset + padding.top :\n                    textBaseline === 'middle' ? cellHeight / 2 + fontMetrics.middle :\n                        textBaseline === 'bottom' ? cellHeight + fontMetrics.middle - fontMetrics.bottomOffset - padding.bottom :\n                            0,\n                devicePixelRatio\n            );\n\n            const fitsVertically = textY - fontMetrics.middle - fontMetrics.topOffset >= 0 && textY - fontMetrics.middle + fontMetrics.bottomOffset <= cellHeight;\n\n            if (fitsVertically) {\n                ctx.fillText(text, textX, textY);\n            }\n            else {\n                // TODO: Clip if the text is too high (and draw some indicator if you do)\n                ctx.strokeStyle = '#E9E9E9';\n                ctx.lineWidth = borderWidth;\n\n                ctx.beginPath();\n                ctx.moveTo(0, borderWidth + borderOffset);\n                ctx.lineTo(cellWidth, borderWidth + borderOffset);\n                ctx.moveTo(0, cellHeight - borderWidth - borderOffset);\n                ctx.lineTo(cellWidth, cellHeight - borderWidth - borderOffset);\n                ctx.stroke();\n\n                ctx.save();\n                setClip(0, 2 * borderWidth, cellWidth, cellHeight - 4 * borderWidth);\n\n                ctx.fillText(text, textX, textY);\n\n                ctx.restore();\n            }\n        }\n\n        ctx.restore();\n    }\n\n    setTransform(0, 0);\n\n    // Draw borders\n\n    // TODO: clip drawing area to the middle of neighboring columns/rows (might be useful for redrawing only the changed cells)\n    // TODO: move somewhere (?)\n    const drawBorder = (x1, y1, x2, y2, style) => {\n        if (!style)\n            return;\n\n        const width = style.width * borderWidth;\n\n        const isHorizontal = y1 === y2;\n\n        // TODO: Don't add offset if the border is not continued\n        const xa = x1 - (isHorizontal ? width / 2 : 0);\n        const ya = y1 - (!isHorizontal ? width / 2 : 0);\n        const xb = x2 + (isHorizontal ? width / 2 : 0);\n        const yb = y2 + (!isHorizontal ? width / 2 : 0);\n\n        ctx.strokeStyle = style.color || 'black'; // TODO: resolve this color earlier\n        ctx.lineWidth = width;\n\n        if (style.dash) {\n            ctx.setLineDash(style.dash.map(value => value / devicePixelRatio));\n            ctx.lineDashOffset = (isHorizontal ? xa : ya);\n        }\n        else {\n            ctx.setLineDash([]);\n        }\n\n        ctx.beginPath();\n        ctx.moveTo(xa, ya);\n        ctx.lineTo(xb, yb);\n        ctx.stroke();\n    }\n\n    const selectBorder = (borderStyleA, borderStyleB) => {\n        if (!borderStyleA)\n            return borderStyleB;\n\n        if (!borderStyleB)\n            return borderStyleA;\n\n        if (borderStyleA.index > borderStyleB.index)\n            return borderStyleA;\n\n        return borderStyleB;\n    }\n\n    // TODO: Move somewhere else (?)\n    for (let horizontalBorderIndex = minVisibleHorizontalBorderIndex; horizontalBorderIndex <= maxVisibleHorizontalBorderIndex; horizontalBorderIndex++) {\n        const topRowIndex = horizontalBorderIndex - 1;\n        const bottomRowIndex = horizontalBorderIndex;\n\n        for (let columnIndex = minVisibleColumnIndex; columnIndex <= maxVisibleColumnIndex; columnIndex++) {\n            const topBorderStyle = topRowIndex >= minVisibleRowIndex ? getCell(topRowIndex, columnIndex).style.borderBottom : null;\n            const bottomBorderStyle = bottomRowIndex <= maxVisibleRowIndex ? getCell(bottomRowIndex, columnIndex).style.borderTop : null;\n\n            const borderStyle = selectBorder(topBorderStyle, bottomBorderStyle);\n\n            drawBorder(\n                horizontalOffsets[columnIndex] - borderOffset,\n                verticalOffsets[bottomRowIndex] - borderOffset,\n                horizontalOffsets[columnIndex + 1] - borderOffset,\n                verticalOffsets[bottomRowIndex] - borderOffset,\n                borderStyle);\n        }\n    }\n\n    for (let verticalBorderIndex = minVisibleVerticalBorderIndex; verticalBorderIndex <= maxVisibleVerticalBorderIndex; verticalBorderIndex++) {\n        const leftColumnIndex = verticalBorderIndex - 1;\n        const rightColumnIndex = verticalBorderIndex;\n\n        for (let rowIndex = minVisibleRowIndex; rowIndex <= maxVisibleRowIndex; rowIndex++) {\n            const leftBorderStyle = leftColumnIndex >= minVisibleColumnIndex ? getCell(rowIndex, leftColumnIndex).style.borderRight : null;\n            const rightBorderStyle = rightColumnIndex <= maxVisibleColumnIndex ? getCell(rowIndex, rightColumnIndex).style.borderLeft : null;\n\n            const borderStyle = selectBorder(leftBorderStyle, rightBorderStyle);\n\n            drawBorder(\n                horizontalOffsets[rightColumnIndex] - borderOffset,\n                verticalOffsets[rowIndex] - borderOffset,\n                horizontalOffsets[rightColumnIndex] - borderOffset,\n                verticalOffsets[rowIndex + 1] - borderOffset,\n                borderStyle);\n        }\n    }\n}\n\nfunction renderInput(context) {\n    const element = context.element;\n    const input = context.input;\n    const state = context.state;\n    const inputPlacement = state.inputPlacement;\n\n    if (!inputPlacement) {\n        if (input.parentElement) {\n            const hasFocus = document.activeElement === input;\n            input.parentElement.removeChild(input);\n            if (hasFocus)\n                element.focus();\n        }\n        return;\n    }\n\n    if (!input.parentElement) {\n        const hasFocus = document.activeElement === element;\n        context.element.appendChild(input);\n        if (hasFocus)\n            input.focus();\n    }\n\n    input.style.left = `${inputPlacement.left}px`;\n    input.style.top = `${inputPlacement.top}px`;\n    input.style.width = `${inputPlacement.width}px`;\n    input.style.height = `${inputPlacement.height}px`;\n\n    input.style.backgroundColor = state.isTextValid ? 'white' : '#eb3434';\n}\n\nfunction renderCursor(context) {\n    const element = context.element;\n    const state = context.state;\n\n    if (state.resizableColumn && state.resizableRow)\n        element.style.cursor = 'nwse-resize';\n    else if (state.resizableColumn)\n        element.style.cursor = 'col-resize';\n    else if (state.resizableRow)\n        element.style.cursor = 'row-resize';\n    else\n        element.style.cursor = 'default';\n}\n\nfunction renderInternal(context) {\n    renderSection(context, 'top', 'left');\n    renderSection(context, 'top', 'center');\n    renderSection(context, 'top', 'right');\n    renderSection(context, 'middle', 'left');\n    renderSection(context, 'middle', 'center');\n    renderSection(context, 'middle', 'right');\n    renderSection(context, 'bottom', 'left');\n    renderSection(context, 'bottom', 'center');\n    renderSection(context, 'bottom', 'right');\n\n    renderInput(context);\n    renderCursor(context);\n}\n\nfunction renderError(context) {\n    const element = context.element;\n    const error = context.error;\n\n    element.style.backgroundColor = '#9f0000';\n    element.style.color = 'white';\n    element.style.padding = '20px';\n    element.style.display = 'flex';\n    element.style.flexDirection = 'column';\n    element.innerHTML = `\n        <div style=\"font-size: 16px;\">\n            An error occurred while rendering the grid, please contact the support.\n        </div>\n        <div style=\"font-size: 20px; font-weight: bold; padding: 20px 0;\">\n            ${error.message}\n        </div>\n        <div style=\"font-size: 16px; white-space: pre-wrap;\">${error.stack}</div>\n    `;\n}\n\nexport default function render(context) {\n    if (!context.error) {\n        try {\n            renderInternal(context);\n        }\n        catch (error) {\n            context.error = error;\n        }\n    }\n\n    if (context.error)\n        renderError(context);\n}",
+        "import { defaultFont } from \"../core-utils/defaults.js\";\nimport roundToPixels from \"../core-utils/roundToPixels.js\";\n\nfunction renderSection(context, vertical, horizontal) {\n    const state = context.state;\n    const canvas = context.canvases[`${vertical}-${horizontal}`];\n    const verticalSection = state.sections[vertical];\n    const horizontalSection = state.sections[horizontal];\n    const columns = horizontalSection.columns;\n    const rows = verticalSection.rows;\n\n    if (rows.length === 0 || columns.length === 0) {\n        if (canvas.parentElement)\n            canvas.parentElement.removeChild(canvas);\n        return;\n    }\n\n    if (!canvas.parentElement)\n        context.element.appendChild(canvas);\n\n    // Checking how often this is called\n    console.log('draw');\n\n    // TODO: Borders are still blurry after scrolling at high zoom-out levels\n\n    const ctx = canvas.getContext(\"2d\", { alpha: false });\n    // TODO: Make that \"1\" configurable as cell spacing\n    const scrollRect = state.scrollRect;\n    const textResolver = state.textResolver;\n    // TODO: Make sure those formatters are split based on the rule areas\n    const formatResolver = state.renderFormatResolver;\n    const borderWidth = state.borderWidth;\n    const sectionBorders = {\n        top: verticalSection.showTopBorder,\n        bottom: verticalSection.showBottomBorder,\n        left: horizontalSection.showLeftBorder,\n        right: horizontalSection.showRightBorder\n    };\n    const borderOffset = borderWidth / 2;\n    const rowCount = rows.length;\n    const columnCount = columns.length;\n    const horizontalBorderCount = rowCount - 1 + (sectionBorders.top ? 1 : 0) + (sectionBorders.bottom ? 1 : 0);\n    const verticalBorderCount = columnCount - 1 + (sectionBorders.left ? 1 : 0) + (sectionBorders.right ? 1 : 0);\n    const rowHeights = rows.map(row => row.height);\n    const columnWidths = columns.map(column => column.width);\n    const totalWidth = columnWidths.reduce((a, b) => a + b, 0) + verticalBorderCount * borderWidth;\n    const totalHeight = rowHeights.reduce((a, b) => a + b, 0) + horizontalBorderCount * borderWidth;\n\n    const left = horizontal === 'center'\n        ? scrollRect.left\n        : 0;\n    const top = vertical === 'middle'\n        ? scrollRect.top\n        : 0;\n    const width = horizontal === 'center'\n        ? scrollRect.width\n        : horizontalSection.width;\n    const height = vertical === 'middle'\n        ? scrollRect.height\n        : verticalSection.height;\n\n    // TODO: Move somewhere else\n    const horizontalOffsets = columnWidths.reduce((acc, width, index) => {\n        const prevOffset = acc[index];\n        const offset = prevOffset + width + borderWidth;\n        acc.push(offset);\n        return acc;\n    }, [sectionBorders.left ? borderWidth : 0]);\n    const verticalOffsets = rowHeights.reduce((acc, height, index) => {\n        const prevOffset = acc[index];\n        const offset = prevOffset + height + borderWidth;\n        acc.push(offset);\n        return acc;\n    }, [sectionBorders.top ? borderWidth : 0]);\n\n    const columnOffsets = horizontalOffsets.slice(0, -1);\n    const rowOffsets = verticalOffsets.slice(0, -1);\n\n    const minVisibleColumnIndex = Math.max(columnOffsets.findLastIndex(offset => offset <= left), 0);\n    const maxVisibleColumnIndex = columnOffsets.findLastIndex(offset => offset <= left + width);\n    const minVisibleRowIndex = Math.max(rowOffsets.findLastIndex(offset => offset <= top), 0);\n    const maxVisibleRowIndex = rowOffsets.findLastIndex(offset => offset <= top + height);\n\n    const minVisibleVerticalBorderIndex = Math.max(minVisibleColumnIndex, sectionBorders.left ? 0 : 1);\n    const maxVisibleVerticalBorderIndex = maxVisibleColumnIndex + (sectionBorders.right ? 1 : 0);\n    const minVisibleHorizontalBorderIndex = Math.max(minVisibleRowIndex, sectionBorders.top ? 0 : 1);\n    const maxVisibleHorizontalBorderIndex = maxVisibleRowIndex + (sectionBorders.bottom ? 1 : 0);\n\n    const cells = Array.from({ length: maxVisibleRowIndex - minVisibleRowIndex + 1 }, (_, rowIndex) => {\n        const row = rows[rowIndex + minVisibleRowIndex];\n        return Array.from({ length: maxVisibleColumnIndex - minVisibleColumnIndex + 1 }, (_, columnIndex) => {\n            const column = columns[columnIndex + minVisibleColumnIndex];\n            return formatResolver.resolve(row, column);\n        });\n    });\n    const getCell = (rowIndex, columnIndex) => cells[rowIndex - minVisibleRowIndex][columnIndex - minVisibleColumnIndex];\n\n    canvas.width = Math.round(width * devicePixelRatio);\n    canvas.height = Math.round(height * devicePixelRatio);\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n    canvas.style.marginLeft = `${left}px`;\n    canvas.style.marginTop = `${top}px`;\n    canvas.style.marginRight = `${totalWidth - width - left}px`;\n    canvas.style.marginBottom = `${totalHeight - height - top}px`;;\n\n    ctx.fillStyle = \"#E9E9E9\";\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    const setTransform = (x, y) => {\n        ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, (x - left) * devicePixelRatio, (y - top) * devicePixelRatio);\n    };\n    const setClip = (x, y, width, height) => {\n        ctx.beginPath();\n        ctx.rect(x, y, width, height);\n        ctx.clip();\n    };\n\n    // Draw cells\n    for (let columnIndex = minVisibleColumnIndex; columnIndex <= maxVisibleColumnIndex; columnIndex++) {\n        ctx.save();\n        setTransform(horizontalOffsets[columnIndex], 0);\n        setClip(0, 0, columnWidths[columnIndex], totalHeight);\n\n        for (let rowIndex = minVisibleRowIndex; rowIndex <= maxVisibleRowIndex; rowIndex++) {\n            const cell = getCell(rowIndex, columnIndex);\n            const style = cell.style;\n            const cellTop = verticalOffsets[rowIndex];\n            const cellLeft = horizontalOffsets[columnIndex];\n            const cellWidth = columnWidths[columnIndex];\n            const cellHeight = rowHeights[rowIndex];\n            const text = cell.text;\n            const textAlign = style.textAlign || 'left';\n            const textBaseline = style.textBaseline || 'middle';\n            const padding = cell.padding;\n\n            setTransform(cellLeft, cellTop);\n\n            ctx.fillStyle = style.background || 'white';\n            ctx.fillRect(0, 0, cellWidth, cellHeight);\n\n            if ('draw' in cell)\n                cell.draw(ctx);\n\n            if (style.highlight) {\n                ctx.fillStyle = style.highlight;\n                ctx.fillRect(0, 0, cellWidth, cellHeight);\n            }\n\n            if (style.corner) {\n                ctx.fillStyle = style.corner;\n                ctx.beginPath();\n                ctx.moveTo(cellWidth - 7, cellHeight);\n                ctx.lineTo(cellWidth, cellHeight);\n                ctx.lineTo(cellWidth, cellHeight - 7);\n                ctx.fill();\n            }\n\n            ctx.fillStyle = style.foreground || 'black';\n            ctx.font = style.font || defaultFont;\n            ctx.textAlign = textAlign;\n\n            const fontMetrics = textResolver.getFontMetrics(style.font);\n\n            // TODO: Make sure that values are rounded using devicePixelRatio\n            const textX = roundToPixels(\n                textAlign === 'left' ? padding.left :\n                    textAlign === 'center' ? cellWidth / 2 :\n                        textAlign === 'right' ? cellWidth - padding.right :\n                            0,\n                devicePixelRatio\n            );\n\n            const textY = roundToPixels(\n                textBaseline === 'top' ? fontMetrics.middle + fontMetrics.topOffset + padding.top :\n                    textBaseline === 'middle' ? cellHeight / 2 + fontMetrics.middle :\n                        textBaseline === 'bottom' ? cellHeight + fontMetrics.middle - fontMetrics.bottomOffset - padding.bottom :\n                            0,\n                devicePixelRatio\n            );\n\n            const fitsVertically = textY - fontMetrics.middle - fontMetrics.topOffset >= 0 && textY - fontMetrics.middle + fontMetrics.bottomOffset <= cellHeight;\n\n            if (fitsVertically) {\n                ctx.fillText(text, textX, textY);\n            }\n            else {\n                // TODO: Clip if the text is too high (and draw some indicator if you do)\n                ctx.strokeStyle = '#E9E9E9';\n                ctx.lineWidth = borderWidth;\n\n                ctx.beginPath();\n                ctx.moveTo(0, borderWidth + borderOffset);\n                ctx.lineTo(cellWidth, borderWidth + borderOffset);\n                ctx.moveTo(0, cellHeight - borderWidth - borderOffset);\n                ctx.lineTo(cellWidth, cellHeight - borderWidth - borderOffset);\n                ctx.stroke();\n\n                ctx.save();\n                setClip(0, 2 * borderWidth, cellWidth, cellHeight - 4 * borderWidth);\n\n                ctx.fillText(text, textX, textY);\n\n                ctx.restore();\n            }\n        }\n\n        ctx.restore();\n    }\n\n    setTransform(0, 0);\n\n    // Draw borders\n\n    // TODO: clip drawing area to the middle of neighboring columns/rows (might be useful for redrawing only the changed cells)\n    // TODO: move somewhere (?)\n    const drawBorder = (x1, y1, x2, y2, style) => {\n        if (!style)\n            return;\n\n        const width = style.width * borderWidth;\n\n        const isHorizontal = y1 === y2;\n\n        // TODO: Don't add offset if the border is not continued\n        const xa = x1 - (isHorizontal ? width / 2 : 0);\n        const ya = y1 - (!isHorizontal ? width / 2 : 0);\n        const xb = x2 + (isHorizontal ? width / 2 : 0);\n        const yb = y2 + (!isHorizontal ? width / 2 : 0);\n\n        ctx.strokeStyle = style.color || 'black'; // TODO: resolve this color earlier\n        ctx.lineWidth = width;\n\n        if (style.dash) {\n            ctx.setLineDash(style.dash.map(value => value / devicePixelRatio));\n            ctx.lineDashOffset = (isHorizontal ? xa : ya);\n        }\n        else {\n            ctx.setLineDash([]);\n        }\n\n        ctx.beginPath();\n        ctx.moveTo(xa, ya);\n        ctx.lineTo(xb, yb);\n        ctx.stroke();\n    }\n\n    const selectBorder = (borderStyleA, borderStyleB) => {\n        if (!borderStyleA)\n            return borderStyleB;\n\n        if (!borderStyleB)\n            return borderStyleA;\n\n        if (borderStyleA.index > borderStyleB.index)\n            return borderStyleA;\n\n        return borderStyleB;\n    }\n\n    // TODO: Move somewhere else (?)\n    for (let horizontalBorderIndex = minVisibleHorizontalBorderIndex; horizontalBorderIndex <= maxVisibleHorizontalBorderIndex; horizontalBorderIndex++) {\n        const topRowIndex = horizontalBorderIndex - 1;\n        const bottomRowIndex = horizontalBorderIndex;\n\n        for (let columnIndex = minVisibleColumnIndex; columnIndex <= maxVisibleColumnIndex; columnIndex++) {\n            const topBorderStyle = topRowIndex >= minVisibleRowIndex ? getCell(topRowIndex, columnIndex).style.borderBottom : null;\n            const bottomBorderStyle = bottomRowIndex <= maxVisibleRowIndex ? getCell(bottomRowIndex, columnIndex).style.borderTop : null;\n\n            const borderStyle = selectBorder(topBorderStyle, bottomBorderStyle);\n\n            drawBorder(\n                horizontalOffsets[columnIndex] - borderOffset,\n                verticalOffsets[bottomRowIndex] - borderOffset,\n                horizontalOffsets[columnIndex + 1] - borderOffset,\n                verticalOffsets[bottomRowIndex] - borderOffset,\n                borderStyle);\n        }\n    }\n\n    for (let verticalBorderIndex = minVisibleVerticalBorderIndex; verticalBorderIndex <= maxVisibleVerticalBorderIndex; verticalBorderIndex++) {\n        const leftColumnIndex = verticalBorderIndex - 1;\n        const rightColumnIndex = verticalBorderIndex;\n\n        for (let rowIndex = minVisibleRowIndex; rowIndex <= maxVisibleRowIndex; rowIndex++) {\n            const leftBorderStyle = leftColumnIndex >= minVisibleColumnIndex ? getCell(rowIndex, leftColumnIndex).style.borderRight : null;\n            const rightBorderStyle = rightColumnIndex <= maxVisibleColumnIndex ? getCell(rowIndex, rightColumnIndex).style.borderLeft : null;\n\n            const borderStyle = selectBorder(leftBorderStyle, rightBorderStyle);\n\n            drawBorder(\n                horizontalOffsets[rightColumnIndex] - borderOffset,\n                verticalOffsets[rowIndex] - borderOffset,\n                horizontalOffsets[rightColumnIndex] - borderOffset,\n                verticalOffsets[rowIndex + 1] - borderOffset,\n                borderStyle);\n        }\n    }\n}\n\nfunction renderInput(context) {\n    const element = context.element;\n    const input = context.input;\n    const state = context.state;\n    const inputPlacement = state.inputPlacement;\n\n    if (!inputPlacement) {\n        if (input.parentElement) {\n            const hasFocus = document.activeElement === input;\n            input.parentElement.removeChild(input);\n            if (hasFocus)\n                element.focus({ preventScroll: true });\n        }\n        return;\n    }\n\n    const canvas = context.canvases[inputPlacement.section];\n\n    input.style.left = 'left' in inputPlacement ? `${inputPlacement.left}px` : '0';\n    input.style.top = 'top' in inputPlacement ? `${inputPlacement.top}px` : '0';\n    input.style.right = 'right' in inputPlacement ? `${inputPlacement.right}px` : '0';\n    input.style.bottom = 'bottom' in inputPlacement ? `${inputPlacement.bottom}px` : '0';\n    input.style.marginLeft = 'marginLeft' in inputPlacement ? `${inputPlacement.marginLeft}px` : '0';\n    input.style.marginTop = 'marginTop' in inputPlacement ? `${inputPlacement.marginTop}px` : '0';\n    input.style.width = `${inputPlacement.width}px`;\n    input.style.height = `${inputPlacement.height}px`;\n    input.style.gridArea = canvas.style.gridArea;\n    input.style.zIndex = canvas.style.zIndex;\n    input.style.backgroundColor = state.isTextValid ? 'white' : '#eb3434';\n\n    if (!input.parentElement) {\n        const hasFocus = document.activeElement === element;\n        element.appendChild(input);\n        if (hasFocus)\n            input.focus({ preventScroll: true });\n    }\n}\n\nfunction renderCursor(context) {\n    const element = context.element;\n    const state = context.state;\n\n    if (state.resizableColumn && state.resizableRow)\n        element.style.cursor = 'nwse-resize';\n    else if (state.resizableColumn)\n        element.style.cursor = 'col-resize';\n    else if (state.resizableRow)\n        element.style.cursor = 'row-resize';\n    else\n        element.style.cursor = 'default';\n}\n\nfunction renderInternal(context) {\n    renderSection(context, 'top', 'left');\n    renderSection(context, 'top', 'center');\n    renderSection(context, 'top', 'right');\n    renderSection(context, 'middle', 'left');\n    renderSection(context, 'middle', 'center');\n    renderSection(context, 'middle', 'right');\n    renderSection(context, 'bottom', 'left');\n    renderSection(context, 'bottom', 'center');\n    renderSection(context, 'bottom', 'right');\n\n    renderInput(context);\n    renderCursor(context);\n}\n\nfunction renderError(context) {\n    const element = context.element;\n    const error = context.error;\n\n    element.style.backgroundColor = '#9f0000';\n    element.style.color = 'white';\n    element.style.padding = '20px';\n    element.style.display = 'flex';\n    element.style.flexDirection = 'column';\n    element.innerHTML = `\n        <div style=\"font-size: 16px;\">\n            An error occurred while rendering the grid, please contact the support.\n        </div>\n        <div style=\"font-size: 20px; font-weight: bold; padding: 20px 0;\">\n            ${error.message}\n        </div>\n        <div style=\"font-size: 16px; white-space: pre-wrap;\">${error.stack}</div>\n    `;\n}\n\nexport default function render(context) {\n    if (!context.error) {\n        try {\n            renderInternal(context);\n        }\n        catch (error) {\n            context.error = error;\n        }\n    }\n\n    if (context.error)\n        renderError(context);\n}",
         "export default function getDataFormatting(formatting, dataSelector, sortBy) {\n    return [\n        {\n            column: { match: 'DATA' },\n            row: { match: 'HEADER' },\n            value: ({ column }) => column.header === undefined ? column.id : column.header\n        },\n        {\n            column: { match: 'HEADER' },\n            row: { match: 'DATA' },\n            value: ({ row }) => row.header === undefined ? row.id : row.header\n        },\n        {\n            column: { match: 'HEADER' },\n            row: { match: 'SPECIAL' },\n            value: ''\n        },\n        {\n            column: { match: 'SPECIAL' },\n            row: { match: 'HEADER' },\n            value: ''\n        },\n        ...sortBy.map(({ columnId, rowId, direction }, index) => ({\n            column: { id: columnId },\n            row: { id: rowId },\n            text: ({ column }) => `${sortBy.length > 1 ? index + 1 : ''}${direction === 'ASC' ? '\u21e3' : '\u21e1'} ${column.header}`\n        })),\n        {\n            column: { match: 'ANY' },\n            row: { match: 'FILTER' },\n            value: ({ newValue }) => newValue || '',\n            text: ({ newValue }) => newValue || 'Search...', // TODO: Move to render formatting?\n            edit: {\n                validate: () => true,\n                parse: ({ string }) => string,\n                autoCommit: true\n            },\n        },\n        {\n            column: { match: 'DATA' },\n            row: { match: 'DATA' },\n            value: dataSelector\n        },\n        ...formatting\n    ];\n}",
         "export default function getInputFormatting(formatting) {\n    return formatting;\n}",
         "import stringifyId from '../core-utils/stringifyId.js';\n\nfunction getHighlightColor(baseColor, isStrong) {\n    if (isStrong)\n        return baseColor + '99';\n    else\n        return baseColor + '33';\n}\n\nexport default function getRenderFormatting(formatting, hoveredCell, focusedCell, selection, highlight, edition, resizableColumn, resizableRow) {\n    const focusedColumnKey = focusedCell ? stringifyId(focusedCell.columnId) : null;\n    const focusedRowKey = focusedCell ? stringifyId(focusedCell.rowId) : null;\n    const isResizingColumn = resizableColumn !== null;\n    const isResizingRow = resizableRow !== null;\n    const isResizing = isResizingColumn || isResizingRow;\n\n    const isSelected = (rows, columns, rowIndex, columnIndex) => {\n        if (rowIndex < 0 || rowIndex >= rows.length)\n            return false;\n        if (columnIndex < 0 || columnIndex >= columns.length)\n            return false;\n\n        const rowKey = rows[rowIndex].key;\n        const columnKey = columns[columnIndex].key;\n\n        return selection.isKeySelected(rowKey, columnKey);\n    };\n\n    const optional = (condition, style) => {\n        if (condition)\n            return [style];\n        else\n            return [];\n    }\n\n    return [\n        {\n            column: { match: 'ANY' },\n            row: { match: 'FILTER' },\n            style: ({ newValue }) => ({ background: '#FBFBFB', foreground: newValue ? 'black' : '#cccccc', border: { width: 1, color: 'gray' } })\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'HEADER' },\n            style: { background: '#F5F5F5', border: { width: 1, color: 'gray' } }\n        },\n        {\n            column: { match: 'HEADER' },\n            row: { match: 'ANY' },\n            style: { background: '#F5F5F5', border: { width: 1, color: 'gray' } }\n        },\n        {\n            column: { match: 'HEADER' },\n            row: { match: 'HEADER' },\n            style: { background: '#E0E0E0' }\n        },\n        ...formatting,\n        ...optional(hoveredCell && !isResizingColumn, {\n            column: { id: hoveredCell?.columnId },\n            row: { match: 'ANY' },\n            style: { highlight: '#81948133' },\n        }),\n        ...optional(hoveredCell && !isResizingRow, {\n            column: { match: 'ANY' },\n            row: { id: hoveredCell?.rowId },\n            style: { highlight: '#81948133' },\n        }),\n        ...optional(hoveredCell && !isResizing, {\n            column: { id: hoveredCell?.columnId },\n            row: { id: hoveredCell?.rowId },\n            style: { highlight: '#81948188' },\n        }),\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ rows, columns, row, column }) => isSelected(rows, columns, row.index, column.index),\n            style: ({ rows, columns, row, column, edit }) => ({\n                ...(!isSelected(rows, columns, row.index - 1, column.index) ? { borderTop: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index + 1, column.index) ? { borderBottom: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index, column.index - 1) ? { borderLeft: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index, column.index + 1) ? { borderRight: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                highlight: getHighlightColor(edit ? '#798d9c' : '#819481', focusedColumnKey !== column.key || focusedRowKey !== row.key)\n            }),\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => highlight.isKeySelected(row.key, column.key),\n            style: ({ row, column }) => ({\n                highlight: getHighlightColor('#93a8b8', focusedColumnKey !== column.key || focusedRowKey !== row.key)\n            })\n        },\n        ...optional(focusedCell, {\n            column: { id: focusedCell?.columnId },\n            row: { id: focusedCell?.rowId },\n            style: { highlight: '#ffffffaa' }\n        }),\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ edit }) => edit,\n            style: { corner: '#77777720' },\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => edition.hasValueByKey(row.key, column.key),\n            style: { corner: 'darkgreen' },\n        },\n        ...optional(resizableColumn, {\n            column: { id: resizableColumn },\n            row: { match: 'HEADER' },\n            style: { borderRight: { width: 5, color: 'cornflowerblue' } }\n        }),\n        ...optional(resizableRow, {\n            column: { match: 'HEADER' },\n            row: { id: resizableRow },\n            style: { borderBottom: { width: 5, color: 'cornflowerblue' } }\n        }),\n    ];\n}",
         "export default function getSections(columns, rows) {\n    const topLength = rows.filter(row => row.pinned === 'BEGIN').length; // TODO: optimize\n    const bottomLength = rows.filter(row => row.pinned === 'END').length;\n    const middleLength = rows.length - topLength - bottomLength;\n    const leftLength = columns.filter(column => column.pinned === 'BEGIN').length;\n    const rightLength = columns.filter(column => column.pinned === 'END').length;\n    const centerLength = columns.length - leftLength - rightLength;\n\n    const topRows = rows.slice(0, topLength);\n    const bottomRows = rows.slice(rows.length - bottomLength, rows.length);\n    const middleRows = rows.slice(topLength, rows.length - bottomLength);\n    const leftColumns = columns.slice(0, leftLength);\n    const rightColumns = columns.slice(columns.length - rightLength, columns.length);\n    const centerColumns = columns.slice(leftLength, columns.length - rightLength);\n\n    const hasTopRows = topLength > 0;\n    const hasBottomRows = bottomLength > 0;\n    const hasMiddleRows = middleLength > 0;\n    const hasLeftColumns = leftLength > 0;\n    const hasRightColumns = rightLength > 0;\n    const hasCenterColumns = centerLength > 0;\n\n    const topShowTopBorder = true;\n    const topShowBottomBorder = true;\n    const bottomShowTopBorder = hasMiddleRows || !hasTopRows;\n    const bottomShowBottomBorder = true;\n    const middleShowTopBorder = !hasTopRows;\n    const middleShowBottomBorder = !hasBottomRows;\n    const leftShowLeftBorder = true;\n    const leftShowRightBorder = true;\n    const rightShowLeftBorder = hasCenterColumns || !hasLeftColumns;\n    const rightShowRightBorder = true;\n    const centerShowLeftBorder = !hasLeftColumns;\n    const centerShowRightBorder = !hasRightColumns;\n\n    const getHeight = (rows, showTopBorder, showBottomBorder) => {\n        if (rows.length === 0)\n            return 0;\n\n        const top = showTopBorder ? rows.at(0).topWithBorder : rows.at(0).top;\n        const bottom = showBottomBorder ? rows.at(-1).bottomWithBorder : rows.at(-1).bottom;\n\n        return bottom - top;\n    }\n\n    const getWidth = (columns, showLeftBorder, showRightBorder) => {\n        if (columns.length === 0)\n            return 0;\n\n        const left = showLeftBorder ? columns.at(0).leftWithBorder : columns.at(0).left;\n        const right = showRightBorder ? columns.at(-1).rightWithBorder : columns.at(-1).right;\n\n        return right - left;\n    }\n\n    const topHeight = getHeight(topRows, topShowTopBorder, topShowBottomBorder);\n    const bottomHeight = getHeight(bottomRows, bottomShowTopBorder, bottomShowBottomBorder);\n    const middleHeight = getHeight(middleRows, middleShowTopBorder, middleShowBottomBorder);\n    const leftWidth = getWidth(leftColumns, leftShowLeftBorder, leftShowRightBorder);\n    const rightWidth = getWidth(rightColumns, rightShowLeftBorder, rightShowRightBorder);\n    const centerWidth = getWidth(centerColumns, centerShowLeftBorder, centerShowRightBorder);\n\n    return {\n        top: {\n            rows: topRows,\n            showTopBorder: topShowTopBorder,\n            showBottomBorder: topShowBottomBorder,\n            height: topHeight\n        },\n        bottom: {\n            rows: bottomRows,\n            showTopBorder: bottomShowTopBorder,\n            showBottomBorder: bottomShowBottomBorder,\n            height: bottomHeight\n        },\n        middle: {\n            rows: middleRows,\n            showTopBorder: middleShowTopBorder,\n            showBottomBorder: middleShowBottomBorder,\n            height: middleHeight\n        },\n        left: {\n            columns: leftColumns,\n            showLeftBorder: leftShowLeftBorder,\n            showRightBorder: leftShowRightBorder,\n            width: leftWidth\n        },\n        right: {\n            columns: rightColumns,\n            showLeftBorder: rightShowLeftBorder,\n            showRightBorder: rightShowRightBorder,\n            width: rightWidth\n        },\n        center: {\n            columns: centerColumns,\n            showLeftBorder: centerShowLeftBorder,\n            showRightBorder: centerShowRightBorder,\n            width: centerWidth\n        }\n    };\n}",
         "// TODO: Move\nexport default function getEditedCellsAndFilters(editedCells, filters) {\n    return [...editedCells, ...filters.map(filter => ({ columnId: filter.columnId, rowId: filter.rowId, value: filter.expression }))];\n}\n",
         "import stringifyId from \"../core-utils/stringifyId.js\";\n\n// TODO: write unit tests\nexport default class Edition {\n    constructor(editedCells) {\n        this.lookup = new Map();\n\n        editedCells.forEach(cell => {\n            const rowKey = stringifyId(cell.rowId);\n            const columnKey = stringifyId(cell.columnId);\n\n            if (!this.lookup.has(rowKey))\n                this.lookup.set(rowKey, new Map());\n\n            this.lookup.get(rowKey).set(columnKey, cell.value);\n        });\n    }\n\n    hasValueByKey(rowKey, columnKey) {\n        return this.lookup.has(rowKey) && this.lookup.get(rowKey).has(columnKey);\n    }\n\n    getValueByKey(rowKey, columnKey) {\n        if (!this.hasValueByKey(rowKey, columnKey))\n            return undefined;\n\n        return this.lookup.get(rowKey).get(columnKey);\n    }\n\n    hasValueById(rowId, columnId) {\n        return this.hasValueByKey(stringifyId(rowId), stringifyId(columnId));\n    }\n\n    getValueById(rowId, columnId) {\n        return this.getValueByKey(stringifyId(rowId), stringifyId(columnId));\n    }\n}",
         "import Edition from \"../types/Edition.js\";\n\n// TODO: Move\nexport default function getEdition(editedCellsAndFilters) {\n    return new Edition(editedCellsAndFilters);\n}\n",
@@ -806,15 +817,16 @@
         "export default function getTotalSize(columns, rows) {\n    return {\n        width: columns.length ? columns.at(-1).rightWithBorder : 0,\n        height: rows.length ? rows.at(-1).bottomWithBorder : 0\n    };\n}\n",
         "import { defaultFont } from \"../core-utils/defaults.js\";\n\nexport default class TextResolver\n{\n    constructor() {\n        this.canvas = document.createElement('canvas');\n        this.context = this.canvas.getContext('2d');\n        this.fontMetrics = new Map();\n    }\n\n    measureWidth(text, font) {\n        const ctx = this.context;\n\n        ctx.font = font || defaultFont;\n\n        const textMetrics = ctx.measureText(text);\n\n        return textMetrics.width;\n    }\n\n    measureHeight(text, font) {\n        let lines = 1;\n        for (const char of text) {\n            if (char === '\\n')\n                lines++;\n        }\n\n        return lines * this.getFontMetrics(font).height;\n    }\n\n    getFontMetrics(font) {\n        const key = font;\n\n        if (this.fontMetrics.has(key))\n            return this.fontMetrics.get(key);\n\n        const ctx = this.context;\n\n        // TODO: Set other font properties\n        ctx.font = font || defaultFont;\n\n        const textMetrics = ctx.measureText('X');\n\n        const middle = (textMetrics.actualBoundingBoxDescent - textMetrics.actualBoundingBoxAscent) / 2;\n        const topOffset = middle + textMetrics.fontBoundingBoxAscent;\n        const bottomOffset = textMetrics.fontBoundingBoxDescent - middle;\n        const height = textMetrics.fontBoundingBoxAscent + textMetrics.fontBoundingBoxDescent;\n\n        const fontMetrics = {\n            topOffset: topOffset,\n            middle: -middle,\n            bottomOffset: bottomOffset,\n            height: height\n        };\n\n        this.fontMetrics.set(key, fontMetrics);\n\n        return fontMetrics;\n    }\n}",
         "import TextResolver from \"../types/TextResolver.js\";\n\nexport default function getTextResolver() {\n    return new TextResolver();\n}\n",
         "export function contains(bounds, rect) {\n    return (\n        rect.top >= bounds.top &&\n        rect.left >= bounds.left &&\n        rect.top + rect.height <= bounds.top + bounds.height &&\n        rect.left + rect.width <= bounds.left + bounds.width\n    );\n}\n\nexport function clip(bounds, rect) {\n    const newRect = {\n        top: Math.max(bounds.top, rect.top),\n        left: Math.max(bounds.left, rect.left),\n        width: Math.min(bounds.left + bounds.width, rect.left + rect.width) - Math.max(bounds.left, rect.left),\n        height: Math.min(bounds.top + bounds.height, rect.top + rect.height) - Math.max(bounds.top, rect.top)\n    };\n\n    if (newRect.width >= 0 && newRect.height >= 0)\n        return newRect;\n\n    return {\n        top: bounds.top,\n        left: bounds.left,\n        width: 0,\n        height: 0\n    }\n}\n\nexport function expand(rect, margin) {\n    return {\n        top: rect.top - margin,\n        left: rect.left - margin,\n        width: rect.width + margin * 2,\n        height: rect.height + margin * 2\n    };\n}\n\nexport function area(rect) {\n    return rect.width * rect.height;\n}\n\nexport function subtract(rect, margin) {\n    return {\n        top: rect.top,\n        left: rect.left,\n        width: Math.max(0, rect.width - margin.left - margin.right),\n        height: Math.max(0, rect.height - margin.top - margin.bottom)\n    };\n}",
         "import { area, clip, contains, expand, subtract } from \"../core-utils/rect.js\";\n\nconst requiredMargin = 200;\nconst preloadedMargin = 400;\nconst emptyRect = {\n    left: 0,\n    top: 0,\n    width: 0,\n    height: 0\n};\n\nexport default function getScrollRect(previous, totalSize, fixedSize, element) {\n    // TODO: Is it optimal to use getBoundingClientRect()?\n    const size = {\n        width: element.getBoundingClientRect().width,\n        height: element.getBoundingClientRect().height\n    };\n    const scrollOffset = {\n        left: element.scrollLeft,\n        top: element.scrollTop\n    };\n\n    const prevScrollRect = previous || emptyRect;\n\n    const totalRect = { left: 0, top: 0, ...totalSize };\n    const bounds = subtract(totalRect, fixedSize);\n    const scrollRect = subtract({ ...scrollOffset, ...size }, fixedSize);\n    const requiredScrollRect = clip(bounds, expand(scrollRect, requiredMargin));\n    const preloadedScrollRect = clip(bounds, expand(scrollRect, preloadedMargin));\n\n    if (!contains(bounds, prevScrollRect))\n        return preloadedScrollRect;\n\n    if (!contains(prevScrollRect, requiredScrollRect))\n        return preloadedScrollRect;\n\n    if (area(prevScrollRect) > 2 * area(preloadedScrollRect))\n        return preloadedScrollRect;\n\n    return prevScrollRect;\n}\n",
         "export default function getLookup(elements) {\n    return elements.reduce((lookup, element) => lookup.set(element.key, element), new Map());\n}\n",
         "import stringifyId from \"../core-utils/stringifyId.js\";\n\nexport default function getHighlightedCells(isMouseDown, isResizing, focusedCell, hoveredCell, columns, rows, columnLookup, rowLookup) {\n    if (!isMouseDown)\n        return [];\n    if (isResizing)\n        return [];\n    if (!hoveredCell)\n        return [];\n    if (!focusedCell)\n        return [];\n\n    const focusedColumnKey = stringifyId(focusedCell.columnId);\n    const focusedRowKey = stringifyId(focusedCell.rowId);\n    const hoveredColumnKey = stringifyId(hoveredCell.columnId);\n    const hoveredRowKey = stringifyId(hoveredCell.rowId);\n\n    if (!columnLookup.has(focusedColumnKey))\n        return [];\n    if (!rowLookup.has(focusedRowKey))\n        return [];\n    if (!columnLookup.has(hoveredColumnKey))\n        return [];\n    if (!rowLookup.has(hoveredRowKey))\n        return [];\n\n    const minColumnIndex = Math.min(columnLookup.get(focusedColumnKey).index, columnLookup.get(hoveredColumnKey).index);\n    const maxColumnIndex = Math.max(columnLookup.get(focusedColumnKey).index, columnLookup.get(hoveredColumnKey).index);\n    const minRowIndex = Math.min(rowLookup.get(focusedRowKey).index, rowLookup.get(hoveredRowKey).index);\n    const maxRowIndex = Math.max(rowLookup.get(focusedRowKey).index, rowLookup.get(hoveredRowKey).index);\n\n    return columns.slice(minColumnIndex, maxColumnIndex + 1).flatMap(column => {\n        return rows.slice(minRowIndex, maxRowIndex + 1).map(row => {\n            return {\n                rowId: row.id,\n                columnId: column.id\n            };\n        });\n    });\n}\n",
-        "import stringifyId from \"../core-utils/stringifyId.js\";\n\nexport default function getInputPlacement(editableCells, focusedCell, columnLookup, rowLookup) {\n    if (!focusedCell)\n        return null;\n\n    const focusedColumnKey = stringifyId(focusedCell.columnId);\n    const focusedRowKey = stringifyId(focusedCell.rowId);\n\n    if (!columnLookup.has(focusedColumnKey))\n        return null;\n    if (!rowLookup.has(focusedRowKey))\n        return null;\n\n    const column = columnLookup.get(focusedColumnKey);\n    const row = rowLookup.get(focusedRowKey);\n\n    if (editableCells.length === 0)\n        return null;\n\n    return {\n        left: column.left,\n        top: row.top,\n        width: column.width,\n        height: row.height,\n        boxSizing: 'border-box',\n    };\n}\n",
+        "function getVerticalSection(row) {\n    if (row.pinned === \"BEGIN\")\n        return \"top\";\n    if (row.pinned === \"END\")\n        return \"bottom\";\n    return \"middle\";\n}\n\nfunction getHorizontalSection(column) {\n    if (column.pinned === \"BEGIN\")\n        return \"left\";\n    if (column.pinned === \"END\")\n        return \"right\";\n    return \"center\";\n}\n\nexport default function getCellSection(column, row) {\n    const verticalSection = getVerticalSection(row);\n    const horizontalSection = getHorizontalSection(column);\n\n    return `${verticalSection}-${horizontalSection}`;\n}",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\nimport getCellSection from \"./getCellSection.js\";\n\nexport default function getInputPlacement(editableCells, focusedCell, columnLookup, rowLookup, sections) {\n    if (!focusedCell)\n        return null;\n\n    const focusedColumnKey = stringifyId(focusedCell.columnId);\n    const focusedRowKey = stringifyId(focusedCell.rowId);\n\n    if (!columnLookup.has(focusedColumnKey))\n        return null;\n    if (!rowLookup.has(focusedRowKey))\n        return null;\n\n    const column = columnLookup.get(focusedColumnKey);\n    const row = rowLookup.get(focusedRowKey);\n\n    if (editableCells.length === 0)\n        return null;\n\n    const position = {\n        width: column.width,\n        height: row.height,\n        section: getCellSection(column, row)\n    };\n\n    switch (row.pinned) {\n        case \"BEGIN\":\n            position.top = row.top;\n            break;\n        case \"END\":\n            position.bottom = sections.top.height + sections.middle.height + sections.bottom.height - row.top - row.height;\n            break;\n        default:\n            position.marginTop = row.top - sections.top.height;\n    }\n\n    switch (column.pinned) {\n        case \"BEGIN\":\n            position.left = column.left;\n            break;\n        case \"END\":\n            position.right = sections.left.width + sections.center.width + sections.right.width - column.left - column.width;\n            break;\n        default:\n            position.marginLeft = column.left - sections.left.width;\n    }\n\n    return position;\n}\n",
         "export default function getIsTextValid(text, editableCells) {\n    return editableCells.every(cell => cell.edit.validate({ string: text }));\n}\n",
         "function getDefaultIds(elements) {\n    if (!Array.isArray(elements))\n        return Object.keys(elements);\n\n    return elements.map((_, index) => index);\n}\n\nfunction getDefaultRowIds(data) {\n    return getDefaultIds(data);\n}\n\nfunction getDefaultColumnIds(data) {\n    if (Array.isArray(data)) {\n        if (data.length > 0)\n            return Object.keys(data[0]);\n        return [];\n    } else {\n        const keys = Object.keys(data);\n        if (keys.length > 0)\n            return getDefaultIds(data[keys[0]]);\n        return [];\n    }\n}\n\nexport function getUnfoldedColumns(columns, data) {\n    const hasDataBlocks = columns.some(column => column.type === 'DATA-BLOCK');\n\n    if (!hasDataBlocks)\n        return columns;\n\n    const unfoldedColumns = [];\n\n    for (const column of columns) {\n        if (column.type === 'DATA-BLOCK') {\n            const ids = 'selector' in column\n                ? column.selector(data)\n                : getDefaultColumnIds(data);\n\n            for (const id of ids) {\n                unfoldedColumns.push({\n                    ...column,\n                    id,\n                    type: 'DATA'\n                });\n            }\n        } else {\n            unfoldedColumns.push(column);\n        }\n    }\n\n    return unfoldedColumns;\n}\n\nexport function getUnfoldedRows(rows, data) {\n    const hasDataBlocks = rows.some(row => row.type === 'DATA-BLOCK');\n\n    if (!hasDataBlocks)\n        return rows;\n\n    const unfoldedRows = [];\n\n    for (const row of rows) {\n        if (row.type === 'DATA-BLOCK') {\n            const ids = 'selector' in row\n                ? row.selector(data)\n                : getDefaultRowIds(data);\n\n            for (const id of ids) {\n                unfoldedRows.push({\n                    ...row,\n                    id,\n                    type: 'DATA'\n                });\n            }\n        } else {\n            unfoldedRows.push(row);\n        }\n    }\n\n    return unfoldedRows;\n}",
         "import stringifyId from \"../core-utils/stringifyId.js\";\nimport RulesLookup from \"./RulesLookup.js\";\n\nconst defaultCondition = ({ text, expression }) => text.includes(expression);\n\nexport default class FilteringRules {\n    constructor(rules) {\n        this.rulesLookup = new RulesLookup();\n\n        for (const rule of rules) {\n            const entry = {\n                by: stringifyId('by' in rule ? rule.by : 'FILTER'),\n                condition: rule.condition || defaultCondition\n            };\n\n            this.rulesLookup.addRule(rule.column, rule.row, entry);\n        }\n    }\n\n    resolve(data, rows, columns, row, column, value, text, filterLookup) {\n        const rules = this.rulesLookup.getRules(column, row);\n\n        if (rules.length === 0) {\n            if (row.type !== 'DATA')\n                return true;\n            if (column.type !== 'DATA')\n                return true;\n            if (!filterLookup.has('\"FILTER\"'))\n                return true;\n\n            return defaultCondition({ text, expression: filterLookup.get('\"FILTER\"') });\n        }\n\n        let context = { data, rows, columns, row, column, value, text };\n\n        for (const rule of rules) {\n            if (!filterLookup.has(rule.by))\n                continue;\n\n            const filterContext = { ...context, expression: filterLookup.get(rule.by) };\n\n            if (!rule.condition(filterContext))\n                return false;\n        }\n\n        return true;\n    }\n}",
         "import FilteringRules from \"../types/FilteringRules.js\";\n\nexport default function getFilteringRules(filtering) {\n    return new FilteringRules(filtering);\n}",
         "export default function getFilterFormatting(formatting) {\n    return formatting;\n}",
         "export default function getMeasureFormatting(formatting) {\n    return formatting;\n}",
         "import { defaultPadding } from \"../core-utils/defaults.js\";\n\n// TODO: add expand and expand-data\n\nexport function getMeasuredColumns(columns, rows, textResolver, formatResolver, measuringCache, presentKeys) {\n    if (columns.every(column => typeof column.width === 'number'))\n        return columns;\n\n    const measureColumn = column => {\n        const requestedWidth = 'width' in column ? column.width : 'fit-once';\n\n        if (typeof requestedWidth === 'number')\n            return requestedWidth;\n\n        if (measuringCache.has(column.key)) {\n            const cached = measuringCache.get(column.key);\n\n            if (requestedWidth === 'fit-once' && !cached.dataOnly)\n                return cached.width;\n            if (requestedWidth === 'fit-data-once' && cached.dataOnly)\n                return cached.width;\n        }\n\n        let width = 0;\n        for (const row of rows) {\n            if (row.type !== 'DATA' && requestedWidth === 'fit-data-once')\n                continue;\n            if (row.type !== 'DATA' && requestedWidth === 'fit-data')\n                continue;\n\n            const cell = formatResolver.resolve(row, column);\n            const text = cell.text;\n            const font = cell.font;\n            const padding = cell.padding.left + cell.padding.right;\n\n            const cellWidth = textResolver.measureWidth(text, font) + padding;\n\n            width = Math.max(width, cellWidth);\n        }\n\n        measuringCache.set(column.key, {\n            width,\n            dataOnly: requestedWidth === 'fit-data-once'\n        });\n\n        return width;\n    }\n\n    for (const key of measuringCache.keys()) {\n        if (!presentKeys.has(key))\n            measuringCache.delete(key);\n    }\n\n    return columns.map(column => ({\n        ...column,\n        width: measureColumn(column)\n    }));\n}\n\nexport function getMeasuredRows(columns, rows, textResolver, formatResolver, measuringCache, presentKeys) {\n    if (rows.every(row => typeof row.height === 'number'))\n        return rows;\n\n    const measureRow = row => {\n        const requestedHeight = 'height' in row ? row.height : 'fit-once';\n\n        if (typeof requestedHeight === 'number')\n            return requestedHeight;\n\n        if (measuringCache.has(row.key)) {\n            const cached = measuringCache.get(row.key);\n\n            if (requestedHeight === 'fit-once' && !cached.dataOnly)\n                return cached.height;\n            if (requestedHeight === 'fit-data-once' && cached.dataOnly)\n                return cached.height;\n        }\n\n        let height = 0;\n        for (const column of columns) {\n            if (column.type !== 'DATA' && requestedHeight === 'fit-data-once')\n                continue;\n            if (column.type !== 'DATA' && requestedHeight === 'fit-data')\n                continue;\n\n            const cell = formatResolver.resolve(row, column);\n            const text = cell.text;\n            const font = cell.font;\n            const padding = cell.padding.top + cell.padding.bottom;\n\n            const cellHeight = textResolver.measureHeight(text, font) + padding;\n\n            height = Math.max(height, cellHeight);\n        }\n\n        measuringCache.set(row.key, {\n            height,\n            dataOnly: requestedHeight === 'fit-data-once'\n        });\n\n        return height;\n    }\n\n    for (const key of measuringCache.keys()) {\n        if (!presentKeys.has(key))\n            measuringCache.delete(key);\n    }\n\n    return rows.map(row => ({\n        ...row,\n        height: measureRow(row)\n    }));\n}",
@@ -822,26 +834,26 @@
         "export default function getSortingFormatting(formatting) {\n    return formatting;\n}",
         "import RulesLookup from \"./RulesLookup.js\";\n\nconst defaultComparatorAsc = (lhs, rhs) => lhs.value < rhs.value;\nconst defaultComparatorDesc = (lhs, rhs) => lhs.value > rhs.value;\n\nexport default class SortingRules {\n    constructor(rules) {\n        this.rulesLookup = new RulesLookup();\n\n        for (const rule of rules) {\n            const entry = {\n                by: stringifyId('by' in rule ? rule.by : 'HEADER'),\n                comparatorAsc: rule.comparator || defaultComparatorAsc,\n                comparatorDesc: (lhs, rhs) => -rule.comparator(lhs, rhs) || defaultComparatorDesc\n            };\n\n            this.rulesLookup.addRule(rule.column, rule.row, entry);\n        }\n    }\n\n    resolve(column, row, sortByLookup) {\n        const rules = this.rulesLookup.getRules(column, row);\n\n        if (rules.length === 0) {\n            if (row.type !== 'DATA')\n                return null;\n            if (column.type !== 'DATA')\n                return null;\n            if (!sortByLookup.has('\"HEADER\"'))\n                return null;\n\n            return sortByLookup.get('\"HEADER\"') === 'ASC'\n                ? defaultComparatorAsc\n                : defaultComparatorDesc;\n        }\n\n        if (rules.length > 1)\n            throw new Error('Multiple sorting rules for the same cell'); // TODO: add more context\n\n        const rule = rules[0];\n\n        return sortByLookup.get(rule.by) === 'ASC'\n            ? rule.comparatorAsc\n            : rule.comparatorDesc;\n    }\n}",
         "import SortingRules from \"../types/SortingRules.js\";\n\nexport default function getSortingRules(sorting) {\n    return new SortingRules(sorting);\n}",
         "import stringifyId from \"../core-utils/stringifyId.js\";\n\nfunction getSortByLookup(sortBy, primaryKey, secondaryKey) {\n    const sortByLookup = new Map();\n    for (const cell of sortBy) {\n        const primary = stringifyId(cell[primaryKey]);\n        const secondary = stringifyId(cell[secondaryKey]);\n\n        if (!sortByLookup.has(primary))\n            sortByLookup.set(primary, new Map());\n\n        sortByLookup.get(primary).set(secondary, cell.direction);\n    }\n    return sortByLookup;\n}\n\nfunction flush(temp, result) {\n    temp.sort((lhs, rhs) => {\n        const result = lhs.comparator(lhs.cell, rhs.cell);\n        if (typeof result === 'number')\n            return result;\n        return result ? -1 : 1;\n    });\n    result.push(...temp.map(entry => entry.entity));\n    temp.length = 0;\n}\n\nexport function getSortedRows(sortBy, sortingRules, formattingRules, data, rows, columns, edition) {\n    if (sortBy.length === 0)\n        return rows;\n\n    const sortByLookup = getSortByLookup(sortBy, 'columnId', 'rowId');\n    const columnLookup = new Map(columns.map(column => [column.key, column]));\n    const sortedColumns = sortBy\n        .map(cell => stringifyId(cell.columnId))\n        .filter(key => columnLookup.has(key))\n        .map(key => columnLookup.get(key))\n        .reverse();\n\n    if (sortedColumns.length === 0)\n        return rows;\n\n    for (const column of sortedColumns) {\n        const result = [];\n        const temp = [];\n\n        for (const row of rows) {\n            const comparator = sortingRules.resolve(column, row, sortByLookup.get(column.key));\n\n            if (!comparator) {\n                flush(temp, result);\n                result.push(row);\n                continue;\n            }\n\n            const cell = formattingRules.resolve(data, rows, columns, row, column, edition);\n            const entry = { entity: row, comparator, cell };\n\n            if (temp.length === 0) {\n                temp.push(entry);\n                continue;\n            }\n\n            if (temp[0].comparator === comparator) {\n                temp.push(entry);\n                continue;\n            }\n\n            flush(temp, result);\n            temp.push(entry);\n        }\n\n        flush(temp, result);\n        rows = result;\n    }\n\n    return rows;\n}\n\nexport function getSortedColumns(sortBy, sortingRules, formattingRules, data, rows, columns, edition) {\n    if (sortBy.length === 0)\n        return columns;\n\n    const sortByLookup = getSortByLookup(sortBy, 'rowId', 'columnId');\n    const rowLookup = new Map(rows.map(row => [row.key, row]));\n    const sortedRows = sortBy\n        .map(cell => stringifyId(cell.rowId))\n        .filter(key => rowLookup.has(key))\n        .map(key => rowLookup.get(key))\n        .reverse();\n\n    if (sortedRows.length === 0)\n        return columns;\n\n    for (const row of sortedRows) {\n        const result = [];\n        const temp = [];\n\n        for (const column of columns) {\n            const comparator = sortingRules.resolve(column, row, sortByLookup.get(row.key));\n\n            if (!comparator) {\n                flush(temp, result);\n                result.push(column);\n                continue;\n            }\n\n            const cell = formattingRules.resolve(data, rows, columns, row, column, edition);\n            const entry = { entity: column, comparator, cell };\n\n            if (temp.length === 0) {\n                temp.push(entry);\n                continue;\n            }\n\n            if (temp[0].comparator === comparator) {\n                temp.push(entry);\n                continue;\n            }\n\n            flush(temp, result);\n            temp.push(entry);\n        }\n\n        flush(temp, result);\n        columns = result;\n    }\n\n    return columns;\n}",
         "import stringifyId from \"../core-utils/stringifyId.js\";\n\nconst grabOffset = 5;\n\n// TODO: not working when scrolled\n\nexport function getResizableColumn(columns, columnLookup, rowLookup, hoveredCell, mousePosition) {\n    if (!hoveredCell)\n        return null;\n\n    const column = columnLookup.get(stringifyId(hoveredCell.columnId));\n    const row = rowLookup.get(stringifyId(hoveredCell.rowId));\n    const x = mousePosition.x;\n\n    if (row.type !== 'HEADER')\n        return null;\n\n    if (x >= column.right - grabOffset && x <= column.right + grabOffset)\n        return column.id;\n\n    if (column.index === 0)\n        return null;\n    if (x < column.left - grabOffset || x > column.left + grabOffset)\n        return null;\n\n    return columns[column.index - 1].id;\n}\n\nexport function getResizableRow(rows, columnLookup, rowLookup, hoveredCell, mousePosition) {\n    if (!hoveredCell)\n        return null;\n\n    const column = columnLookup.get(stringifyId(hoveredCell.columnId));\n    const row = rowLookup.get(stringifyId(hoveredCell.rowId));\n    const y = mousePosition.y;\n\n    if (column.type !== 'HEADER')\n        return null;\n\n    if (y >= row.bottom - grabOffset && y <= row.bottom + grabOffset)\n        return row.id;\n\n    if (row.index === 0)\n        return null;\n    if (y < row.top - grabOffset || y > row.top + grabOffset)\n        return null;\n\n    return rows[row.index - 1].id;\n}",
         "export default function getResolvedSortBy(sortBy) {\n    return sortBy.map(sort => ({\n        columnId: 'columnId' in sort ? sort.columnId : 'HEADER',\n        rowId: 'rowId' in sort ? sort.rowId : 'HEADER',\n        direction: sort.direction\n    }));\n}",
         "export default function getResolvedFilters(filters) {\n    return filters.map(filter => ({\n        columnId: 'columnId' in filter ? filter.columnId : 'FILTER',\n        rowId: 'rowId' in filter ? filter.rowId : 'FILTER',\n        expression: filter.expression\n    }));\n}",
-        "import getEditableCells from \"../state-utils/getEditableCells.js\";\nimport getDataFormatting from \"../state-utils/getDataFormatting.js\";\nimport getInputFormatting from \"../state-utils/getInputFormatting.js\";\nimport getRenderFormatting from \"../state-utils/getRenderFormatting.js\";\nimport getSections from \"../state-utils/getSections.js\";\nimport getEditedCellsAndFilters from \"../state-utils/getEditedCellsAndFilters.js\";\nimport getEdition from \"../state-utils/getEdition.js\";\nimport getSelection from \"../state-utils/getSelection.js\";\nimport getInvoked from \"../state-utils/getInvoked.js\";\nimport { getResolvedColumns, getResolvedRows } from \"../state-utils/getResolved.js\";\nimport { getPlacedColumns, getPlacedRows } from \"../state-utils/getPlaced.js\";\nimport getFormattingRules from \"../state-utils/getFormattingRules.js\";\nimport getFormatResolver from \"../state-utils/getFormatResolver.js\";\nimport { getFilteredColumns as getFilteredColumns, getFilteredRows as getFilteredRows } from \"../state-utils/getFiltered.js\";\nimport getFixedSize from \"../state-utils/getFixedSize.js\";\nimport getTotalSize from \"../state-utils/getTotalSize.js\";\nimport getTextResolver from \"../state-utils/getTextResolver.js\";\nimport getScrollRect from \"../state-utils/getScrollRect.js\";\nimport getHoveredCell from \"../state-utils/getHoveredCell.js\";\nimport getLookup from \"../state-utils/getLookup.js\";\nimport getHighlightedCells from \"../state-utils/getHighlightedCells.js\";\nimport getInputPlacement from \"../state-utils/getInputPlacement.js\";\nimport getIsTextValid from \"../state-utils/getIsTextValid.js\";\nimport { getUnfoldedColumns, getUnfoldedRows } from \"../state-utils/getUnfolded.js\";\nimport getFilteringRules from \"../state-utils/getFilteringRules.js\";\nimport getFilterFormatting from \"../state-utils/getFilterFormatting.js\";\nimport getMeasureFormatting from \"../state-utils/getMeasureFormatting.js\";\nimport { getMeasuredColumns, getMeasuredRows } from \"../state-utils/getMeasured.js\";\nimport getKeys from \"../state-utils/getKeys.js\";\nimport getSortingFormatting from \"../state-utils/getSortingFormatting.js\";\nimport getSortingRules from \"../state-utils/getSortingRules.js\";\nimport { getSortedColumns, getSortedRows } from \"../state-utils/getSorted.js\";\nimport { getResizableColumn, getResizableRow } from \"../state-utils/getResizable.js\";\nimport getResolvedSortBy from \"../state-utils/getResolvedSortBy.js\";\nimport getResolvedFilters from \"../state-utils/getResolvedFilters.js\";\n\n// TODO: write some test to check if the cache is working properly\nfunction updateStateInternal(context) {\n    console.count('updateState');\n\n    const options = { ...context.localOptions, ...context.externalOptions };\n    const memory = context.memory;\n    const previousState = context.state;\n\n    // TODO: Move to utils\n    function cache(key, func, dependencies) {\n        const previousDependencies = memory[key] && memory[key].dependencies;\n        if (!previousDependencies || dependencies.some((dependency, index) => dependency !== previousDependencies[index]))\n            memory[key] = { value: func(...dependencies), dependencies };\n        return memory[key].value;\n    }\n\n    const devicePixelRatio = window.devicePixelRatio; // TODO: Trigger update on devicePixelRatio change\n    const borderWidth = options.borderWidth / devicePixelRatio;\n    const data = options.data;\n    const text = context.input.value;\n    const sortBy = cache('sortBy', getResolvedSortBy, [options.sortBy]);\n    const filters = cache('filters', getResolvedFilters, [options.filters]);\n    const textResolver = cache('textResolver', getTextResolver, []);\n    const dataFormatting = cache('dataFormatting', getDataFormatting, [options.formatting, options.dataSelector, sortBy]);\n    const editedCellsAndFilters = cache('editedCellsAndFilters', getEditedCellsAndFilters, [options.editedCells, filters]);\n    const edition = cache('edition', getEdition, [editedCellsAndFilters]);\n    const invokedColumns = cache('invokedColumns', getInvoked, [options.columns, data]);\n    const invokedRows = cache('invokedRows', getInvoked, [options.rows, data]);\n    // TODO: throw on duplicate ids\n    // TODO: throw on duplicate row/column filter ids\n    const unfoldedColumns = cache('unfoldedColumns', getUnfoldedColumns, [invokedColumns, data]);\n    const unfoldedRows = cache('unfoldedRows', getUnfoldedRows, [invokedRows, data]);\n    const unfilteredColumns = cache('unfilteredColumns', getResolvedColumns, [unfoldedColumns, options.pinnedLeft, options.pinnedRight, options.columnWidths]);\n    const unfilteredRows = cache('unfilteredRows', getResolvedRows, [unfoldedRows, options.pinnedTop, options.pinnedBottom, options.rowHeights]);\n    const unfilteredColumnKeys = cache('unfilteredColumnKeys', getKeys, [unfilteredColumns]);\n    const unfilteredRowKeys = cache('unfilteredRowKeys', getKeys, [unfilteredRows]);\n\n    // Filtering\n    const filterFormatting = cache('filterFormatting', getFilterFormatting, [dataFormatting]);\n    const filterFormattingRules = cache('filterFormattingRules', getFormattingRules, [filterFormatting]);\n    const filteringRules = cache('filteringRules', getFilteringRules, [options.filtering]);\n    const filteredColumns = cache('filteredColumns', getFilteredColumns, [filters, filteringRules, filterFormattingRules, data, unfilteredRows, unfilteredColumns, edition]);\n    const filteredRows = cache('filteredRows', getFilteredRows, [filters, filteringRules, filterFormattingRules, data, unfilteredRows, unfilteredColumns, edition]);\n\n    // Sorting\n    const sortingFormatting = cache('sortingFormatting', getSortingFormatting, [dataFormatting]);\n    const sortingFormattingRules = cache('sortingFormattingRules', getFormattingRules, [sortingFormatting]);\n    const sortingRules = cache('sortingRules', getSortingRules, [options.sorting]);\n    const sortedColumns = cache('sortedColumns', getSortedColumns, [sortBy, sortingRules, sortingFormattingRules, data, filteredRows, filteredColumns, edition]);\n    const sortedRows = cache('sortedRows', getSortedRows, [sortBy, sortingRules, sortingFormattingRules, data, filteredRows, filteredColumns, edition]);\n\n    // Shaping\n    const shapedColumns = sortedColumns;\n    const shapedRows = sortedRows;\n\n    // Measuring\n    const measureFormatting = cache('measureFormatting', getMeasureFormatting, [dataFormatting]);\n    const measureFormattingRules = cache('measureFormattingRules', getFormattingRules, [measureFormatting]);\n    const measureFormatResolver = cache('measureFormatResolver', getFormatResolver, [measureFormattingRules, data, shapedRows, shapedColumns, edition]);\n    const columnWidthCache = context.columnWidthCache;\n    const rowHeightCache = context.rowHeightCache;\n    const measuredColumns = cache('measuredColumns', getMeasuredColumns, [shapedColumns, shapedRows, textResolver, measureFormatResolver, columnWidthCache, unfilteredColumnKeys]);\n    const measuredRows = cache('measuredRows', getMeasuredRows, [shapedColumns, shapedRows, textResolver, measureFormatResolver, rowHeightCache, unfilteredRowKeys]);\n\n    // Placement\n    const columns = cache('columns', getPlacedColumns, [measuredColumns, devicePixelRatio, borderWidth]);\n    const rows = cache('rows', getPlacedRows, [measuredRows, devicePixelRatio, borderWidth]);\n    const columnLookup = cache('columnLookup', getLookup, [columns]);\n    const rowLookup = cache('rowLookup', getLookup, [rows]);\n    const focusedCell = options.focusedCell;\n    const sections = cache('sections', getSections, [columns, rows]);\n    const selectedCells = options.selectedCells;\n    const fixedSize = cache('fixedSize', getFixedSize, [sections.top.height, sections.bottom.height, sections.left.width, sections.right.width]);\n    const totalSize = cache('totalSize', getTotalSize, [columns, rows]);\n    // TODO: do some proper caching, so that if value is not changed, the old value is returned (currently not working because of scrolling)\n    const hoveredCell = getHoveredCell(context.element, context.mousePosition, rows, columns, fixedSize, totalSize);\n    const resizableColumn = context.resizingColumn || cache('resizableColumn', getResizableColumn, [columns, columnLookup, rowLookup, hoveredCell, context.mousePosition]);\n    const resizableRow = context.resizingRow || cache('resizableRow', getResizableRow, [rows, columnLookup, rowLookup, hoveredCell, context.mousePosition]);\n    const isMouseDown = context.isMouseDown;\n    const isResizing = !!resizableColumn || !!resizableRow;\n    const highlightedCells = cache('highlightedCells', getHighlightedCells, [isMouseDown, isResizing, focusedCell, hoveredCell, columns, rows, columnLookup, rowLookup]);\n    const selection = cache('selection', getSelection, [selectedCells]);\n    const highlight = cache('highlight', getSelection, [highlightedCells]);\n    // TODO: addDataFormattingRules and addRenderFormattingRules should remove unnecessary rules\n    const renderFormatting = cache('renderFormatting', getRenderFormatting, [dataFormatting, hoveredCell, focusedCell, selection, highlight, edition, resizableColumn, resizableRow]);\n    const renderFormattingRules = cache('renderFormattingRules', getFormattingRules, [renderFormatting]);\n    const renderFormatResolver = cache('renderFormatResolver', getFormatResolver, [renderFormattingRules, data, rows, columns, edition]);\n    const inputFormatting = cache('inputFormatting', getInputFormatting, [dataFormatting]);\n    const inputFormattingRules = cache('inputFormattingRules', getFormattingRules, [inputFormatting]);\n    const inputFormatResolver = cache('inputFormatResolver', getFormatResolver, [inputFormattingRules, data, rows, columns, edition]);\n    const editableCells = cache('editableCells', getEditableCells, [selectedCells, inputFormatResolver, columnLookup, rowLookup]);\n    const inputPlacement = cache('inputPlacement', getInputPlacement, [editableCells, focusedCell, columnLookup, rowLookup]);\n    const isTextValid = cache('isTextValid', getIsTextValid, [text, editableCells]);\n\n    // cache result, but not call\n    const scrollRect = getScrollRect(previousState?.scrollRect, totalSize, fixedSize, context.element);\n\n    context.state = {\n        options,\n        devicePixelRatio,\n        borderWidth,\n        data,\n        dataFormatting,\n        edition,\n        filteredColumns,\n        filteredRows,\n        columns,\n        rows,\n        sections,\n        selectedCells,\n        selection,\n        highlight,\n        hoveredCell,\n        focusedCell,\n        renderFormatting,\n        renderFormatResolver,\n        inputFormatting,\n        inputFormatResolver,\n        fixedSize,\n        totalSize,\n        textResolver,\n        scrollRect,\n        highlightedCells,\n        inputPlacement,\n        columnLookup,\n        rowLookup,\n        text,\n        isTextValid,\n        resizableColumn,\n        resizableRow,\n    };\n}\n\nexport default function updateState(context) {\n    if (!context.error) {\n        try {\n            updateStateInternal(context);\n        } catch (error) {\n            context.error = error;\n        }\n    }\n}",
+        "import getEditableCells from \"../state-utils/getEditableCells.js\";\nimport getDataFormatting from \"../state-utils/getDataFormatting.js\";\nimport getInputFormatting from \"../state-utils/getInputFormatting.js\";\nimport getRenderFormatting from \"../state-utils/getRenderFormatting.js\";\nimport getSections from \"../state-utils/getSections.js\";\nimport getEditedCellsAndFilters from \"../state-utils/getEditedCellsAndFilters.js\";\nimport getEdition from \"../state-utils/getEdition.js\";\nimport getSelection from \"../state-utils/getSelection.js\";\nimport getInvoked from \"../state-utils/getInvoked.js\";\nimport { getResolvedColumns, getResolvedRows } from \"../state-utils/getResolved.js\";\nimport { getPlacedColumns, getPlacedRows } from \"../state-utils/getPlaced.js\";\nimport getFormattingRules from \"../state-utils/getFormattingRules.js\";\nimport getFormatResolver from \"../state-utils/getFormatResolver.js\";\nimport { getFilteredColumns as getFilteredColumns, getFilteredRows as getFilteredRows } from \"../state-utils/getFiltered.js\";\nimport getFixedSize from \"../state-utils/getFixedSize.js\";\nimport getTotalSize from \"../state-utils/getTotalSize.js\";\nimport getTextResolver from \"../state-utils/getTextResolver.js\";\nimport getScrollRect from \"../state-utils/getScrollRect.js\";\nimport getHoveredCell from \"../state-utils/getHoveredCell.js\";\nimport getLookup from \"../state-utils/getLookup.js\";\nimport getHighlightedCells from \"../state-utils/getHighlightedCells.js\";\nimport getInputPlacement from \"../state-utils/getInputPlacement.js\";\nimport getIsTextValid from \"../state-utils/getIsTextValid.js\";\nimport { getUnfoldedColumns, getUnfoldedRows } from \"../state-utils/getUnfolded.js\";\nimport getFilteringRules from \"../state-utils/getFilteringRules.js\";\nimport getFilterFormatting from \"../state-utils/getFilterFormatting.js\";\nimport getMeasureFormatting from \"../state-utils/getMeasureFormatting.js\";\nimport { getMeasuredColumns, getMeasuredRows } from \"../state-utils/getMeasured.js\";\nimport getKeys from \"../state-utils/getKeys.js\";\nimport getSortingFormatting from \"../state-utils/getSortingFormatting.js\";\nimport getSortingRules from \"../state-utils/getSortingRules.js\";\nimport { getSortedColumns, getSortedRows } from \"../state-utils/getSorted.js\";\nimport { getResizableColumn, getResizableRow } from \"../state-utils/getResizable.js\";\nimport getResolvedSortBy from \"../state-utils/getResolvedSortBy.js\";\nimport getResolvedFilters from \"../state-utils/getResolvedFilters.js\";\n\n// TODO: write some test to check if the cache is working properly\nfunction updateStateInternal(context) {\n    console.count('updateState');\n\n    const options = { ...context.localOptions, ...context.externalOptions };\n    const memory = context.memory;\n    const previousState = context.state;\n\n    // TODO: Move to utils\n    function cache(key, func, dependencies) {\n        const previousDependencies = memory[key] && memory[key].dependencies;\n        if (!previousDependencies || dependencies.some((dependency, index) => dependency !== previousDependencies[index]))\n            memory[key] = { value: func(...dependencies), dependencies };\n        return memory[key].value;\n    }\n\n    const devicePixelRatio = window.devicePixelRatio; // TODO: Trigger update on devicePixelRatio change\n    const borderWidth = options.borderWidth / devicePixelRatio;\n    const data = options.data;\n    const text = context.input.value;\n    const sortBy = cache('sortBy', getResolvedSortBy, [options.sortBy]);\n    const filters = cache('filters', getResolvedFilters, [options.filters]);\n    const textResolver = cache('textResolver', getTextResolver, []);\n    const dataFormatting = cache('dataFormatting', getDataFormatting, [options.formatting, options.dataSelector, sortBy]);\n    const editedCellsAndFilters = cache('editedCellsAndFilters', getEditedCellsAndFilters, [options.editedCells, filters]);\n    const edition = cache('edition', getEdition, [editedCellsAndFilters]);\n    const invokedColumns = cache('invokedColumns', getInvoked, [options.columns, data]);\n    const invokedRows = cache('invokedRows', getInvoked, [options.rows, data]);\n    // TODO: throw on duplicate ids\n    // TODO: throw on duplicate row/column filter ids\n    const unfoldedColumns = cache('unfoldedColumns', getUnfoldedColumns, [invokedColumns, data]);\n    const unfoldedRows = cache('unfoldedRows', getUnfoldedRows, [invokedRows, data]);\n    const unfilteredColumns = cache('unfilteredColumns', getResolvedColumns, [unfoldedColumns, options.pinnedLeft, options.pinnedRight, options.columnWidths]);\n    const unfilteredRows = cache('unfilteredRows', getResolvedRows, [unfoldedRows, options.pinnedTop, options.pinnedBottom, options.rowHeights]);\n    const unfilteredColumnKeys = cache('unfilteredColumnKeys', getKeys, [unfilteredColumns]);\n    const unfilteredRowKeys = cache('unfilteredRowKeys', getKeys, [unfilteredRows]);\n\n    // Filtering\n    const filterFormatting = cache('filterFormatting', getFilterFormatting, [dataFormatting]);\n    const filterFormattingRules = cache('filterFormattingRules', getFormattingRules, [filterFormatting]);\n    const filteringRules = cache('filteringRules', getFilteringRules, [options.filtering]);\n    const filteredColumns = cache('filteredColumns', getFilteredColumns, [filters, filteringRules, filterFormattingRules, data, unfilteredRows, unfilteredColumns, edition]);\n    const filteredRows = cache('filteredRows', getFilteredRows, [filters, filteringRules, filterFormattingRules, data, unfilteredRows, unfilteredColumns, edition]);\n\n    // Sorting\n    const sortingFormatting = cache('sortingFormatting', getSortingFormatting, [dataFormatting]);\n    const sortingFormattingRules = cache('sortingFormattingRules', getFormattingRules, [sortingFormatting]);\n    const sortingRules = cache('sortingRules', getSortingRules, [options.sorting]);\n    const sortedColumns = cache('sortedColumns', getSortedColumns, [sortBy, sortingRules, sortingFormattingRules, data, filteredRows, filteredColumns, edition]);\n    const sortedRows = cache('sortedRows', getSortedRows, [sortBy, sortingRules, sortingFormattingRules, data, filteredRows, filteredColumns, edition]);\n\n    // Shaping\n    const shapedColumns = sortedColumns;\n    const shapedRows = sortedRows;\n\n    // Measuring\n    const measureFormatting = cache('measureFormatting', getMeasureFormatting, [dataFormatting]);\n    const measureFormattingRules = cache('measureFormattingRules', getFormattingRules, [measureFormatting]);\n    const measureFormatResolver = cache('measureFormatResolver', getFormatResolver, [measureFormattingRules, data, shapedRows, shapedColumns, edition]);\n    const columnWidthCache = context.columnWidthCache;\n    const rowHeightCache = context.rowHeightCache;\n    const measuredColumns = cache('measuredColumns', getMeasuredColumns, [shapedColumns, shapedRows, textResolver, measureFormatResolver, columnWidthCache, unfilteredColumnKeys]);\n    const measuredRows = cache('measuredRows', getMeasuredRows, [shapedColumns, shapedRows, textResolver, measureFormatResolver, rowHeightCache, unfilteredRowKeys]);\n\n    // Placement\n    const columns = cache('columns', getPlacedColumns, [measuredColumns, devicePixelRatio, borderWidth]);\n    const rows = cache('rows', getPlacedRows, [measuredRows, devicePixelRatio, borderWidth]);\n    const columnLookup = cache('columnLookup', getLookup, [columns]);\n    const rowLookup = cache('rowLookup', getLookup, [rows]);\n    const focusedCell = options.focusedCell;\n    const sections = cache('sections', getSections, [columns, rows]);\n    const selectedCells = options.selectedCells;\n    const fixedSize = cache('fixedSize', getFixedSize, [sections.top.height, sections.bottom.height, sections.left.width, sections.right.width]);\n    const totalSize = cache('totalSize', getTotalSize, [columns, rows]);\n    // TODO: do some proper caching, so that if value is not changed, the old value is returned (currently not working because of scrolling)\n    const hoveredCell = getHoveredCell(context.element, context.mousePosition, rows, columns, fixedSize, totalSize);\n    const resizableColumn = context.resizingColumn || cache('resizableColumn', getResizableColumn, [columns, columnLookup, rowLookup, hoveredCell, context.mousePosition]);\n    const resizableRow = context.resizingRow || cache('resizableRow', getResizableRow, [rows, columnLookup, rowLookup, hoveredCell, context.mousePosition]);\n    const isMouseDown = context.isMouseDown;\n    const isResizing = !!resizableColumn || !!resizableRow;\n    const highlightedCells = cache('highlightedCells', getHighlightedCells, [isMouseDown, isResizing, focusedCell, hoveredCell, columns, rows, columnLookup, rowLookup]);\n    const selection = cache('selection', getSelection, [selectedCells]);\n    const highlight = cache('highlight', getSelection, [highlightedCells]);\n    // TODO: addDataFormattingRules and addRenderFormattingRules should remove unnecessary rules\n    const renderFormatting = cache('renderFormatting', getRenderFormatting, [dataFormatting, hoveredCell, focusedCell, selection, highlight, edition, resizableColumn, resizableRow]);\n    const renderFormattingRules = cache('renderFormattingRules', getFormattingRules, [renderFormatting]);\n    const renderFormatResolver = cache('renderFormatResolver', getFormatResolver, [renderFormattingRules, data, rows, columns, edition]);\n    const inputFormatting = cache('inputFormatting', getInputFormatting, [dataFormatting]);\n    const inputFormattingRules = cache('inputFormattingRules', getFormattingRules, [inputFormatting]);\n    const inputFormatResolver = cache('inputFormatResolver', getFormatResolver, [inputFormattingRules, data, rows, columns, edition]);\n    const editableCells = cache('editableCells', getEditableCells, [selectedCells, inputFormatResolver, columnLookup, rowLookup]);\n    const inputPlacement = cache('inputPlacement', getInputPlacement, [editableCells, focusedCell, columnLookup, rowLookup, sections]);\n    const isTextValid = cache('isTextValid', getIsTextValid, [text, editableCells]);\n\n    // cache result, but not call\n    const scrollRect = getScrollRect(previousState?.scrollRect, totalSize, fixedSize, context.element);\n\n    context.state = {\n        options,\n        devicePixelRatio,\n        borderWidth,\n        data,\n        dataFormatting,\n        edition,\n        filteredColumns,\n        filteredRows,\n        columns,\n        rows,\n        sections,\n        selectedCells,\n        selection,\n        highlight,\n        hoveredCell,\n        focusedCell,\n        renderFormatting,\n        renderFormatResolver,\n        inputFormatting,\n        inputFormatResolver,\n        fixedSize,\n        totalSize,\n        textResolver,\n        scrollRect,\n        highlightedCells,\n        inputPlacement,\n        columnLookup,\n        rowLookup,\n        text,\n        isTextValid,\n        resizableColumn,\n        resizableRow,\n    };\n}\n\nexport default function updateState(context) {\n    if (!context.error) {\n        try {\n            updateStateInternal(context);\n        } catch (error) {\n            context.error = error;\n        }\n    }\n}",
         "import getColumnIndex from \"./getColumnIndex.js\";\nimport getRowIndex from \"./getRowIndex.js\";\n\nexport default function getHoveredCell(element, mousePosition, rows, columns, fixedSize, totalSize) {\n    // TODO: sometimes mousePosition is outside of bounds and it crashes the click events\n\n    if (!mousePosition)\n        return null;\n    if (mousePosition.x < 0 || mousePosition.y < 0 || mousePosition.x > totalSize.width || mousePosition.y > totalSize.height)\n        return null;\n\n    const scrollOffset = {\n        left: element.scrollLeft,\n        top: element.scrollTop\n    };\n\n    const clientSize = {\n        width: element.clientWidth,\n        height: element.clientHeight\n    };\n\n    const x = mousePosition.x <= fixedSize.left\n        ? mousePosition.x\n        : mousePosition.x >= clientSize.width - fixedSize.right\n            ? totalSize.width - clientSize.width + mousePosition.x\n            : mousePosition.x + scrollOffset.left;\n    const y = mousePosition.y <= fixedSize.top\n        ? mousePosition.y\n        : mousePosition.y >= clientSize.height - fixedSize.bottom\n            ? totalSize.height - clientSize.height + mousePosition.y\n            : mousePosition.y + scrollOffset.top;\n\n    const hoverRowIndex = getRowIndex(rows, y);\n    const hoverColumnIndex = getColumnIndex(columns, x);\n\n    if (hoverRowIndex === -1 || hoverColumnIndex === -1)\n        return null;\n\n    return {\n        rowId: rows[hoverRowIndex].id,\n        columnId: columns[hoverColumnIndex].id\n    };\n}\n",
         "export default function getRowIndex(rows, y) {\n    if (rows.length === 0)\n        return -1;\n    if (y < rows[0].topWithBorder)\n        return -1;\n    if (y > rows[rows.length - 1].bottomWithBorder)\n        return -1;\n\n    let iterA = 0;\n    let iterC = rows.length - 1;\n\n    while (iterA <= iterC) {\n        const iterB = Math.floor((iterA + iterC) / 2);\n\n        if (y < rows[iterB].topWithBorder)\n            iterC = iterB - 1;\n        else if (y > rows[iterB].bottomWithBorder)\n            iterA = iterB + 1;\n\n        else\n            return iterB;\n    }\n\n    return -1;\n}\n",
         "export default function getColumnIndex(columns, x) {\n    if (columns.length === 0)\n        return -1;\n    if (x < columns[0].leftWithBorder)\n        return -1;\n    if (x > columns[columns.length - 1].rightWithBorder)\n        return -1;\n\n    let iterA = 0;\n    let iterC = columns.length - 1;\n\n    while (iterA <= iterC) {\n        const iterB = Math.floor((iterA + iterC) / 2);\n\n        if (x < columns[iterB].leftWithBorder)\n            iterC = iterB - 1;\n        else if (x > columns[iterB].rightWithBorder)\n            iterA = iterB + 1;\n\n        else\n            return iterB;\n    }\n\n    return -1;\n}\n",
         "import Selection from \"../types/Selection.js\";\n\nexport default function getCombinedCells(previousCells, newCells) {\n    const selection = new Selection(newCells);\n    return [...newCells, ...previousCells.filter(cell => !selection.isIdSelected(cell.rowId, cell.columnId))];\n}\n",
         "import Selection from \"../types/Selection.js\";\n\nexport default function getReducedCells(previousCells, cellsToRemove) {\n    const selection = new Selection(cellsToRemove);\n    return previousCells.filter(cell => !selection.isIdSelected(cell.rowId, cell.columnId));\n}\n",
         "export default function getMousePosition(event) {\n    const element = event.currentTarget;\n    const rect = element.getBoundingClientRect();\n    return {\n        x: event.clientX - rect.left,\n        y: event.clientY - rect.top\n    };\n}",
-        "import getEditableCells from \"./state-utils/getEditableCells.js\";\nimport stringifyId from \"./core-utils/stringifyId.js\";\nimport render from \"./core/render.js\";\nimport updateState from \"./core/state.js\";\nimport getCombinedCells from \"./state-utils/getCombinedCells.js\";\nimport getReducedCells from \"./state-utils/getReducedCells.js\";\nimport getMousePosition from \"./state-utils/getMousePosition.js\";\nimport getNewSortBy from \"./state-utils/getNewSortBy.js\";\nimport getClipboardData from \"./state-utils/getClipboardData.js\";\n\nfunction initialize(element) {\n    if ('spread-grid-context' in element) return;\n\n    console.log('initialize');\n\n    const canvases = {\n        'top-left': document.createElement('canvas'),\n        'top-center': document.createElement('canvas'),\n        'top-right': document.createElement('canvas'),\n        'middle-left': document.createElement('canvas'),\n        'middle-center': document.createElement('canvas'),\n        'middle-right': document.createElement('canvas'),\n        'bottom-left': document.createElement('canvas'),\n        'bottom-center': document.createElement('canvas'),\n        'bottom-right': document.createElement('canvas')\n    };\n    const input = document.createElement('input');\n\n    element.setAttribute('tabindex', '0');\n    element.setAttribute('style', 'max-width: 100vw; max-height: 100vh; overflow: auto; display: grid; position: relative; grid-template-columns: fit-content(0) fit-content(0) fit-content(0); grid-template-rows: fit-content(0) fit-content(0) fit-content(0); outline: none; user-select: none;');\n    element.classList.add('spread-grid');\n    canvases['top-left'].setAttribute('style', 'position: sticky; left: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 1;');\n    canvases['top-center'].setAttribute('style', 'position: sticky; top: 0; z-index: 1; grid-row: 1; grid-column: 2;');\n    canvases['top-right'].setAttribute('style', 'position: sticky; right: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 3;');\n    canvases['middle-left'].setAttribute('style', 'position: sticky; left: 0; z-index: 1; grid-row: 2; grid-column: 1;');\n    canvases['middle-center'].setAttribute('style', 'grid-row: 2; grid-column: 2;');\n    canvases['middle-right'].setAttribute('style', 'position: sticky; right: 0; z-index: 1; grid-row: 2; grid-column: 3;');\n    canvases['bottom-left'].setAttribute('style', 'position: sticky; left: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 1;');\n    canvases['bottom-center'].setAttribute('style', 'position: sticky; bottom: 0; z-index: 1; grid-row: 3; grid-column: 2;');\n    canvases['bottom-right'].setAttribute('style', 'position: sticky; right: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 3;');\n    input.setAttribute('style', 'position: absolute; z-index: 3; outline: none; border: none; box-shadow: none; padding: 0 5px; font-size: 12px; font-family: Calibri; background-color: white; box-sizing: border-box; opacity: 0; pointer-events: none;');\n\n    const context = {\n        externalOptions: {},\n        state: null,\n        memory: {},\n        element: element,\n        canvases: canvases,\n        input: input,\n        renderRequested: false,\n        mousePosition: null,\n        isMouseDown: false,\n        columnWidthCache: new Map(),\n        rowHeightCache: new Map(),\n    };\n\n    context.requestNewRender = () => {\n        if (context.renderRequested) return;\n        context.renderRequested = true;\n        requestAnimationFrame(() => {\n            context.renderRequested = false;\n            updateState(context);\n            render(context);\n        });\n    };\n\n    context.addEventListener = (element, type, listener) => {\n        element.addEventListener(type, (event) => {\n            try {\n                listener(event);\n            }\n            catch (error) {\n                error.message = `[${type} event]: ${error.message}`;\n                context.error = error;\n                context.requestNewRender();\n            }\n        });\n    }\n\n    context.localOptions = {\n        data: [],\n        columns: [{ type: 'DATA-BLOCK' }],\n        rows: [{ type: 'HEADER' }, { type: 'DATA-BLOCK' }],\n        formatting: [],\n        filtering: [],\n        sorting: [],\n        dataSelector: ({ data, row, column }) => data[row.id][column.id],\n        pinnedTop: 0,\n        pinnedBottom: 0,\n        pinnedLeft: 0,\n        pinnedRight: 0,\n        borderWidth: 1,\n        focusedCell: null,\n        onFocusedCellChange: (focusedCell) => {\n            context.localOptions.focusedCell = focusedCell;\n            context.requestNewRender();\n        },\n        selectedCells: [],\n        onSelectedCellsChange: (selectedCells) => {\n            context.localOptions.selectedCells = selectedCells;\n            context.requestNewRender();\n        },\n        highlightedCells: [],\n        editedCells: [],\n        onEditedCellsChange: (editedCells) => {\n            // TODO: optimize by coalescing\n            context.localOptions.editedCells = editedCells;\n            context.requestNewRender();\n        },\n        filters: [],\n        onFiltersChange: (filters) => {\n            context.localOptions.filters = filters;\n            context.requestNewRender();\n        },\n        sortBy: [],\n        onSortByChange: (sortBy) => {\n            context.localOptions.sortBy = sortBy;\n            context.requestNewRender();\n        },\n        onCellClick: () => { },\n        onCustomCellClick: () => { },\n        columnWidths: [],\n        onColumnWidthsChange: (columnWidths) => {\n            context.localOptions.columnWidths = columnWidths;\n            context.requestNewRender();\n        },\n        rowHeights: [],\n        onRowHeightsChange: (rowHeights) => {\n            context.localOptions.rowHeights = rowHeights;\n            context.requestNewRender();\n        }\n    };\n\n    element['spread-grid-context'] = context;\n\n    const setText = (text) => {\n        input.value = text;\n        input.dispatchEvent(new Event('input'));\n    }\n\n    const accept = (autoCommit) => {\n        const selectedCells = context.state.options.selectedCells;\n        const formatResolver = context.state.inputFormatResolver;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const text = context.state.text;\n        const isTextValid = context.state.isTextValid;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const setFilters = context.state.options.onFiltersChange;\n        const addEditedCells = (cells) => setEditedCells(getCombinedCells(context.state.options.editedCells, cells));\n        const addFilters = (cells) => setFilters(getCombinedCells(context.state.options.filters, cells));\n        const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n\n        if (text === '')\n            return;\n        if (!isTextValid)\n            return;\n        if (autoCommit && !editableCells.every(cell => cell.edit.autoCommit))\n            return;\n\n        const dataCells = editableCells.filter(cell => cell.type === 'DATA');\n        const filterCells = editableCells.filter(cell => cell.type === 'FILTER');\n\n        addEditedCells(dataCells.map(cell => ({ ...cell.cell, value: cell.edit.parse({ string: text }) })));\n        addFilters(filterCells.map(cell => ({ ...cell.cell, expression: cell.edit.parse({ string: text }) })));\n\n        if (!autoCommit)\n            setText('');\n    };\n\n    const clear = (autoCommit) => {\n        const selectedCells = context.state.options.selectedCells;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const setFilters = context.state.options.onFiltersChange;\n        const removeEditedCells = (cells) => setEditedCells(getReducedCells(context.state.options.editedCells, cells));\n        const removeFilters = (cells) => setFilters(getReducedCells(context.state.options.filters, cells));\n        const formatResolver = context.state.inputFormatResolver;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n\n        if (autoCommit && !editableCells.every(cell => cell.edit.autoCommit))\n            return;\n\n        removeEditedCells(selectedCells);\n        removeFilters(selectedCells);\n    }\n\n    // TODO: Move other input functions here as well\n\n    context.addEventListener(element, 'scroll', (event) => {\n        // TODO: only request new render if scroll position changed outside of the scope\n        // TODO: how to: calculate the new scrollRect here and compare it to the one in the state\n        // TODO: Also don't forget to check if the highlighted cell did change\n        // TODO: Consider forcing a new render when visible scrollRect changes (without waiting for the next render frame)\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseenter', (event) => {\n        context.mousePosition = getMousePosition(event);\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mousemove', (event) => {\n        context.mousePosition = getMousePosition(event);\n\n        if (context.resizingColumn) {\n            const column = context.state.columnLookup.get(stringifyId(context.resizingColumn));\n            const columnWidth = column.width;\n            const columnRight = column.right;\n            const mousePosition = context.mousePosition.x;\n            const newColumnWidth = Math.max(10, mousePosition - columnRight + columnWidth);\n            const previousColumnWidths = context.state.options.columnWidths;\n            const newColumnWidths = previousColumnWidths\n                .filter(columnWidth => stringifyId(columnWidth.columnId) !== column.key)\n                .concat([{ columnId: column.id, width: newColumnWidth }]);\n            context.state.options.onColumnWidthsChange(newColumnWidths);\n        }\n        if (context.resizingRow) {\n            const row = context.state.rowLookup.get(stringifyId(context.resizingRow));\n            const rowHeight = row.height;\n            const rowBottom = row.bottom;\n            const mousePosition = context.mousePosition.y;\n            const newRowHeight = Math.max(10, mousePosition - rowBottom + rowHeight);\n            const previousRowHeights = context.state.options.rowHeights;\n            const newRowHeights = previousRowHeights\n                .filter(rowHeight => stringifyId(rowHeight.rowId) !== row.key)\n                .concat([{ rowId: row.id, height: newRowHeight }]);\n            context.state.options.onRowHeightsChange(newRowHeights);\n        }\n\n        // TODO: only request new render if hovered cell changed\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseleave', () => {\n        context.mousePosition = null;\n        context.requestNewRender();\n    });\n\n    // TODO: update mouse position on resize\n\n    context.addEventListener(element, 'mousedown', (event) => {\n        updateState(context);\n        setText('');\n\n        context.isMouseDown = true;\n        context.mouseDownPosition = context.mousePosition;\n        context.mouseDownCell = context.state.hoveredCell;\n\n        if (context.state.resizableColumn) {\n            context.resizingColumn = context.state.resizableColumn;\n        }\n        if (context.state.resizableRow) {\n            context.resizingRow = context.state.resizableRow;\n        }\n        if (!context.state.resizableColumn && !context.state.resizableRow) {\n            context.state.options.onFocusedCellChange(context.state.hoveredCell);\n        }\n\n        if (!event.ctrlKey)\n            context.state.options.onSelectedCellsChange([]);\n\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseup', (event) => {\n        updateState(context);\n\n        context.isMouseDown = false;\n        context.resizingColumn = null;\n        context.resizingRow = null;\n\n        context.state.options.onSelectedCellsChange(getCombinedCells(context.state.options.selectedCells, context.state.highlightedCells));\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'pointerdown', (event) => {\n        context.element.setPointerCapture(event.pointerId);\n    });\n\n    context.addEventListener(element, 'pointerup', (event) => {\n        context.element.releasePointerCapture(event.pointerId);\n    });\n\n    context.addEventListener(element, 'click', (event) => {\n        updateState(context);\n\n        const cell = context.state.hoveredCell;\n        const mouseDownCell = context.mouseDownCell;\n\n        if (context.state.resizableColumn || context.state.resizableRow)\n            return;\n        if (cell === null)\n            return;\n        if (stringifyId(cell.columnId) !== stringifyId(mouseDownCell.columnId))\n            return;\n        if (stringifyId(cell.rowId) !== stringifyId(mouseDownCell.rowId))\n            return;\n\n        const column = context.state.columnLookup.get(stringifyId(cell.columnId));\n        const row = context.state.rowLookup.get(stringifyId(cell.rowId));\n        const sortBy = context.state.options.sortBy;\n\n        if (column.type === 'DATA' && row.type === 'DATA') {\n            context.state.options.onCellClick(context.state.hoveredCell);\n        } else if (column.type === 'CUSTOM' || row.type === 'CUSTOM') {\n            context.state.options.onCustomCellClick(context.state.hoveredCell);\n        } else if (column.type === 'HEADER' || row.type === 'HEADER') {\n            const newSortBy = getNewSortBy(sortBy, column, row, event.ctrlKey);\n            context.state.options.onSortByChange(newSortBy);\n            context.state.options.onSelectedCellsChange([]);\n        }\n    });\n\n    context.addEventListener(element, 'dblclick', (event) => {\n        updateState(context);\n\n        if (context.state.resizableColumn) {\n            const resizableColumnKey = stringifyId(context.state.resizableColumn);\n            const newColumnWidths = context.state.options.columnWidths.filter(columnWidth => stringifyId(columnWidth.columnId) !== resizableColumnKey);\n            context.state.options.onColumnWidthsChange(newColumnWidths);\n            context.columnWidthCache.delete(resizableColumnKey);\n        }\n        if (context.state.resizableRow) {\n            const resizableRowKey = stringifyId(context.state.resizableRow);\n            const newRowHeights = context.state.options.rowHeights.filter(rowHeight => stringifyId(rowHeight.rowId) !== resizableRowKey);\n            context.state.options.onRowHeightsChange(newRowHeights);\n            context.rowHeightCache.delete(resizableRowKey);\n        }\n\n        const focusedCell = context.state.focusedCell;\n        if (focusedCell === null)\n            return;\n\n        const focusedColumnKey = stringifyId(focusedCell.columnId);\n        const focusedRowKey = stringifyId(focusedCell.rowId);\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const formatResolver = context.state.inputFormatResolver;\n\n        if (!columnLookup.has(focusedColumnKey))\n            return;\n        if (!rowLookup.has(focusedRowKey))\n            return;\n\n        const column = columnLookup.get(focusedColumnKey);\n        const row = rowLookup.get(focusedRowKey);\n        const cell = formatResolver.resolve(row, column);\n        const text = cell.text; // TODO: Make it configurable\n\n        setText(text);\n        input?.select();\n    });\n\n    context.addEventListener(element, 'focus', () => {\n        if (input.parentElement)\n            input.focus();\n    });\n\n    context.addEventListener(element, 'keydown', (event) => {\n        // TODO: make sure it's not invoked on keydown of the input\n        updateState(context);\n\n        const focusedCell = context.state.focusedCell;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const selectedCells = context.state.options.selectedCells;\n        const setSelectedCells = context.state.options.onSelectedCellsChange;\n        const addSelectedCells = (cells) => setSelectedCells(getCombinedCells(selectedCells, cells));\n        const setFocusedCell = context.state.options.onFocusedCellChange;\n        const editedCells = context.state.options.editedCells;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const columns = context.state.columns;\n        const rows = context.state.rows;\n        const text = context.state.text;\n        const inputFormatResolver = context.state.inputFormatResolver;\n\n        const arrowTo = (cell, event) => {\n            setFocusedCell(cell);\n\n            if (event.shiftKey)\n                addSelectedCells([cell]);\n            else\n                setSelectedCells([cell]);\n        };\n\n        const arrowHorizontally = (offset, event) => {\n            if (!focusedCell)\n                return;\n\n            const focusedColumnKey = stringifyId(focusedCell.columnId);\n            if (!columnLookup.has(focusedColumnKey))\n                return;\n\n            const focusedColumnIndex = columnLookup.get(focusedColumnKey).index;\n            const newColumnIndex = Math.max(0, Math.min(columns.length - 1, focusedColumnIndex + offset));\n            if (newColumnIndex === focusedColumnIndex)\n                return;\n\n            const newFocusedCell = { rowId: focusedCell.rowId, columnId: columns[newColumnIndex].id };\n\n            arrowTo(newFocusedCell, event);\n        }\n\n        const arrowVertically = (offset, event) => {\n            if (!focusedCell)\n                return;\n\n            const focusedRowKey = stringifyId(focusedCell.rowId);\n            if (!rowLookup.has(focusedRowKey))\n                return;\n\n            const focusedRowIndex = rowLookup.get(focusedRowKey).index;\n            const newRowIndex = Math.max(0, Math.min(rows.length - 1, focusedRowIndex + offset));\n            if (newRowIndex === focusedRowIndex)\n                return;\n\n            const newFocusedCell = { rowId: rows[newRowIndex].id, columnId: focusedCell.columnId };\n\n            arrowTo(newFocusedCell, event);\n        }\n\n        const preventDefault = () => {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n\n        const cancel = () => {\n            if (text !== '') {\n                setText('');\n            }\n            else if (selectedCells.length > 1) {\n                setSelectedCells([focusedCell]);\n            }\n            else if (editedCells.length > 0) {\n                setEditedCells([]);\n            }\n            else {\n                setFocusedCell(null);\n                setSelectedCells([]);\n            }\n        };\n\n        const copyToClipboard = (event) => {\n            if (!event.ctrlKey)\n                return;\n\n            const clipboardData = getClipboardData(selectedCells, columns, rows, inputFormatResolver);\n            navigator.clipboard.writeText(clipboardData);\n        }\n\n        switch (event.key) {\n            case 'Escape':\n                cancel();\n                break;\n            case 'Enter':\n                accept();\n                break;\n            case 'ArrowUp':\n                // TODO: When ctrl and shift are pressed together, select all cells between the focused cell and the new cell\n                // TODO: When shift is pressed, expand the current rect selection instead of moving the focused cell\n                preventDefault();\n                arrowVertically(event.ctrlKey ? -rows.length : -1, event);\n                break;\n            case 'ArrowDown':\n                preventDefault();\n                arrowVertically(event.ctrlKey ? rows.length : 1, event);\n                break;\n            case 'ArrowLeft':\n                preventDefault();\n                arrowHorizontally(event.ctrlKey ? -columns.length : -1, event);\n                break;\n            case 'ArrowRight':\n                preventDefault();\n                arrowHorizontally(event.ctrlKey ? columns.length : 1, event);\n                break;\n            case 'Delete':\n            case 'Backspace':\n                clear();\n                break;\n            case 'c':\n                copyToClipboard(event);\n                break;\n            default:\n                break;\n        }\n    });\n\n    new ResizeObserver(() => {\n        context.requestNewRender();\n    }).observe(element);\n\n    context.addEventListener(input, 'input', (event) => {\n        // TODO: check performance of this (if it's ok to update the state on every input event)\n        updateState(context);\n\n        if (event.target.value) {\n            accept(true);\n\n            input.style.opacity = 1;\n            input.style.pointerEvents = 'auto';\n        }\n        else {\n            if (event.isTrusted)\n                clear(true);\n\n            input.style.opacity = 0;\n            input.style.pointerEvents = 'none';\n        }\n    });\n\n    context.addEventListener(input, 'click', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'dblclick', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'mousedown', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'keydown', (event) => {\n        switch (event.key) {\n            case 'Enter':\n            case 'Escape':\n                break;\n            case 'Delete':\n            case 'Backspace':\n            case 'ArrowUp':\n            case 'ArrowDown':\n            case 'ArrowLeft':\n            case 'ArrowRight':\n                if (input.value !== '') {\n                    event.stopPropagation();\n                    context.requestNewRender();\n                }\n                break;\n            default:\n                event.stopPropagation();\n                // TODO: maybe only check if the new text is valid\n                context.requestNewRender();\n                break;\n        }\n    });\n}\n\nexport default function createGrid(element, options) {\n    console.log('createGrid');\n\n    initialize(element);\n\n    const context = element['spread-grid-context'];\n    context.externalOptions = options;\n\n    if (context.state === null) {\n        updateState(context);\n        // TODO: only render if the state has sufficiently changed\n        render(context);\n    }\n    else {\n        context.requestNewRender();\n    }\n}",
+        "import getEditableCells from \"./state-utils/getEditableCells.js\";\nimport stringifyId from \"./core-utils/stringifyId.js\";\nimport render from \"./core/render.js\";\nimport updateState from \"./core/state.js\";\nimport getCombinedCells from \"./state-utils/getCombinedCells.js\";\nimport getReducedCells from \"./state-utils/getReducedCells.js\";\nimport getMousePosition from \"./state-utils/getMousePosition.js\";\nimport getNewSortBy from \"./state-utils/getNewSortBy.js\";\nimport getClipboardData from \"./state-utils/getClipboardData.js\";\n\nfunction initialize(element) {\n    if ('spread-grid-context' in element) return;\n\n    console.log('initialize');\n\n    const canvases = {\n        'top-left': document.createElement('canvas'),\n        'top-center': document.createElement('canvas'),\n        'top-right': document.createElement('canvas'),\n        'middle-left': document.createElement('canvas'),\n        'middle-center': document.createElement('canvas'),\n        'middle-right': document.createElement('canvas'),\n        'bottom-left': document.createElement('canvas'),\n        'bottom-center': document.createElement('canvas'),\n        'bottom-right': document.createElement('canvas')\n    };\n    const input = document.createElement('input');\n\n    element.setAttribute('tabindex', '0');\n    element.setAttribute('style', 'max-width: 100vw; max-height: 100vh; overflow: auto; display: grid; position: relative; grid-template-columns: fit-content(0) fit-content(0) fit-content(0); grid-template-rows: fit-content(0) fit-content(0) fit-content(0); outline: none; user-select: none;');\n    element.classList.add('spread-grid');\n    canvases['top-left'].setAttribute('style', 'position: sticky; left: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 1;');\n    canvases['top-center'].setAttribute('style', 'position: sticky; top: 0; z-index: 1; grid-row: 1; grid-column: 2;');\n    canvases['top-right'].setAttribute('style', 'position: sticky; right: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 3;');\n    canvases['middle-left'].setAttribute('style', 'position: sticky; left: 0; z-index: 1; grid-row: 2; grid-column: 1;');\n    canvases['middle-center'].setAttribute('style', 'grid-row: 2; grid-column: 2; z-index: 0;');\n    canvases['middle-right'].setAttribute('style', 'position: sticky; right: 0; z-index: 1; grid-row: 2; grid-column: 3;');\n    canvases['bottom-left'].setAttribute('style', 'position: sticky; left: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 1;');\n    canvases['bottom-center'].setAttribute('style', 'position: sticky; bottom: 0; z-index: 1; grid-row: 3; grid-column: 2;');\n    canvases['bottom-right'].setAttribute('style', 'position: sticky; right: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 3;');\n    input.setAttribute('style', 'position: sticky; z-index: 3; outline: none; border: none; box-shadow: none; padding: 0 5px; font-size: 12px; font-family: Calibri; background-color: white; box-sizing: border-box; opacity: 0; pointer-events: none;');\n\n    const context = {\n        externalOptions: {},\n        state: null,\n        memory: {},\n        element: element,\n        canvases: canvases,\n        input: input,\n        renderRequested: false,\n        mousePosition: null,\n        isMouseDown: false,\n        columnWidthCache: new Map(),\n        rowHeightCache: new Map(),\n    };\n\n    context.requestNewRender = () => {\n        if (context.renderRequested) return;\n        context.renderRequested = true;\n        requestAnimationFrame(() => {\n            context.renderRequested = false;\n            updateState(context);\n            render(context);\n        });\n    };\n\n    context.addEventListener = (element, type, listener) => {\n        element.addEventListener(type, (event) => {\n            try {\n                listener(event);\n            }\n            catch (error) {\n                error.message = `[${type} event]: ${error.message}`;\n                context.error = error;\n                context.requestNewRender();\n            }\n        });\n    }\n\n    context.localOptions = {\n        data: [],\n        columns: [{ type: 'DATA-BLOCK' }],\n        rows: [{ type: 'HEADER' }, { type: 'DATA-BLOCK' }],\n        formatting: [],\n        filtering: [],\n        sorting: [],\n        dataSelector: ({ data, row, column }) => data[row.id][column.id],\n        pinnedTop: 0,\n        pinnedBottom: 0,\n        pinnedLeft: 0,\n        pinnedRight: 0,\n        borderWidth: 1,\n        focusedCell: null,\n        onFocusedCellChange: (focusedCell) => {\n            context.localOptions.focusedCell = focusedCell;\n            context.requestNewRender();\n        },\n        selectedCells: [],\n        onSelectedCellsChange: (selectedCells) => {\n            context.localOptions.selectedCells = selectedCells;\n            context.requestNewRender();\n        },\n        highlightedCells: [],\n        editedCells: [],\n        onEditedCellsChange: (editedCells) => {\n            // TODO: optimize by coalescing\n            context.localOptions.editedCells = editedCells;\n            context.requestNewRender();\n        },\n        filters: [],\n        onFiltersChange: (filters) => {\n            context.localOptions.filters = filters;\n            context.requestNewRender();\n        },\n        sortBy: [],\n        onSortByChange: (sortBy) => {\n            context.localOptions.sortBy = sortBy;\n            context.requestNewRender();\n        },\n        onCellClick: () => { },\n        onCustomCellClick: () => { },\n        columnWidths: [],\n        onColumnWidthsChange: (columnWidths) => {\n            context.localOptions.columnWidths = columnWidths;\n            context.requestNewRender();\n        },\n        rowHeights: [],\n        onRowHeightsChange: (rowHeights) => {\n            context.localOptions.rowHeights = rowHeights;\n            context.requestNewRender();\n        }\n    };\n\n    element['spread-grid-context'] = context;\n\n    const setText = (text) => {\n        input.value = text;\n        input.dispatchEvent(new Event('input'));\n    }\n\n    const accept = (autoCommit) => {\n        const selectedCells = context.state.options.selectedCells;\n        const formatResolver = context.state.inputFormatResolver;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const text = context.state.text;\n        const isTextValid = context.state.isTextValid;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const setFilters = context.state.options.onFiltersChange;\n        const addEditedCells = (cells) => setEditedCells(getCombinedCells(context.state.options.editedCells, cells));\n        const addFilters = (cells) => setFilters(getCombinedCells(context.state.options.filters, cells));\n        const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n\n        if (text === '')\n            return;\n        if (!isTextValid)\n            return;\n        if (autoCommit && !editableCells.every(cell => cell.edit.autoCommit))\n            return;\n\n        const dataCells = editableCells.filter(cell => cell.type === 'DATA');\n        const filterCells = editableCells.filter(cell => cell.type === 'FILTER');\n\n        addEditedCells(dataCells.map(cell => ({ ...cell.cell, value: cell.edit.parse({ string: text }) })));\n        addFilters(filterCells.map(cell => ({ ...cell.cell, expression: cell.edit.parse({ string: text }) })));\n\n        if (!autoCommit)\n            setText('');\n    };\n\n    const clear = (autoCommit) => {\n        const selectedCells = context.state.options.selectedCells;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const setFilters = context.state.options.onFiltersChange;\n        const removeEditedCells = (cells) => setEditedCells(getReducedCells(context.state.options.editedCells, cells));\n        const removeFilters = (cells) => setFilters(getReducedCells(context.state.options.filters, cells));\n        const formatResolver = context.state.inputFormatResolver;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n\n        if (autoCommit && !editableCells.every(cell => cell.edit.autoCommit))\n            return;\n\n        removeEditedCells(selectedCells);\n        removeFilters(selectedCells);\n    }\n\n    // TODO: Move other input functions here as well\n\n    context.addEventListener(element, 'scroll', (event) => {\n        // TODO: only request new render if scroll position changed outside of the scope\n        // TODO: how to: calculate the new scrollRect here and compare it to the one in the state\n        // TODO: Also don't forget to check if the highlighted cell did change\n        // TODO: Consider forcing a new render when visible scrollRect changes (without waiting for the next render frame)\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseenter', (event) => {\n        context.mousePosition = getMousePosition(event);\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mousemove', (event) => {\n        context.mousePosition = getMousePosition(event);\n\n        if (context.resizingColumn) {\n            const column = context.state.columnLookup.get(stringifyId(context.resizingColumn));\n            const columnWidth = column.width;\n            const columnRight = column.right;\n            const mousePosition = context.mousePosition.x;\n            const newColumnWidth = Math.max(10, mousePosition - columnRight + columnWidth);\n            const previousColumnWidths = context.state.options.columnWidths;\n            const newColumnWidths = previousColumnWidths\n                .filter(columnWidth => stringifyId(columnWidth.columnId) !== column.key)\n                .concat([{ columnId: column.id, width: newColumnWidth }]);\n            context.state.options.onColumnWidthsChange(newColumnWidths);\n        }\n        if (context.resizingRow) {\n            const row = context.state.rowLookup.get(stringifyId(context.resizingRow));\n            const rowHeight = row.height;\n            const rowBottom = row.bottom;\n            const mousePosition = context.mousePosition.y;\n            const newRowHeight = Math.max(10, mousePosition - rowBottom + rowHeight);\n            const previousRowHeights = context.state.options.rowHeights;\n            const newRowHeights = previousRowHeights\n                .filter(rowHeight => stringifyId(rowHeight.rowId) !== row.key)\n                .concat([{ rowId: row.id, height: newRowHeight }]);\n            context.state.options.onRowHeightsChange(newRowHeights);\n        }\n\n        // TODO: only request new render if hovered cell changed\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseleave', () => {\n        context.mousePosition = null;\n        context.requestNewRender();\n    });\n\n    // TODO: update mouse position on resize\n\n    context.addEventListener(element, 'mousedown', (event) => {\n        updateState(context);\n        setText('');\n\n        context.isMouseDown = true;\n        context.mouseDownPosition = context.mousePosition;\n        context.mouseDownCell = context.state.hoveredCell;\n\n        if (context.state.resizableColumn) {\n            context.resizingColumn = context.state.resizableColumn;\n        }\n        if (context.state.resizableRow) {\n            context.resizingRow = context.state.resizableRow;\n        }\n        if (!context.state.resizableColumn && !context.state.resizableRow) {\n            context.state.options.onFocusedCellChange(context.state.hoveredCell);\n        }\n\n        if (!event.ctrlKey)\n            context.state.options.onSelectedCellsChange([]);\n\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseup', (event) => {\n        updateState(context);\n\n        context.isMouseDown = false;\n        context.resizingColumn = null;\n        context.resizingRow = null;\n\n        context.state.options.onSelectedCellsChange(getCombinedCells(context.state.options.selectedCells, context.state.highlightedCells));\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'pointerdown', (event) => {\n        context.element.setPointerCapture(event.pointerId);\n    });\n\n    context.addEventListener(element, 'pointerup', (event) => {\n        context.element.releasePointerCapture(event.pointerId);\n    });\n\n    context.addEventListener(element, 'click', (event) => {\n        updateState(context);\n\n        const cell = context.state.hoveredCell;\n        const mouseDownCell = context.mouseDownCell;\n\n        if (context.state.resizableColumn || context.state.resizableRow)\n            return;\n        if (cell === null)\n            return;\n        if (stringifyId(cell.columnId) !== stringifyId(mouseDownCell.columnId))\n            return;\n        if (stringifyId(cell.rowId) !== stringifyId(mouseDownCell.rowId))\n            return;\n\n        const column = context.state.columnLookup.get(stringifyId(cell.columnId));\n        const row = context.state.rowLookup.get(stringifyId(cell.rowId));\n        const sortBy = context.state.options.sortBy;\n\n        if (column.type === 'DATA' && row.type === 'DATA') {\n            context.state.options.onCellClick(context.state.hoveredCell);\n        } else if (column.type === 'CUSTOM' || row.type === 'CUSTOM') {\n            context.state.options.onCustomCellClick(context.state.hoveredCell);\n        } else if (column.type === 'HEADER' || row.type === 'HEADER') {\n            const newSortBy = getNewSortBy(sortBy, column, row, event.ctrlKey);\n            context.state.options.onSortByChange(newSortBy);\n            context.state.options.onSelectedCellsChange([]);\n        }\n    });\n\n    context.addEventListener(element, 'dblclick', (event) => {\n        updateState(context);\n\n        if (context.state.resizableColumn) {\n            const resizableColumnKey = stringifyId(context.state.resizableColumn);\n            const newColumnWidths = context.state.options.columnWidths.filter(columnWidth => stringifyId(columnWidth.columnId) !== resizableColumnKey);\n            context.state.options.onColumnWidthsChange(newColumnWidths);\n            context.columnWidthCache.delete(resizableColumnKey);\n        }\n        if (context.state.resizableRow) {\n            const resizableRowKey = stringifyId(context.state.resizableRow);\n            const newRowHeights = context.state.options.rowHeights.filter(rowHeight => stringifyId(rowHeight.rowId) !== resizableRowKey);\n            context.state.options.onRowHeightsChange(newRowHeights);\n            context.rowHeightCache.delete(resizableRowKey);\n        }\n\n        const focusedCell = context.state.focusedCell;\n        if (focusedCell === null)\n            return;\n\n        const focusedColumnKey = stringifyId(focusedCell.columnId);\n        const focusedRowKey = stringifyId(focusedCell.rowId);\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const formatResolver = context.state.inputFormatResolver;\n\n        if (!columnLookup.has(focusedColumnKey))\n            return;\n        if (!rowLookup.has(focusedRowKey))\n            return;\n\n        const column = columnLookup.get(focusedColumnKey);\n        const row = rowLookup.get(focusedRowKey);\n        const cell = formatResolver.resolve(row, column);\n        const text = cell.text; // TODO: Make it configurable\n\n        setText(text);\n        input?.select();\n    });\n\n    context.addEventListener(element, 'focus', () => {\n        if (input.parentElement)\n            input.focus({ preventScroll: true });\n    });\n\n    context.addEventListener(element, 'keydown', (event) => {\n        // TODO: make sure it's not invoked on keydown of the input\n        updateState(context);\n\n        const focusedCell = context.state.focusedCell;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const selectedCells = context.state.options.selectedCells;\n        const setSelectedCells = context.state.options.onSelectedCellsChange;\n        const addSelectedCells = (cells) => setSelectedCells(getCombinedCells(selectedCells, cells));\n        const setFocusedCell = context.state.options.onFocusedCellChange;\n        const editedCells = context.state.options.editedCells;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const columns = context.state.columns;\n        const rows = context.state.rows;\n        const text = context.state.text;\n        const inputFormatResolver = context.state.inputFormatResolver;\n\n        const arrowTo = (cell, event) => {\n            setFocusedCell(cell);\n\n            if (event.shiftKey)\n                addSelectedCells([cell]);\n            else\n                setSelectedCells([cell]);\n        };\n\n        const arrowHorizontally = (offset, event) => {\n            if (!focusedCell)\n                return;\n\n            const focusedColumnKey = stringifyId(focusedCell.columnId);\n            if (!columnLookup.has(focusedColumnKey))\n                return;\n\n            const focusedColumnIndex = columnLookup.get(focusedColumnKey).index;\n            const newColumnIndex = Math.max(0, Math.min(columns.length - 1, focusedColumnIndex + offset));\n            if (newColumnIndex === focusedColumnIndex)\n                return;\n\n            const newFocusedCell = { rowId: focusedCell.rowId, columnId: columns[newColumnIndex].id };\n\n            arrowTo(newFocusedCell, event);\n        }\n\n        const arrowVertically = (offset, event) => {\n            if (!focusedCell)\n                return;\n\n            const focusedRowKey = stringifyId(focusedCell.rowId);\n            if (!rowLookup.has(focusedRowKey))\n                return;\n\n            const focusedRowIndex = rowLookup.get(focusedRowKey).index;\n            const newRowIndex = Math.max(0, Math.min(rows.length - 1, focusedRowIndex + offset));\n            if (newRowIndex === focusedRowIndex)\n                return;\n\n            const newFocusedCell = { rowId: rows[newRowIndex].id, columnId: focusedCell.columnId };\n\n            arrowTo(newFocusedCell, event);\n        }\n\n        const preventDefault = () => {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n\n        const cancel = () => {\n            if (text !== '') {\n                setText('');\n            }\n            else if (selectedCells.length > 1) {\n                setSelectedCells([focusedCell]);\n            }\n            else if (editedCells.length > 0) {\n                setEditedCells([]);\n            }\n            else {\n                setFocusedCell(null);\n                setSelectedCells([]);\n            }\n        };\n\n        const copyToClipboard = (event) => {\n            if (!event.ctrlKey)\n                return;\n\n            const clipboardData = getClipboardData(selectedCells, columns, rows, inputFormatResolver);\n\n            if (navigator.clipboard) {\n                navigator.clipboard.writeText(clipboardData);\n            } else {\n                const textArea = document.createElement('textarea');\n                textArea.value = clipboardData;\n                document.body.appendChild(textArea);\n                textArea.select();\n                document.execCommand('copy');\n                document.body.removeChild(textArea);\n            }\n        }\n\n        switch (event.key) {\n            case 'Escape':\n                cancel();\n                break;\n            case 'Enter':\n                accept();\n                break;\n            case 'ArrowUp':\n                // TODO: When ctrl and shift are pressed together, select all cells between the focused cell and the new cell\n                // TODO: When shift is pressed, expand the current rect selection instead of moving the focused cell\n                preventDefault();\n                arrowVertically(event.ctrlKey ? -rows.length : -1, event);\n                break;\n            case 'ArrowDown':\n                preventDefault();\n                arrowVertically(event.ctrlKey ? rows.length : 1, event);\n                break;\n            case 'ArrowLeft':\n                preventDefault();\n                arrowHorizontally(event.ctrlKey ? -columns.length : -1, event);\n                break;\n            case 'ArrowRight':\n                preventDefault();\n                arrowHorizontally(event.ctrlKey ? columns.length : 1, event);\n                break;\n            case 'Delete':\n            case 'Backspace':\n                clear();\n                break;\n            case 'c':\n                copyToClipboard(event);\n                break;\n            default:\n                break;\n        }\n    });\n\n    new ResizeObserver(() => {\n        context.requestNewRender();\n    }).observe(element);\n\n    context.addEventListener(input, 'input', (event) => {\n        // TODO: check performance of this (if it's ok to update the state on every input event)\n        updateState(context);\n\n        if (event.target.value) {\n            accept(true);\n\n            input.style.opacity = 1;\n            input.style.pointerEvents = 'auto';\n        }\n        else {\n            if (event.isTrusted)\n                clear(true);\n\n            input.style.opacity = 0;\n            input.style.pointerEvents = 'none';\n        }\n    });\n\n    context.addEventListener(input, 'click', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'dblclick', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'mousedown', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'keydown', (event) => {\n        switch (event.key) {\n            case 'Enter':\n            case 'Escape':\n                break;\n            case 'Delete':\n            case 'Backspace':\n            case 'ArrowUp':\n            case 'ArrowDown':\n            case 'ArrowLeft':\n            case 'ArrowRight':\n                if (input.value !== '') {\n                    event.stopPropagation();\n                    context.requestNewRender();\n                }\n                break;\n            default:\n                event.stopPropagation();\n                // TODO: maybe only check if the new text is valid\n                context.requestNewRender();\n                break;\n        }\n    });\n}\n\nexport default function createGrid(element, options) {\n    console.log('createGrid');\n\n    initialize(element);\n\n    const context = element['spread-grid-context'];\n    context.externalOptions = options;\n\n    if (context.state === null) {\n        updateState(context);\n        // TODO: only render if the state has sufficiently changed\n        render(context);\n    }\n    else {\n        context.requestNewRender();\n    }\n}",
         "import stringifyId from '../core-utils/stringifyId.js';\n\nexport default function getNewSortBy(sortBy, column, row, ctrlKey) {\n    // TODO: better support for multi-row sorting\n\n    function isCurrentRule(rule) {\n        return column.key === stringifyId(rule.columnId || 'HEADER') && row.key === stringifyId(rule.rowId || 'HEADER');\n    }\n\n    const directionLoop = ['ASC', 'DESC', undefined];\n    const currentRule = sortBy.find(isCurrentRule);\n    const directionIndex = directionLoop.indexOf(currentRule?.direction);\n    const newDirection = directionLoop[(directionIndex + 1) % directionLoop.length];\n    const isLastRule = sortBy.indexOf(currentRule) === sortBy.length - 1;\n    const shouldKeepOld = ctrlKey && (isLastRule || !currentRule);\n    const rulesToKeep = shouldKeepOld ? sortBy.filter(rule => !isCurrentRule(rule)) : [];\n    const newRules = newDirection ? [{ columnId: column.id, rowId: row.id, direction: newDirection }] : [];\n\n    return [...rulesToKeep, ...newRules];\n}",
         "import stringifyId from \"../core-utils/stringifyId.js\";\nimport Selection from \"../types/Selection.js\";\n\nexport default function getClipboardData(selectedCells, columns, rows, formatResolver) {\n    const columnLookup = new Map(columns.map(column => [column.key, column]));\n    const rowLookup = new Map(rows.map(row => [row.key, row]));\n    const selectedCellKeys = selectedCells.map(cell => ({\n        columnKey: stringifyId(cell.columnId),\n        rowKey: stringifyId(cell.rowId)\n    })).filter(cell => columnLookup.has(cell.columnKey) && rowLookup.has(cell.rowKey));\n    const selectedColumns = new Set(selectedCellKeys.map(cell => cell.columnKey));\n    const selectedRows = new Set(selectedCellKeys.map(cell => cell.rowKey));\n\n    if (selectedCellKeys.length === 0)\n        return '';\n\n    const selection = new Selection(selectedCells);\n    const minColumnIndex = Math.min(...selectedCellKeys.map(cell => columnLookup.get(cell.columnKey).index));\n    const maxColumnIndex = Math.max(...selectedCellKeys.map(cell => columnLookup.get(cell.columnKey).index));\n    const minRowIndex = Math.min(...selectedCellKeys.map(cell => rowLookup.get(cell.rowKey).index));\n    const maxRowIndex = Math.max(...selectedCellKeys.map(cell => rowLookup.get(cell.rowKey).index));\n\n    const stringBuilder = [];\n\n    for (let rowIndex = minRowIndex; rowIndex <= maxRowIndex; rowIndex++) {\n        const row = rows[rowIndex];\n        const rowKey = row.key;\n\n        if (!selectedRows.has(rowKey))\n            continue;\n\n        for (let columnIndex = minColumnIndex; columnIndex <= maxColumnIndex; columnIndex++) {\n            const column = columns[columnIndex];\n            const columnKey = column.key;\n\n            if (!selectedColumns.has(columnKey))\n                continue;\n\n            if (selection.isKeySelected(rowKey, columnKey)) {\n                const cellData = formatResolver.resolve(row, column).text;\n                stringBuilder.push(cellData);\n            }\n\n            if (columnIndex < maxColumnIndex)\n                stringBuilder.push('\\t');\n        }\n\n        if (rowIndex < maxRowIndex)\n            stringBuilder.push('\\n');\n    }\n\n    return stringBuilder.join('');\n}",
         "// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n",
         "// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};",
         "// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};",
         "__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))",
         "// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};",
-        "var getCurrentScript = function() {\n    var script = document.currentScript;\n    if (!script) {\n        /* Shim for IE11 and below */\n        /* Do not take into account async scripts and inline scripts */\n\n        var doc_scripts = document.getElementsByTagName('script');\n        var scripts = [];\n\n        for (var i = 0; i < doc_scripts.length; i++) {\n            scripts.push(doc_scripts[i]);\n        }\n\n        scripts = scripts.filter(function(s) { return !s.async && !s.text && !s.textContent; });\n        script = scripts.slice(-1)[0];\n    }\n\n    return script;\n};\n\nvar isLocalScript = function(script) {\n    return /\\/_dash-component-suites\\//.test(script.src);\n};\n\nObject.defineProperty(__webpack_require__, 'p', {\n    get: (function () {\n        var script = getCurrentScript();\n\n        var url = script.src.split('/').slice(0, -1).join('/') + '/';\n\n        return function() {\n            return url;\n        };\n    })()\n});\n\nif (typeof jsonpScriptSrc !== 'undefined') {\n    var __jsonpScriptSrc__ = jsonpScriptSrc;\n    jsonpScriptSrc = function(chunkId) {\n        var script = getCurrentScript();\n        var isLocal = isLocalScript(script);\n\n        var src = __jsonpScriptSrc__(chunkId);\n\n        if(!isLocal) {\n            return src;\n        }\n\n        var srcFragments = src.split('/');\n        var fileFragments = srcFragments.slice(-1)[0].split('.');\n\n        fileFragments.splice(1, 0, \"v0_0_4m1712460087\");\n        srcFragments.splice(-1, 1, fileFragments.join('.'))\n\n        return srcFragments.join('/');\n    };\n}\n"
+        "var getCurrentScript = function() {\n    var script = document.currentScript;\n    if (!script) {\n        /* Shim for IE11 and below */\n        /* Do not take into account async scripts and inline scripts */\n\n        var doc_scripts = document.getElementsByTagName('script');\n        var scripts = [];\n\n        for (var i = 0; i < doc_scripts.length; i++) {\n            scripts.push(doc_scripts[i]);\n        }\n\n        scripts = scripts.filter(function(s) { return !s.async && !s.text && !s.textContent; });\n        script = scripts.slice(-1)[0];\n    }\n\n    return script;\n};\n\nvar isLocalScript = function(script) {\n    return /\\/_dash-component-suites\\//.test(script.src);\n};\n\nObject.defineProperty(__webpack_require__, 'p', {\n    get: (function () {\n        var script = getCurrentScript();\n\n        var url = script.src.split('/').slice(0, -1).join('/') + '/';\n\n        return function() {\n            return url;\n        };\n    })()\n});\n\nif (typeof jsonpScriptSrc !== 'undefined') {\n    var __jsonpScriptSrc__ = jsonpScriptSrc;\n    jsonpScriptSrc = function(chunkId) {\n        var script = getCurrentScript();\n        var isLocal = isLocalScript(script);\n\n        var src = __jsonpScriptSrc__(chunkId);\n\n        if(!isLocal) {\n            return src;\n        }\n\n        var srcFragments = src.split('/');\n        var fileFragments = srcFragments.slice(-1)[0].split('.');\n\n        fileFragments.splice(1, 0, \"v0_0_5m1712488437\");\n        srcFragments.splice(-1, 1, fileFragments.join('.'))\n\n        return srcFragments.join('/');\n    };\n}\n"
     ],
     "version": 3
 }
```

### Comparing `dash_spread_grid-0.0.4/dash_spread_grid/metadata.json` & `dash_spread_grid-0.0.5/dash_spread_grid/metadata.json`

 * *Files identical despite different names*

### Comparing `dash_spread_grid-0.0.4/dash_spread_grid/package-info.json` & `dash_spread_grid-0.0.5/dash_spread_grid/package-info.json`

 * *Files 0% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9642857142857143%*

 * *Differences: {"'version'": "'0.0.5'"}*

```diff
@@ -53,15 +53,15 @@
         "build:backends-activated": "(. venv/bin/activate || venv\\scripts\\activate && npm run build:backends)",
         "build:js": "webpack --mode production",
         "prepublishOnly": "npm run validate-init",
         "start": "webpack serve --config ./webpack.serve.config.js --open",
         "validate-init": "python _validate_init.py",
         "watch": "npm-watch"
     },
-    "version": "0.0.4",
+    "version": "0.0.5",
     "watch": {
         "build": {
             "patterns": [
                 "../lib/**/*",
                 "./src/lib/**/*"
             ]
         }
```

### Comparing `dash_spread_grid-0.0.4/package.json` & `dash_spread_grid-0.0.5/package.json`

 * *Files 0% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9642857142857143%*

 * *Differences: {"'version'": "'0.0.5'"}*

```diff
@@ -53,15 +53,15 @@
         "build:backends-activated": "(. venv/bin/activate || venv\\scripts\\activate && npm run build:backends)",
         "build:js": "webpack --mode production",
         "prepublishOnly": "npm run validate-init",
         "start": "webpack serve --config ./webpack.serve.config.js --open",
         "validate-init": "python _validate_init.py",
         "watch": "npm-watch"
     },
-    "version": "0.0.4",
+    "version": "0.0.5",
     "watch": {
         "build": {
             "patterns": [
                 "../lib/**/*",
                 "./src/lib/**/*"
             ]
         }
```

