# Comparing `tmp/dash_spread_grid-0.0.1.tar.gz` & `tmp/dash_spread_grid-0.0.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dash_spread_grid-0.0.1.tar", last modified: Thu Jan 18 14:56:58 2024, max compression
+gzip compressed data, was "dash_spread_grid-0.0.2.tar", last modified: Sat Apr  6 07:46:48 2024, max compression
```

## Comparing `dash_spread_grid-0.0.1.tar` & `dash_spread_grid-0.0.2.tar`

### file list

```diff
@@ -1,21 +1,21 @@
-drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-01-18 14:56:58.534176 dash_spread_grid-0.0.1/
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.1/LICENSE
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      393 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.1/MANIFEST.in
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      270 2024-01-18 14:56:58.534176 dash_spread_grid-0.0.1/PKG-INFO
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     3703 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.1/README.md
-drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-01-18 14:56:58.534176 dash_spread_grid-0.0.1/dash_spread_grid/
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     1577 2024-01-18 14:08:01.000000 dash_spread_grid-0.0.1/dash_spread_grid/DashSpreadGrid.py
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2261 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.1/dash_spread_grid/__init__.py
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       78 2024-01-18 14:08:01.000000 dash_spread_grid-0.0.1/dash_spread_grid/_imports_.py
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)    69840 2024-01-18 14:08:00.000000 dash_spread_grid-0.0.1/dash_spread_grid/dash_spread_grid.min.js
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)   169101 2024-01-18 14:08:00.000000 dash_spread_grid-0.0.1/dash_spread_grid/dash_spread_grid.min.js.map
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2102 2024-01-18 14:08:01.000000 dash_spread_grid-0.0.1/dash_spread_grid/metadata.json
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2215 2024-01-18 14:08:01.000000 dash_spread_grid-0.0.1/dash_spread_grid/package-info.json
-drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-01-18 14:56:58.534176 dash_spread_grid-0.0.1/dash_spread_grid.egg-info/
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      270 2024-01-18 14:56:58.000000 dash_spread_grid-0.0.1/dash_spread_grid.egg-info/PKG-INFO
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      457 2024-01-18 14:56:58.000000 dash_spread_grid-0.0.1/dash_spread_grid.egg-info/SOURCES.txt
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)        1 2024-01-18 14:56:58.000000 dash_spread_grid-0.0.1/dash_spread_grid.egg-info/dependency_links.txt
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       17 2024-01-18 14:56:58.000000 dash_spread_grid-0.0.1/dash_spread_grid.egg-info/top_level.txt
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2215 2024-01-18 13:55:03.000000 dash_spread_grid-0.0.1/package.json
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       38 2024-01-18 14:56:58.534176 dash_spread_grid-0.0.1/setup.cfg
--rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      510 2024-01-18 13:19:42.000000 dash_spread_grid-0.0.1/setup.py
+drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-06 07:46:48.919769 dash_spread_grid-0.0.2/
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.2/LICENSE
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      393 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.2/MANIFEST.in
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      259 2024-04-06 07:46:48.919769 dash_spread_grid-0.0.2/PKG-INFO
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     3703 2024-01-20 12:13:37.000000 dash_spread_grid-0.0.2/README.md
+drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-06 07:46:48.909769 dash_spread_grid-0.0.2/dash_spread_grid/
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     3054 2024-04-06 07:45:58.000000 dash_spread_grid-0.0.2/dash_spread_grid/DashSpreadGrid.py
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2261 2024-01-18 13:13:06.000000 dash_spread_grid-0.0.2/dash_spread_grid/__init__.py
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       78 2024-04-06 07:45:58.000000 dash_spread_grid-0.0.2/dash_spread_grid/_imports_.py
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)    48905 2024-04-06 07:45:57.000000 dash_spread_grid-0.0.2/dash_spread_grid/dash_spread_grid.min.js
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)   189437 2024-04-06 07:45:57.000000 dash_spread_grid-0.0.2/dash_spread_grid/dash_spread_grid.min.js.map
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     5575 2024-04-06 07:45:58.000000 dash_spread_grid-0.0.2/dash_spread_grid/metadata.json
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2332 2024-04-06 07:45:57.000000 dash_spread_grid-0.0.2/dash_spread_grid/package-info.json
+drwxr-xr-x   0 tomaszrewak  (1000) tomaszrewak  (1000)        0 2024-04-06 07:46:48.919769 dash_spread_grid-0.0.2/dash_spread_grid.egg-info/
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      259 2024-04-06 07:46:48.000000 dash_spread_grid-0.0.2/dash_spread_grid.egg-info/PKG-INFO
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      457 2024-04-06 07:46:48.000000 dash_spread_grid-0.0.2/dash_spread_grid.egg-info/SOURCES.txt
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)        1 2024-04-06 07:46:48.000000 dash_spread_grid-0.0.2/dash_spread_grid.egg-info/dependency_links.txt
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       17 2024-04-06 07:46:48.000000 dash_spread_grid-0.0.2/dash_spread_grid.egg-info/top_level.txt
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)     2332 2024-04-06 07:43:44.000000 dash_spread_grid-0.0.2/package.json
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)       38 2024-04-06 07:46:48.919769 dash_spread_grid-0.0.2/setup.cfg
+-rw-r--r--   0 tomaszrewak  (1000) tomaszrewak  (1000)      510 2024-01-18 13:19:42.000000 dash_spread_grid-0.0.2/setup.py
```

### Comparing `dash_spread_grid-0.0.1/README.md` & `dash_spread_grid-0.0.2/README.md`

 * *Files identical despite different names*

### Comparing `dash_spread_grid-0.0.1/dash_spread_grid/DashSpreadGrid.py` & `dash_spread_grid-0.0.2/dash_spread_grid/DashSpreadGrid.py`

 * *Files 22% similar despite different names*

```diff
@@ -7,38 +7,66 @@
     """A DashSpreadGrid component.
 
 
 Keyword arguments:
 
 - id (string; optional)
 
-- columns (list; optional)
+- borderWidth (number; default 1)
 
-- data (list; optional)
+- clicked_cell (dict; optional)
+
+- clicked_custom_cell (dict; optional)
+
+- columnWidths (list; optional)
+
+- columns (list; default [{ "type": "DATA-BLOCK" }])
+
+- data (boolean | number | string | dict | list; optional)
+
+- dataSelector (string; default "data[row.id][column.id]")
+
+- editedCells (list; optional)
+
+- filtering (list; optional)
+
+- filters (list; optional)
+
+- focusedCell (dict; optional)
 
 - formatting (list; optional)
 
+- highlightedCells (list; optional)
+
 - pinnedBottom (number; default 0)
 
 - pinnedLeft (number; default 0)
 
 - pinnedRight (number; default 0)
 
 - pinnedTop (number; default 0)
 
-- rows (list; optional)"""
+- rowHeights (list; optional)
+
+- rows (list; default [{ "type": "HEADER" }, { "type": "DATA-BLOCK" }])
+
+- selectedCells (list; optional)
+
+- sortBy (list; optional)
+
+- sorting (list; optional)"""
     _children_props = []
     _base_nodes = ['children']
     _namespace = 'dash_spread_grid'
     _type = 'DashSpreadGrid'
     @_explicitize_args
-    def __init__(self, id=Component.UNDEFINED, data=Component.UNDEFINED, columns=Component.UNDEFINED, rows=Component.UNDEFINED, formatting=Component.UNDEFINED, pinnedTop=Component.UNDEFINED, pinnedBottom=Component.UNDEFINED, pinnedLeft=Component.UNDEFINED, pinnedRight=Component.UNDEFINED, **kwargs):
-        self._prop_names = ['id', 'columns', 'data', 'formatting', 'pinnedBottom', 'pinnedLeft', 'pinnedRight', 'pinnedTop', 'rows']
+    def __init__(self, id=Component.UNDEFINED, data=Component.UNDEFINED, columns=Component.UNDEFINED, rows=Component.UNDEFINED, formatting=Component.UNDEFINED, filtering=Component.UNDEFINED, sorting=Component.UNDEFINED, dataSelector=Component.UNDEFINED, pinnedTop=Component.UNDEFINED, pinnedBottom=Component.UNDEFINED, pinnedLeft=Component.UNDEFINED, pinnedRight=Component.UNDEFINED, borderWidth=Component.UNDEFINED, focusedCell=Component.UNDEFINED, selectedCells=Component.UNDEFINED, highlightedCells=Component.UNDEFINED, editedCells=Component.UNDEFINED, filters=Component.UNDEFINED, sortBy=Component.UNDEFINED, columnWidths=Component.UNDEFINED, rowHeights=Component.UNDEFINED, clicked_cell=Component.UNDEFINED, clicked_custom_cell=Component.UNDEFINED, **kwargs):
+        self._prop_names = ['id', 'borderWidth', 'clicked_cell', 'clicked_custom_cell', 'columnWidths', 'columns', 'data', 'dataSelector', 'editedCells', 'filtering', 'filters', 'focusedCell', 'formatting', 'highlightedCells', 'pinnedBottom', 'pinnedLeft', 'pinnedRight', 'pinnedTop', 'rowHeights', 'rows', 'selectedCells', 'sortBy', 'sorting']
         self._valid_wildcard_attributes =            []
-        self.available_properties = ['id', 'columns', 'data', 'formatting', 'pinnedBottom', 'pinnedLeft', 'pinnedRight', 'pinnedTop', 'rows']
+        self.available_properties = ['id', 'borderWidth', 'clicked_cell', 'clicked_custom_cell', 'columnWidths', 'columns', 'data', 'dataSelector', 'editedCells', 'filtering', 'filters', 'focusedCell', 'formatting', 'highlightedCells', 'pinnedBottom', 'pinnedLeft', 'pinnedRight', 'pinnedTop', 'rowHeights', 'rows', 'selectedCells', 'sortBy', 'sorting']
         self.available_wildcard_properties =            []
         _explicit_args = kwargs.pop('_explicit_args')
         _locals = locals()
         _locals.update(kwargs)  # For wildcard attrs and excess named props
         args = {k: _locals[k] for k in _explicit_args}
 
         super(DashSpreadGrid, self).__init__(**args)
```

### Comparing `dash_spread_grid-0.0.1/dash_spread_grid/__init__.py` & `dash_spread_grid-0.0.2/dash_spread_grid/__init__.py`

 * *Files identical despite different names*

### Comparing `dash_spread_grid-0.0.1/dash_spread_grid/dash_spread_grid.min.js.map` & `dash_spread_grid-0.0.2/dash_spread_grid/dash_spread_grid.min.js.map`

 * *Files 10% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.7380139273062479%*

 * *Differences: {"'mappings'": "'2rGAMA,SAASA,SAASC,GACd,MAAwB,iBAAVA,GAAsBA,aAAiBC,MACzD,CAEA,SAASC,sBAAsBC,YAC3B,OAAOC,EAAAA,mCAAAA,UAAQ,WACX,IAAMC,QAAU,oEAEhB,OAAOF,WAAWG,KAAI,SAAAC,MAClB,IAAMC,WAAa,CAAC,EAgBpB,GAdI,WAAYD,OACZC,WAAWC,OAASF,KAAKE,QACzB,QAASF,OACTC,WAAWE,IAAMH,KAAKG,KACtB,cAAeH,OACfC,WAAWG,UAAYC,KAAK,IAADC,OAAKR,QAAO,UAAAQ,OAASN,KAAKI,UAAS,OAC9D,UAAWJ,OACXC,WAAWR,MAAQY,KAAK,IAADC,OAAKR,QAAO,SAAAQ,OAAQN,KAAKP,MAAK,OACrD,SAAUO,OACVC,WAAWM,KAAOF,KAAK,IAADC,OAAKR,QAAO,UAAAQ,OAASN,KAAKO,KAAI,OACpD,UAAWP,OACXC, […]*

```diff
@@ -1,526 +1,214 @@
 {
     "file": "dash_spread_grid.min.js",
-    "mappings": "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",
+    "mappings": "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",
     "names": [
         "isString",
         "value",
         "String",
         "useResolvedFormatting",
         "formatting",
         "useMemo",
+        "context",
         "map",
         "rule",
         "mappedRule",
         "column",
         "row",
         "condition",
         "eval",
         "concat",
-        "style",
         "text",
+        "style",
+        "padding",
+        "edit",
+        "mappedEdit",
+        "validate",
+        "parse",
+        "autoCommit",
+        "auto_commit",
+        "useResolvedFiltering",
+        "filtering",
         "DashSpreadGrid",
         "props",
         "console",
         "count",
+        "setProps",
         "data",
         "columns",
         "rows",
         "pinnedTop",
         "pinnedBottom",
         "pinnedLeft",
         "pinnedRight",
+        "clickedCell",
+        "clicked_cell",
+        "onCellClick",
+        "useCallback",
+        "cell",
+        "_objectSpread",
+        "clickedCustomCell",
+        "clicked_custom_cell",
+        "onCustomCellClick",
+        "_useState2",
+        "_slicedToArray",
+        "useState",
+        "element",
+        "setElement",
+        "createGrid",
         "React",
-        "SpreadGrid",
+        "ref",
         "propTypes",
-        "id",
         "PropTypes",
+        "id",
+        "sorting",
+        "dataSelector",
+        "borderWidth",
+        "focusedCell",
+        "selectedCells",
+        "highlightedCells",
+        "editedCells",
+        "filters",
+        "sortBy",
+        "columnWidths",
+        "rowHeights",
         "defaultProps",
-        "useInvoked",
-        "expression",
-        "args",
-        "apply",
-        "_toConsumableArray",
-        "stringifyId",
+        "module",
+        "exports",
+        "window",
         "key",
         "Array",
         "isArray",
-        "stringified",
         "join",
-        "_typeof",
         "object",
         "Object",
         "keys",
         "sort",
-        "stringifyObject",
         "JSON",
         "stringify",
-        "getHighlightColor",
-        "baseColor",
-        "isStrong",
-        "Selection",
-        "selectedCells",
-        "_this",
-        "_classCallCheck",
-        "this",
-        "lookup",
-        "Map",
-        "forEach",
-        "cell",
-        "rowKey",
-        "rowId",
+        "getCellType",
+        "type",
+        "getEditableCells",
+        "formatResolver",
+        "columnLookup",
+        "rowLookup",
         "columnKey",
         "columnId",
+        "rowKey",
+        "rowId",
         "has",
-        "set",
-        "Set",
         "get",
-        "add",
-        "isKeySelected",
-        "useChangeCallback",
-        "currentValue",
-        "callback",
-        "comparator",
-        "ref",
-        "useRef",
-        "current",
-        "useCallback",
-        "newValue",
+        "resolve",
+        "filter",
+        "defaultFont",
+        "defaultPadding",
+        "top",
+        "right",
+        "bottom",
+        "left",
         "roundToPixels",
         "devicePixelRatio",
         "Math",
         "round",
-        "useDevicePixelRatio",
-        "_useState2",
-        "useState",
-        "window",
-        "setDevicePixelRatio",
-        "useEffect",
-        "media",
-        "matchMedia",
-        "updateDevicePixelRatio",
-        "log",
-        "addEventListener",
-        "once",
-        "removeEventListener",
-        "Edition",
-        "editedCells",
-        "hasValueByKey",
-        "getValueByKey",
-        "borderTypes",
-        "StyleGroup",
-        "_createClass",
-        "_defineProperty",
-        "matchMapping",
-        "undefined",
-        "FormattingRules",
-        "rules",
-        "columnLookup",
-        "rulesCount",
-        "_step",
-        "_iterator",
-        "_createForOfIteratorHelper",
-        "s",
-        "n",
-        "done",
-        "addRule",
-        "err",
-        "e",
-        "f",
-        "filter",
-        "index",
-        "match",
-        "entry",
-        "addRowRule",
-        "push",
-        "_objectSpread",
-        "addColumnRule",
-        "byKey",
-        "byIndex",
-        "_step2",
-        "_iterator2",
-        "byMatch",
-        "edit",
-        "draw",
-        "by",
-        "type",
-        "_step3",
-        "_iterator3",
-        "edition",
-        "filtering",
-        "gatherRules",
-        "newRules",
-        "_step4",
-        "_iterator4",
-        "gatherRowRules",
-        "a",
-        "b",
-        "context",
-        "visible",
-        "_loop",
-        "_rules",
-        "_i3",
-        "newStyle",
-        "_i",
-        "_borderTypes",
+        "renderSection",
+        "vertical",
+        "horizontal",
+        "state",
+        "canvas",
+        "canvases",
+        "verticalSection",
+        "sections",
+        "horizontalSection",
         "length",
-        "border",
-        "_i2",
-        "_borderTypes2",
-        "borderType",
-        "indexBorders",
-        "currentContext",
+        "parentElement",
+        "removeChild",
+        "appendChild",
+        "log",
         "ctx",
-        "hasValueByKeyAndSelector",
-        "filterContext",
-        "getValueByKeyAndSelector",
-        "result",
-        "Filtering",
-        "filters",
-        "filteredColumns",
-        "filteredRows",
-        "size",
-        "selector",
-        "FormatResolver",
-        "formattingRules",
-        "resolve",
-        "VisibilityResolver",
-        "hasRowFilters",
-        "every",
-        "hasRowFiltersByKey",
-        "_this2",
-        "hasColumnFilters",
-        "hasColumnFiltersByKey",
-        "compareCells",
-        "oldCell",
-        "newCell",
-        "compareSelectedCells",
-        "oldCells",
-        "newCells",
-        "selection",
-        "isIdSelected",
-        "compareEditedCells",
-        "getValueById",
-        "compareFilters",
-        "oldFilters",
-        "newFilters",
-        "getPinned",
-        "pinnedBegin",
-        "pinnedEnd",
-        "useResolvedColumnsOrRows",
-        "elements",
-        "element",
-        "pinned",
-        "useFormatResolver",
-        "dataFormatting",
-        "DataContext",
-        "createContext",
-        "ColumnsAndRowsContext",
-        "InteractionsContext",
-        "RenderingContext",
-        "SizeContext",
-        "StateProvider",
-        "borderWidth",
-        "_ref",
-        "header",
-        "_ref2",
-        "_ref3",
-        "validate",
-        "parse",
-        "_ref4",
-        "string",
-        "dataSelector",
-        "editedCellsAndFilters",
-        "unfilteredColumns",
-        "unfilteredRows",
-        "visibilityResolver",
-        "useVisibilityResolver",
-        "findVisibleColumns",
-        "findVisibleRows",
-        "left",
-        "width",
-        "newColumn",
-        "leftWithBorder",
-        "right",
-        "rightWithBorder",
-        "usePlacedColumns",
-        "top",
-        "height",
-        "newRow",
-        "topWithBorder",
-        "bottom",
-        "bottomWithBorder",
-        "usePlacedRows",
-        "sections",
-        "topLength",
-        "bottomLength",
-        "middleLength",
-        "leftLength",
-        "rightLength",
-        "centerLength",
-        "topRows",
-        "slice",
-        "bottomRows",
-        "middleRows",
-        "leftColumns",
-        "rightColumns",
-        "centerColumns",
-        "hasTopRows",
-        "hasLeftColumns",
-        "bottomShowTopBorder",
-        "middleShowTopBorder",
-        "middleShowBottomBorder",
-        "rightShowLeftBorder",
-        "centerShowLeftBorder",
-        "centerShowRightBorder",
-        "getHeight",
+        "getContext",
+        "alpha",
+        "scrollRect",
+        "textResolver",
+        "renderFormatResolver",
+        "sectionBorders",
         "showTopBorder",
         "showBottomBorder",
-        "at",
-        "getWidth",
         "showLeftBorder",
         "showRightBorder",
-        "middle",
-        "center",
-        "getSections",
-        "highlight",
-        "highlightedCells",
-        "hoveredCell",
-        "focusedCell",
-        "renderFormatting",
-        "hoveredColumnKey",
-        "hoveredRowKey",
-        "focusedColumnKey",
-        "focusedRowKey",
-        "isSelected",
-        "rowIndex",
-        "columnIndex",
-        "background",
-        "foreground",
-        "color",
-        "_ref5",
-        "borderTop",
-        "Number",
-        "MAX_SAFE_INTEGER",
-        "borderBottom",
-        "borderLeft",
-        "borderRight",
-        "_ref6",
-        "_ref7",
-        "_ref8",
-        "_ref9",
-        "corner",
-        "_ref10",
-        "getRenderFormattingRules",
-        "renderFormatResolver",
-        "inputFormatResolver",
-        "fixedSize",
-        "totalSize",
-        "setSelectedCells",
-        "onSelectedCellsChange",
-        "setHighlightedCells",
-        "onHighlightedCellsChange",
-        "setEditedCells",
-        "onEditedCellsChange",
-        "setHoveredCell",
-        "onHoveredCellChange",
-        "setFocusedCell",
-        "onFocusedCellChange",
-        "setFilters",
-        "onFiltersChange",
-        "addSelectedCells",
-        "cells",
-        "oldSelectedCells",
-        "addEditedCells",
-        "oldEditedCells",
-        "hasValueById",
-        "addFilters",
-        "removeEditedCells",
-        "removeFilters",
-        "reduce",
-        "children",
-        "Context",
-        "Provider",
-        "useColumns",
-        "useRows",
-        "useSections",
-        "useSelectedCells",
-        "useHoveredCell",
-        "useFocusedCell",
-        "useRenderFormatResolver",
-        "useInputFormatResolver",
-        "useSetSelectedCells",
-        "useSetHighlightedCells",
-        "useSetEditedCells",
-        "useSetHoveredCell",
-        "useSetFocusedCell",
-        "useAddSelectedCells",
-        "useAddEditedCells",
-        "useAddFilters",
-        "useRemoveEditedCells",
-        "useRemoveFilters",
-        "useFixedSize",
-        "useTotalSize",
-        "useBorderWidth",
-        "TextResolver",
-        "canvas",
-        "document",
-        "createElement",
-        "getContext",
-        "fontMetrics",
-        "font",
-        "textMetrics",
-        "measureText",
-        "actualBoundingBoxDescent",
-        "actualBoundingBoxAscent",
-        "topOffset",
-        "fontBoundingBoxAscent",
-        "bottomOffset",
-        "fontBoundingBoxDescent",
-        "useDeepState",
-        "initialState",
-        "state",
-        "setState",
-        "newState",
-        "oldState",
-        "useEventListener",
-        "eventName",
-        "handler",
-        "deps",
-        "SizeAndScrollContext",
-        "compareScrollOffsets",
-        "oldScrollOffset",
-        "newScrollOffset",
-        "compareSizes",
-        "oldSize",
-        "newSize",
-        "SizeAndScrollProvider",
-        "_useDeepState2",
-        "_slicedToArray",
-        "scrollOffset",
-        "setScrollOffset",
-        "_useDeepState4",
-        "setSize",
-        "_useDeepState6",
-        "clientSize",
-        "setClientSize",
-        "scrollLeft",
-        "scrollTop",
-        "ObserverClass",
-        "observer",
-        "observe",
-        "disconnect",
-        "useDomObserver",
-        "ResizeObserver",
-        "getBoundingClientRect",
-        "clientWidth",
-        "clientHeight",
-        "useScrollOffset",
-        "useContext",
-        "useSize",
-        "useClientSize",
-        "contains",
-        "bounds",
-        "rect",
-        "clip",
-        "newRect",
-        "max",
-        "min",
-        "expand",
-        "margin",
-        "area",
-        "subtract",
-        "ScrollRectContext",
-        "requiredMargin",
-        "preloadedMargin",
-        "emptyRect",
-        "ScrollRectProvider",
-        "factory",
-        "scrollRect",
-        "previous",
-        "prevScrollRect",
-        "requiredScrollRect",
-        "preloadedScrollRect",
-        "useScrollRect",
-        "GridSectionContext",
-        "GridSectionProvider",
-        "horizontal",
-        "vertical",
-        "_sections$vertical",
-        "_sections$horizontal",
-        "actualHeight",
-        "actualWidth",
-        "sectionRect",
-        "sectionBorders",
-        "borders",
-        "useSectionColumns",
-        "useSectionRows",
-        "useSectionRect",
-        "useSectionBorders",
-        "GridCanvas",
-        "setCanvas",
-        "textResolver",
-        "formatResolver",
-        "nextFrame",
-        "requestAnimationFrame",
         "borderOffset",
-        "rowCount",
-        "columnCount",
         "horizontalBorderCount",
         "verticalBorderCount",
-        "rowHeights",
-        "columnWidths",
+        "height",
+        "width",
         "totalWidth",
+        "reduce",
+        "a",
+        "b",
         "totalHeight",
         "horizontalOffsets",
         "acc",
+        "index",
         "offset",
+        "push",
         "verticalOffsets",
         "columnOffsets",
+        "slice",
         "rowOffsets",
         "minVisibleColumnIndex",
+        "max",
         "findLastIndex",
         "maxVisibleColumnIndex",
         "minVisibleRowIndex",
         "maxVisibleRowIndex",
         "minVisibleVerticalBorderIndex",
         "maxVisibleVerticalBorderIndex",
         "minVisibleHorizontalBorderIndex",
         "maxVisibleHorizontalBorderIndex",
+        "cells",
         "from",
         "_",
+        "rowIndex",
+        "columnIndex",
         "getCell",
         "marginLeft",
         "marginTop",
         "marginRight",
         "marginBottom",
         "fillStyle",
         "fillRect",
         "setTransform",
         "x",
         "y",
         "setClip",
         "beginPath",
+        "rect",
+        "clip",
         "save",
         "cellTop",
         "cellLeft",
         "cellWidth",
         "cellHeight",
         "textAlign",
         "textBaseline",
-        "paddingLeft",
-        "paddingRight",
-        "paddingTop",
-        "paddingBottom",
+        "background",
+        "draw",
+        "highlight",
+        "corner",
         "moveTo",
         "lineTo",
         "fill",
+        "foreground",
+        "font",
+        "fontMetrics",
         "getFontMetrics",
         "textX",
         "textY",
+        "middle",
+        "topOffset",
+        "bottomOffset",
         "fillText",
         "strokeStyle",
         "lineWidth",
         "stroke",
         "restore",
         "drawBorder",
         "x1",
@@ -528,199 +216,476 @@
         "x2",
         "y2",
         "isHorizontal",
         "xa",
         "ya",
         "xb",
         "yb",
+        "color",
         "dash",
         "setLineDash",
         "lineDashOffset",
         "selectBorder",
         "borderStyleA",
         "borderStyleB",
         "horizontalBorderIndex",
         "topRowIndex",
         "bottomRowIndex",
         "borderStyle",
+        "borderBottom",
+        "borderTop",
         "verticalBorderIndex",
         "leftColumnIndex",
         "rightColumnIndex",
-        "cancelAnimationFrame",
-        "MouseAndKeyboardContext",
-        "compareMousePositions",
-        "oldMousePosition",
-        "newMousePosition",
-        "MouseAndKeyboardProvider",
-        "interactions",
-        "mousePosition",
-        "setMousePosition",
-        "isMouseDown",
-        "setIsMouseDown",
-        "event",
-        "clientX",
-        "offsetLeft",
-        "clientY",
-        "offsetTop",
-        "mousedown",
-        "mouseup",
-        "keydown",
-        "click",
-        "dblclick",
+        "borderRight",
+        "borderLeft",
+        "render",
+        "error",
+        "input",
+        "inputPlacement",
+        "hasFocus",
+        "document",
+        "activeElement",
         "focus",
-        "useInteraction",
-        "name",
-        "useMousePosition",
-        "useIsMouseDown",
-        "useFocus",
-        "forwardRef",
-        "onTextChange",
-        "placement",
-        "isValid",
-        "setElement",
-        "internalText",
-        "stopPropagation",
-        "setElementAndRef",
-        "onChange",
-        "target",
-        "select",
-        "autoFocus",
-        "position",
-        "zIndex",
-        "opacity",
-        "pointerEvents",
-        "outline",
-        "boxShadow",
-        "padding",
-        "fontSize",
-        "fontFamily",
         "backgroundColor",
-        "placeholder",
-        "Fragment",
-        "findHighlightedCells",
-        "rowLookup",
+        "isTextValid",
+        "renderInput",
+        "resizableColumn",
+        "resizableRow",
+        "cursor",
+        "renderCursor",
+        "renderInternal",
+        "display",
+        "flexDirection",
+        "innerHTML",
+        "message",
+        "stack",
+        "renderError",
+        "getDataFormatting",
+        "match",
+        "undefined",
+        "header",
+        "direction",
+        "newValue",
+        "string",
+        "getInputFormatting",
+        "getHighlightColor",
+        "baseColor",
+        "isStrong",
+        "getRenderFormatting",
+        "hoveredCell",
+        "selection",
+        "edition",
+        "focusedColumnKey",
+        "focusedRowKey",
+        "isResizingColumn",
+        "isResizingRow",
+        "isResizing",
+        "isSelected",
+        "isKeySelected",
+        "optional",
+        "border",
+        "Number",
+        "MAX_SAFE_INTEGER",
+        "hasValueByKey",
+        "getSections",
+        "topLength",
+        "pinned",
+        "bottomLength",
+        "middleLength",
+        "leftLength",
+        "rightLength",
+        "centerLength",
+        "topRows",
+        "bottomRows",
+        "middleRows",
+        "leftColumns",
+        "rightColumns",
+        "centerColumns",
+        "hasTopRows",
+        "hasLeftColumns",
+        "bottomShowTopBorder",
+        "middleShowTopBorder",
+        "middleShowBottomBorder",
+        "rightShowLeftBorder",
+        "centerShowLeftBorder",
+        "centerShowRightBorder",
+        "getHeight",
+        "at",
+        "topWithBorder",
+        "bottomWithBorder",
+        "getWidth",
+        "leftWithBorder",
+        "rightWithBorder",
+        "center",
+        "getEditedCellsAndFilters",
+        "expression",
+        "Edition",
+        "constructor",
+        "this",
+        "lookup",
+        "Map",
+        "forEach",
+        "set",
+        "getValueByKey",
+        "hasValueById",
+        "getValueById",
+        "getEdition",
+        "editedCellsAndFilters",
+        "Selection",
+        "Set",
+        "add",
+        "isIdSelected",
+        "getSelection",
+        "getInvoked",
+        "columnsOrRows",
+        "getPinned",
+        "pinnedBegin",
+        "pinnedEnd",
+        "getResolved",
+        "elements",
+        "labels",
+        "getResolvedColumns",
+        "widthsLookup",
+        "getResolvedRows",
+        "heightsLookup",
+        "getPlacedColumns",
+        "newColumn",
+        "getPlacedRows",
+        "newRow",
+        "matchMapping",
+        "Lookup",
+        "byKey",
+        "byIndex",
+        "byLabel",
+        "byMatch",
+        "RulesLookup",
+        "hasRules",
+        "addRule",
+        "c",
+        "r",
+        "addColumnRule",
+        "label",
+        "addRowRule",
+        "getRules",
+        "rules",
+        "gatherRules",
+        "newRules",
+        "gatherRowRules",
+        "borderTypes",
+        "indexBorders",
+        "newStyle",
+        "borderType",
+        "FormattingRules",
+        "rulesLookup",
+        "entries",
+        "entry",
+        "array",
+        "currentContext",
+        "result",
+        "visible",
+        "getFormattingRules",
+        "dataFormatting",
+        "FormatResolver",
+        "formattingRules",
+        "getFormatResolver",
+        "getFilterLookup",
+        "primaryKey",
+        "secondaryKey",
+        "filterLookup",
+        "primary",
+        "secondary",
+        "getFilteredRows",
+        "filteringRules",
+        "filteredColumns",
+        "columnFilters",
+        "getFilteredColumns",
+        "filteredRows",
+        "rowFilters",
+        "getFixedSize",
+        "getTotalSize",
+        "TextResolver",
+        "createElement",
+        "measureWidth",
+        "measureText",
+        "measureHeight",
+        "lines",
+        "char",
+        "textMetrics",
+        "actualBoundingBoxDescent",
+        "actualBoundingBoxAscent",
+        "fontBoundingBoxAscent",
+        "fontBoundingBoxDescent",
+        "getTextResolver",
+        "contains",
+        "bounds",
+        "newRect",
+        "min",
+        "expand",
+        "margin",
+        "subtract",
+        "requiredMargin",
+        "preloadedMargin",
+        "emptyRect",
+        "getLookup",
+        "getHighlightedCells",
+        "isMouseDown",
+        "hoveredColumnKey",
+        "hoveredRowKey",
         "minColumnIndex",
         "maxColumnIndex",
         "minRowIndex",
         "maxRowIndex",
         "flatMap",
-        "getCellType",
-        "getEditableCells",
-        "GridInteractions",
-        "setText",
-        "_useState4",
-        "input",
-        "setInput",
-        "columnPlacement",
-        "useColumnPlacement",
-        "rowPlacement",
-        "useRowPlacement",
-        "isTextValid",
+        "getInputPlacement",
+        "editableCells",
+        "boxSizing",
+        "getIsTextValid",
+        "every",
+        "getDefaultIds",
+        "getDefaultRowIds",
+        "getDefaultColumnIds",
+        "getUnfoldedColumns",
+        "some",
+        "unfoldedColumns",
+        "ids",
+        "selector",
+        "getUnfoldedRows",
+        "unfoldedRows",
+        "defaultCondition",
+        "includes",
+        "FilteringRules",
+        "by",
+        "filterContext",
+        "getFilteringRules",
+        "getFilterFormatting",
+        "getMeasureFormatting",
+        "getMeasuredColumns",
+        "measuringCache",
+        "presentKeys",
+        "measureColumn",
+        "requestedWidth",
+        "cached",
+        "dataOnly",
+        "delete",
+        "getMeasuredRows",
+        "measureRow",
+        "requestedHeight",
+        "getKeys",
+        "getSortingFormatting",
+        "defaultComparatorAsc",
+        "lhs",
+        "rhs",
+        "defaultComparatorDesc",
+        "SortingRules",
+        "stringifyId",
+        "comparatorAsc",
+        "comparator",
+        "comparatorDesc",
+        "sortByLookup",
+        "Error",
+        "getSortingRules",
+        "getSortByLookup",
+        "flush",
+        "temp",
+        "entity",
+        "getSortedRows",
+        "sortingRules",
+        "sortedColumns",
+        "reverse",
+        "getSortedColumns",
+        "sortedRows",
+        "grabOffset",
+        "getResizableColumn",
+        "mousePosition",
+        "getResizableRow",
+        "getResolvedSortBy",
+        "updateStateInternal",
+        "options",
+        "localOptions",
+        "externalOptions",
+        "memory",
+        "previousState",
+        "cache",
+        "func",
+        "dependencies",
+        "previousDependencies",
+        "dependency",
+        "invokedColumns",
+        "invokedRows",
+        "unfilteredColumns",
+        "unfilteredRows",
+        "unfilteredColumnKeys",
+        "unfilteredRowKeys",
+        "filterFormatting",
+        "filterFormattingRules",
+        "sortingFormatting",
+        "sortingFormattingRules",
+        "shapedColumns",
+        "shapedRows",
+        "measureFormatting",
+        "measureFormattingRules",
+        "measureFormatResolver",
+        "columnWidthCache",
+        "rowHeightCache",
+        "measuredColumns",
+        "measuredRows",
+        "fixedSize",
+        "totalSize",
+        "scrollOffset",
+        "scrollLeft",
+        "scrollTop",
+        "clientSize",
+        "clientWidth",
+        "clientHeight",
         "hoverRowIndex",
         "iterA",
         "iterC",
         "iterB",
         "floor",
-        "findRowIndex",
+        "getRowIndex",
         "hoverColumnIndex",
-        "findColumnIndex",
+        "getColumnIndex",
+        "getHoveredCell",
+        "resizingColumn",
+        "resizingRow",
+        "renderFormatting",
+        "renderFormattingRules",
+        "inputFormatting",
+        "inputFormattingRules",
+        "inputFormatResolver",
+        "previous",
+        "size",
+        "getBoundingClientRect",
+        "prevScrollRect",
+        "requiredScrollRect",
+        "preloadedScrollRect",
+        "getScrollRect",
+        "updateState",
+        "getCombinedCells",
+        "previousCells",
+        "newCells",
+        "getReducedCells",
+        "cellsToRemove",
+        "getMousePosition",
+        "event",
+        "currentTarget",
+        "clientX",
+        "clientY",
+        "initialize",
+        "setAttribute",
+        "classList",
+        "renderRequested",
+        "requestAnimationFrame",
+        "listener",
+        "addEventListener",
+        "requestNewRender",
+        "onFocusedCellChange",
+        "onSelectedCellsChange",
+        "onEditedCellsChange",
+        "onFiltersChange",
+        "onSortByChange",
+        "onColumnWidthsChange",
+        "onRowHeightsChange",
+        "setText",
+        "dispatchEvent",
+        "Event",
+        "accept",
+        "setEditedCells",
+        "setFilters",
+        "dataCells",
+        "filterCells",
+        "addFilters",
+        "clear",
+        "removeFilters",
+        "columnWidth",
+        "columnRight",
+        "newColumnWidth",
+        "newColumnWidths",
+        "rowHeight",
+        "rowBottom",
+        "newRowHeight",
+        "newRowHeights",
+        "mouseDownPosition",
+        "mouseDownCell",
         "ctrlKey",
+        "setPointerCapture",
+        "pointerId",
+        "releasePointerCapture",
+        "newSortBy",
+        "isCurrentRule",
+        "directionLoop",
+        "currentRule",
+        "find",
+        "directionIndex",
+        "indexOf",
+        "newDirection",
+        "isLastRule",
+        "getNewSortBy",
+        "resizableColumnKey",
+        "resizableRowKey",
+        "select",
+        "setSelectedCells",
+        "setFocusedCell",
         "arrowTo",
         "shiftKey",
         "arrowHorizontally",
         "focusedColumnIndex",
         "newColumnIndex",
         "newFocusedCell",
         "arrowVertically",
         "focusedRowIndex",
         "newRowIndex",
         "preventDefault",
-        "editableCells",
-        "dataCells",
-        "filterCells",
-        "accept",
-        "inputPlacement",
-        "boxSizing",
-        "inputHasFocus",
-        "activeElement",
-        "GridInput",
-        "Grid",
-        "container",
-        "setContainer",
-        "className",
-        "tabIndex",
-        "maxWidth",
-        "maxHeight",
-        "overflow",
-        "display",
-        "gridTemplateColumns",
-        "gridTemplateRows",
-        "gridRow",
-        "gridColumn",
-        "defaultData",
-        "defaultColumns",
-        "defaultRows",
-        "defaultFormatting",
-        "defaultDataSelector",
-        "defaultPinnedTop",
-        "defaultPinnedBottom",
-        "defaultPinnedLeft",
-        "defaultPinnedRight",
-        "defaultBorderWidth",
-        "localSelectedCells",
-        "setLocalSelectedCells",
-        "localHighlightedCells",
-        "setLocalHighlightedCells",
-        "_useState6",
-        "localEditedCells",
-        "setLocalEditedCells",
-        "_useState8",
-        "localFilters",
-        "setLocalFilters",
-        "_useState10",
-        "localHoveredCell",
-        "setLocalHoveredCell",
-        "_useState12",
-        "localFocusedCell",
-        "setLocalFocusedCell",
-        "_props$onSelectedCell",
-        "call",
-        "_props$onHighlightedC",
-        "_props$onEditedCellsC",
-        "_props$onFiltersChang",
-        "_props$onHoveredCellC",
-        "_props$onFocusedCellC",
-        "module",
-        "exports",
+        "stopPropagation",
+        "clipboardData",
+        "selectedCellKeys",
+        "selectedColumns",
+        "selectedRows",
+        "stringBuilder",
+        "cellData",
+        "getClipboardData",
+        "navigator",
+        "clipboard",
+        "writeText",
+        "copyToClipboard",
+        "ResizeObserver",
+        "observe",
+        "target",
+        "opacity",
+        "pointerEvents",
+        "isTrusted",
         "__webpack_module_cache__",
         "__webpack_require__",
         "moduleId",
         "cachedModule",
         "__webpack_modules__",
+        "n",
         "getter",
         "__esModule",
         "d",
         "definition",
         "o",
         "defineProperty",
         "enumerable",
         "obj",
         "prop",
         "prototype",
         "hasOwnProperty",
-        "r",
+        "call",
         "Symbol",
         "toStringTag",
         "getCurrentScript",
         "script",
         "currentScript",
         "doc_scripts",
         "getElementsByTagName",
         "scripts",
         "i",
+        "s",
         "async",
         "textContent",
         "isLocalScript",
         "test",
         "src",
         "url",
         "split",
@@ -731,87 +696,145 @@
         "srcFragments",
         "fileFragments",
         "splice"
     ],
     "sourceRoot": "",
     "sources": [
         "webpack:///./src/lib/components/DashSpreadGrid.jsx",
-        "webpack:///./src/lib/lib/hooks/useInvoked.js",
-        "webpack:///./src/lib/lib/utils/stringifyId.js",
-        "webpack:///./src/lib/lib/utils/getRenderFormattingRules.js",
-        "webpack:///./src/lib/lib/utils/Selection.js",
-        "webpack:///./src/lib/lib/hooks/useChangeCallback.js",
-        "webpack:///./src/lib/lib/hooks/useDevicePixelRatio.js",
-        "webpack:///./src/lib/lib/utils/Edition.js",
-        "webpack:///./src/lib/lib/utils/FormattingRules.js",
-        "webpack:///./src/lib/lib/utils/Filtering.js",
-        "webpack:///./src/lib/lib/utils/FormatResolver.js",
-        "webpack:///./src/lib/lib/utils/VisibilityResolver.js",
-        "webpack:///./src/lib/lib/contexts/StateContext.jsx",
-        "webpack:///./src/lib/lib/utils/getDataFormattingRules.js",
-        "webpack:///./src/lib/lib/utils/getSections.js",
-        "webpack:///./src/lib/lib/utils/TextResolver.js",
-        "webpack:///./src/lib/lib/hooks/useDeepState.js",
-        "webpack:///./src/lib/lib/hooks/useEventListener.js",
-        "webpack:///./src/lib/lib/contexts/SizeAndScrollContext.jsx",
-        "webpack:///./src/lib/lib/hooks/useDomObserver.js",
-        "webpack:///./src/lib/lib/utils/rect.js",
-        "webpack:///./src/lib/lib/contexts/ScrollRectContext.jsx",
-        "webpack:///./src/lib/lib/hooks/useRefMemo.js",
-        "webpack:///./src/lib/lib/contexts/GridSectionContext.jsx",
-        "webpack:///./src/lib/lib/fragments/GridCanvas.jsx",
-        "webpack:///./src/lib/lib/contexts/MouseAndKeyboardContext.jsx",
-        "webpack:///./src/lib/lib/fragments/GridInput.jsx",
-        "webpack:///./src/lib/lib/fragments/GridInteractions.jsx",
-        "webpack:///./src/lib/lib/fragments/Grid.jsx",
-        "webpack:///./src/lib/lib/components/SpreadGrid.jsx",
         "webpack:///external window \"PropTypes\"",
         "webpack:///external window \"React\"",
+        "webpack:///../lib/src/core-utils/stringifyId.js",
+        "webpack:///../lib/src/state-utils/getCellType.js",
+        "webpack:///../lib/src/state-utils/getEditableCells.js",
+        "webpack:///../lib/src/core-utils/defaults.js",
+        "webpack:///../lib/src/core-utils/roundToPixels.js",
+        "webpack:///../lib/src/core/render.js",
+        "webpack:///../lib/src/state-utils/getDataFormatting.js",
+        "webpack:///../lib/src/state-utils/getInputFormatting.js",
+        "webpack:///../lib/src/state-utils/getRenderFormatting.js",
+        "webpack:///../lib/src/state-utils/getSections.js",
+        "webpack:///../lib/src/state-utils/getEditedCellsAndFilters.js",
+        "webpack:///../lib/src/types/Edition.js",
+        "webpack:///../lib/src/state-utils/getEdition.js",
+        "webpack:///../lib/src/types/Selection.js",
+        "webpack:///../lib/src/state-utils/getSelection.js",
+        "webpack:///../lib/src/state-utils/getInvoked.js",
+        "webpack:///../lib/src/state-utils/getPinned.js",
+        "webpack:///../lib/src/state-utils/getResolved.js",
+        "webpack:///../lib/src/state-utils/getPlaced.js",
+        "webpack:///../lib/src/types/RulesLookup.js",
+        "webpack:///../lib/src/types/FormattingRules.js",
+        "webpack:///../lib/src/state-utils/getFormattingRules.js",
+        "webpack:///../lib/src/types/FormatResolver.js",
+        "webpack:///../lib/src/state-utils/getFormatResolver.js",
+        "webpack:///../lib/src/state-utils/getFiltered.js",
+        "webpack:///../lib/src/state-utils/getFixedSize.js",
+        "webpack:///../lib/src/state-utils/getTotalSize.js",
+        "webpack:///../lib/src/types/TextResolver.js",
+        "webpack:///../lib/src/state-utils/getTextResolver.js",
+        "webpack:///../lib/src/core-utils/rect.js",
+        "webpack:///../lib/src/state-utils/getScrollRect.js",
+        "webpack:///../lib/src/state-utils/getLookup.js",
+        "webpack:///../lib/src/state-utils/getHighlightedCells.js",
+        "webpack:///../lib/src/state-utils/getInputPlacement.js",
+        "webpack:///../lib/src/state-utils/getIsTextValid.js",
+        "webpack:///../lib/src/state-utils/getUnfolded.js",
+        "webpack:///../lib/src/types/FilteringRules.js",
+        "webpack:///../lib/src/state-utils/getFilteringRules.js",
+        "webpack:///../lib/src/state-utils/getFilterFormatting.js",
+        "webpack:///../lib/src/state-utils/getMeasureFormatting.js",
+        "webpack:///../lib/src/state-utils/getMeasured.js",
+        "webpack:///../lib/src/state-utils/getKeys.js",
+        "webpack:///../lib/src/state-utils/getSortingFormatting.js",
+        "webpack:///../lib/src/types/SortingRules.js",
+        "webpack:///../lib/src/state-utils/getSortingRules.js",
+        "webpack:///../lib/src/state-utils/getSorted.js",
+        "webpack:///../lib/src/state-utils/getResizable.js",
+        "webpack:///../lib/src/state-utils/getResolvedSortBy.js",
+        "webpack:///../lib/src/core/state.js",
+        "webpack:///../lib/src/state-utils/getHoveredCell.js",
+        "webpack:///../lib/src/state-utils/getRowIndex.js",
+        "webpack:///../lib/src/state-utils/getColumnIndex.js",
+        "webpack:///../lib/src/state-utils/getCombinedCells.js",
+        "webpack:///../lib/src/state-utils/getReducedCells.js",
+        "webpack:///../lib/src/state-utils/getMousePosition.js",
+        "webpack:///../lib/src/index.js",
+        "webpack:///../lib/src/state-utils/getNewSortBy.js",
+        "webpack:///../lib/src/state-utils/getClipboardData.js",
         "webpack:///webpack/bootstrap",
         "webpack:///webpack/runtime/compat get default export",
         "webpack:///webpack/runtime/define property getters",
         "webpack:///webpack/runtime/hasOwnProperty shorthand",
         "webpack:///webpack/runtime/make namespace object",
         "webpack:///webpack/runtime/compat"
     ],
     "sourcesContent": [
-        "/* eslint-disable import/prefer-default-export */\n\nimport React, { useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport SpreadGrid from './../lib/components/SpreadGrid';\n\nfunction isString(value) {\n    return typeof value === 'string' || value instanceof String;\n}\n\nfunction useResolvedFormatting(formatting) {\n    return useMemo(() => {\n        return formatting.map(rule => {\n            const mappedRule = {};\n\n            if ('column' in rule)\n                mappedRule.column = rule.column;\n            if ('row' in rule)\n                mappedRule.row = rule.row;\n            if ('condition' in rule)\n                mappedRule.condition = eval(`({data, rows, columns, row, column, value, newValue, text}) => (${rule.condition})`);\n            if ('style' in rule)\n                mappedRule.style = isString(rule.style) ? eval(`({data, rows, columns, row, column, value, newValue, text}) => (${rule.style})`) : rule.style;\n            if ('value' in rule)\n                mappedRule.value = eval(`({data, rows, columns, row, column, value, newValue, text})=> (${rule.value})`);\n            if ('text' in rule)\n                mappedRule.text = eval(`({data, rows, columns, row, column, value, newValue, text}) => (${rule.text})`);\n\n            return mappedRule;\n        });\n    }, [formatting]);\n}\n\n// TODO: Write description\n// TODO: Rename to DashSpreadGrid\nfunction DashSpreadGrid(props) {\n    console.count('render DashSpreadGrid');\n\n    const data = props.data;\n    const columns = props.columns;\n    const rows = props.rows;\n    const formatting = useResolvedFormatting(props.formatting);\n    const pinnedTop = props.pinnedTop;\n    const pinnedBottom = props.pinnedBottom;\n    const pinnedLeft = props.pinnedLeft;\n    const pinnedRight = props.pinnedRight;\n\n    // eslint-disable-next-line react/prop-types\n    // const setProps = props.setProps;\n\n    // const setSelectedCells = useCallback(selectedCells => setProps({ selectedCells }), [setProps]);\n    // const setHoveredCell = useCallback(hoveredCell => setProps({ hoveredCell }), [setProps]);\n    // const setFocusedCell = useCallback(focusedCell => setProps({ focusedCell }), [setProps]);\n\n    return (\n        <SpreadGrid\n            data={data}\n            columns={columns}\n            rows={rows}\n            formatting={formatting}\n            pinnedTop={pinnedTop}\n            pinnedBottom={pinnedBottom}\n            pinnedLeft={pinnedLeft}\n            pinnedRight={pinnedRight}\n        />\n    );\n};\n\n// TODO: add descriptions\n// TODO: Fix types\nDashSpreadGrid.propTypes = {\n    // _\n    id: PropTypes.string,\n    // _\n    data: PropTypes.array,\n    // _\n    columns: PropTypes.array,\n    // _\n    rows: PropTypes.array,\n    // _\n    formatting: PropTypes.array,\n    // _\n    pinnedTop: PropTypes.number,\n    // _\n    pinnedBottom: PropTypes.number,\n    // _\n    pinnedLeft: PropTypes.number,\n    // _\n    pinnedRight: PropTypes.number,\n};\n\nDashSpreadGrid.defaultProps = {\n    data: [],\n    columns: [],\n    rows: [],\n    formatting: [],\n    pinnedTop: 0,\n    pinnedBottom: 0,\n    pinnedLeft: 0,\n    pinnedRight: 0,\n};\n\nexport default DashSpreadGrid;\n",
-        "/* eslint-disable react-hooks/exhaustive-deps */\n\nimport { useMemo } from \"react\";\n\nexport default function useInvoked(expression, args) {\n    return useMemo(() => {\n        if (typeof expression === 'function')\n            return expression(...args);\n\n        return expression;\n    }, [expression, ...args]);\n}",
+        "/* eslint-disable import/prefer-default-export */\n\nimport React, { useCallback, useMemo, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport createGrid from 'js-spread-grid';\n\nfunction isString(value) {\n    return typeof value === 'string' || value instanceof String;\n}\n\nfunction useResolvedFormatting(formatting) {\n    return useMemo(() => {\n        const context = '{data, rows, columns, row, column, value, newValue, text, string}';\n\n        return formatting.map(rule => {\n            const mappedRule = {};\n\n            if ('column' in rule)\n                mappedRule.column = rule.column;\n            if ('row' in rule)\n                mappedRule.row = rule.row;\n            if ('condition' in rule)\n                mappedRule.condition = eval(`(${context}) => (${rule.condition})`);\n            if ('value' in rule)\n                mappedRule.value = eval(`(${context})=> (${rule.value})`);\n            if ('text' in rule)\n                mappedRule.text = eval(`(${context}) => (${rule.text})`);\n            if ('style' in rule)\n                mappedRule.style = isString(rule.style) ? eval(`(${context}) => (${rule.style})`) : rule.style;\n            if ('padding' in rule)\n                mappedRule.padding = isString(rule.padding) ? eval(`(${context}) => (${rule.padding})`) : rule.padding;\n            if ('edit' in rule)\n                if (rule.edit) {\n                    const mappedEdit = {};\n                    if ('validate' in rule.edit)\n                        mappedEdit.validate = eval(`({string}) => (${rule.edit.validate})`);\n                    if ('parse' in rule.edit)\n                        mappedEdit.parse = eval(`(${context}) => (${rule.edit.parse})`);\n                    if ('auto_commit' in rule.edit)\n                        mappedEdit.autoCommit = rule.edit.auto_commit;\n                    mappedRule.edit = mappedEdit;\n                }\n                else {\n                    mappedRule.edit = rule.edit;\n                }\n\n            return mappedRule;\n        });\n    }, [formatting]);\n}\n\nfunction useResolvedFiltering(filtering) {\n    return useMemo(() => {\n        const context = '{data, rows, columns, row, column, value, text, expression}';\n\n        return filtering.map(rule => {\n            const mappedRule = {};\n\n            if ('column' in rule)\n                mappedRule.column = rule.column;\n            if ('row' in rule)\n                mappedRule.row = rule.row;\n            if ('condition' in rule)\n                mappedRule.condition = eval(`(${context}) => (${rule.condition})`);\n\n            return mappedRule;\n        });\n    }, [filtering]);\n}\n\n// TODO: Write description\n// TODO: Rename to DashSpreadGrid\nfunction DashSpreadGrid(props) {\n    console.count('render DashSpreadGrid');\n\n    const setProps = props.setProps;\n\n    const data = props.data;\n    const columns = props.columns;\n    const rows = props.rows;\n    const formatting = useResolvedFormatting(props.formatting);\n    const filtering = useResolvedFiltering(props.filtering);\n    const pinnedTop = props.pinnedTop;\n    const pinnedBottom = props.pinnedBottom;\n    const pinnedLeft = props.pinnedLeft;\n    const pinnedRight = props.pinnedRight;\n    const clickedCell = props.clicked_cell;\n    const onCellClick = useCallback((cell) => {\n        setProps({ clicked_cell: { ...cell } });\n    }, [setProps]);\n    const clickedCustomCell = props.clicked_custom_cell;\n    const onCustomCellClick = useCallback((cell) => {\n        setProps({ clicked_custom_cell: { ...cell } });\n    }, [setProps]);\n\n    const [element, setElement] = useState(null);\n\n    if (element)\n        createGrid(element, {\n            data,\n            columns,\n            rows,\n            formatting,\n            filtering,\n            pinnedTop,\n            pinnedBottom,\n            pinnedLeft,\n            pinnedRight,\n            clickedCell,\n            onCellClick,\n            clickedCustomCell,\n            onCustomCellClick\n        });\n\n    return React.createElement(\"div\", { ref: setElement });\n};\n\n// TODO: add descriptions\n// TODO: Fix types\nDashSpreadGrid.propTypes = {\n    // _\n    setProps: PropTypes.func,\n    // _\n    id: PropTypes.string,\n    // _\n    data: PropTypes.any,\n    // _\n    columns: PropTypes.array,\n    // _\n    rows: PropTypes.array,\n    // _\n    formatting: PropTypes.array,\n    // _\n    filtering: PropTypes.array,\n    // _\n    sorting: PropTypes.array,\n    // _\n    dataSelector: PropTypes.string,\n    // _\n    pinnedTop: PropTypes.number,\n    // _\n    pinnedBottom: PropTypes.number,\n    // _\n    pinnedLeft: PropTypes.number,\n    // _\n    pinnedRight: PropTypes.number,\n    // _\n    borderWidth: PropTypes.number,\n    // _\n    focusedCell: PropTypes.object,\n    // _\n    selectedCells: PropTypes.array,\n    // _\n    highlightedCells: PropTypes.array,\n    // _\n    editedCells: PropTypes.array,\n    // _\n    filters: PropTypes.array,\n    // _\n    sortBy: PropTypes.array,\n    // _\n    columnWidths: PropTypes.array,\n    // _\n    rowHeights: PropTypes.array,\n    // _\n    clicked_cell: PropTypes.object,\n    // _\n    clicked_custom_cell: PropTypes.object\n};\n\nDashSpreadGrid.defaultProps = {\n    data: [],\n    columns: [{ \"type\": \"DATA-BLOCK\" }],\n    rows: [{ \"type\": \"HEADER\" }, { \"type\": \"DATA-BLOCK\" }],\n    formatting: [],\n    filtering: [],\n    sorting: [],\n    dataSelector: \"data[row.id][column.id]\",\n    pinnedTop: 0,\n    pinnedBottom: 0,\n    pinnedLeft: 0,\n    pinnedRight: 0,\n    borderWidth: 1,\n    focusedCell: null,\n    selectedCells: [],\n    highlightedCells: [],\n    editedCells: [],\n    filters: [],\n    sortBy: [],\n    columnWidths: [],\n    rowHeights: [],\n    clicked_cell: null,\n    clicked_custom_cell: null\n};\n\nexport default DashSpreadGrid;\n",
+        "module.exports = window[\"PropTypes\"];",
+        "module.exports = window[\"React\"];",
         "function stringifyObject(object) {\n    const keys = Object.keys(object).sort();\n    const stringified = keys.map(key => {\n        return `${key}:${stringifyId(object[key])}`\n    });\n\n    return `{${stringified.join(',')}}`;\n}\n\nfunction stringifyArray(array) {\n    const stringified = array.map(stringifyId);\n\n    return `[${stringified.join(',')}]`;\n}\n\nexport default function stringifyId(key) {\n    if (key === null)\n        return 'null'\n\n    if (Array.isArray(key))\n        return stringifyArray(key)\n\n    if (typeof key === 'object')\n        return stringifyObject(key)\n\n    return JSON.stringify(key)\n}",
-        "import stringifyId from './stringifyId';\n\nfunction getHighlightColor(baseColor, isStrong) {\n    if (isStrong)\n        return baseColor + '99';\n    else\n        return baseColor + '33';\n}\n\nexport default function getRenderFormattingRules(formatting, hoveredCell, focusedCell, selection, highlight, edition) {\n    const hoveredColumnKey = hoveredCell ? stringifyId(hoveredCell.columnId) : null;\n    const hoveredRowKey = hoveredCell ? stringifyId(hoveredCell.rowId) : null;\n\n    const focusedColumnKey = focusedCell ? stringifyId(focusedCell.columnId) : null;\n    const focusedRowKey = focusedCell ? stringifyId(focusedCell.rowId) : null;\n\n    const isSelected = (rows, columns, rowIndex, columnIndex) => {\n        if (rowIndex < 0 || rowIndex >= rows.length)\n            return false;\n        if (columnIndex < 0 || columnIndex >= columns.length)\n            return false;\n\n        const rowKey = rows[rowIndex].key;\n        const columnKey = columns[columnIndex].key;\n\n        return selection.isKeySelected(rowKey, columnKey);\n    };\n\n    return [\n        {\n            column: { match: 'ANY' },\n            row: { match: 'FILTER' },\n            style: ({ newValue }) => ({ background: '#FBFBFB', foreground: newValue ? 'black' : '#cccccc', border: { width: 1, color: 'gray' } })\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'HEADER' },\n            style: { background: '#F5F5F5', border: { width: 1, color: 'gray' } }\n        },\n        ...formatting,\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => hoveredColumnKey === column.key || hoveredRowKey === row.key,\n            style: { highlight: '#81948133' },\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => hoveredColumnKey === column.key && hoveredRowKey === row.key,\n            style: { highlight: '#81948188' },\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ rows, columns, row, column }) => isSelected(rows, columns, row.index, column.index),\n            style: ({ rows, columns, row, column, edit }) => ({\n                ...(!isSelected(rows, columns, row.index - 1, column.index) ? { borderTop: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index + 1, column.index) ? { borderBottom: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index, column.index - 1) ? { borderLeft: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index, column.index + 1) ? { borderRight: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                highlight: getHighlightColor(edit ? '#798d9c' : '#819481', focusedColumnKey !== column.key || focusedRowKey !== row.key)\n            }),\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => highlight.isKeySelected(row.key, column.key),\n            style: ({ row, column }) => ({\n                highlight: getHighlightColor('#798d9c', focusedColumnKey !== column.key || focusedRowKey !== row.key)\n            })\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => focusedColumnKey === column.key && focusedRowKey === row.key,\n            style: { background: 'white' },\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ edit }) => edit,\n            style: { corner: '#77777720' },\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => edition.hasValueByKey(row.key, column.key),\n            style: { corner: 'darkgreen' },\n        },\n    ];\n}",
-        "import stringifyId from \"./stringifyId\";\n\nexport default class Selection {\n    constructor(selectedCells) {\n        this.lookup = new Map();\n\n        selectedCells.forEach(cell => {\n            const rowKey = stringifyId(cell.rowId);\n            const columnKey = stringifyId(cell.columnId);\n\n            if (!this.lookup.has(rowKey))\n                this.lookup.set(rowKey, new Set());\n\n            this.lookup.get(rowKey).add(columnKey);\n        });\n    }\n\n    isKeySelected(rowKey, columnKey) {\n        return this.lookup.has(rowKey) && this.lookup.get(rowKey).has(columnKey);\n    }\n\n    isIdSelected(rowId, columnId) {\n        return this.isKeySelected(stringifyId(rowId), stringifyId(columnId));\n    }\n}",
-        "import { useCallback, useRef } from \"react\";\n\nexport default function useChangeCallback(currentValue, callback, comparator) {\n    const ref = useRef({});\n\n    ref.current.value = currentValue;\n    ref.current.callback = callback;\n\n    return useCallback((value) => {\n        const newValue = typeof value === 'function'\n            ? value(ref.current.value) \n            : value;\n\n        const comparatorResult = ref.current.value === newValue || (comparator && comparator(ref.current.value, newValue));\n\n        if (!comparatorResult)\n        {\n            ref.current.value = newValue;\n            ref.current.callback(newValue);\n        }\n    }, [comparator]);\n}",
-        "import { useState, useEffect } from 'react';\n\nexport function roundToPixels(value, devicePixelRatio) {\n    return Math.round(value * devicePixelRatio) / devicePixelRatio;\n}\n\n// TODO: Test this hook\nexport default function useDevicePixelRatio() {\n    const [devicePixelRatio, setDevicePixelRatio] = useState(window.devicePixelRatio);\n\n    useEffect(() => {\n        const media = matchMedia(`(resolution: ${devicePixelRatio}dppx)`);\n        const updateDevicePixelRatio = () => {\n            console.log('Device pixel ratio changed');\n            setDevicePixelRatio(window.devicePixelRatio);\n        };\n\n        media.addEventListener('change', updateDevicePixelRatio, { once: true });\n\n        return () => media.removeEventListener('change', updateDevicePixelRatio);\n    }, [devicePixelRatio]);\n\n    return devicePixelRatio;\n}\n",
-        "import stringifyId from \"./stringifyId\";\n\n// TODO: write unit tests\nexport default class Edition {\n    constructor(editedCells) {\n        this.lookup = new Map();\n\n        editedCells.forEach(cell => {\n            const rowKey = stringifyId(cell.rowId);\n            const columnKey = stringifyId(cell.columnId);\n\n            if (!this.lookup.has(rowKey))\n                this.lookup.set(rowKey, new Map());\n\n            this.lookup.get(rowKey).set(columnKey, cell.value);\n        });\n    }\n\n    hasValueByKey(rowKey, columnKey) {\n        return this.lookup.has(rowKey) && this.lookup.get(rowKey).has(columnKey);\n    }\n\n    getValueByKey(rowKey, columnKey) {\n        if (!this.hasValueByKey(rowKey, columnKey))\n            return undefined;\n\n        return this.lookup.get(rowKey).get(columnKey);\n    }\n\n    hasValueById(rowId, columnId) {\n        return this.hasValueByKey(stringifyId(rowId), stringifyId(columnId));\n    }\n\n    getValueById(rowId, columnId) {\n        return this.getValueByKey(stringifyId(rowId), stringifyId(columnId));\n    }\n}",
-        "import stringifyId from \"./stringifyId\";\n\nconst borderTypes = ['borderTop', 'borderRight', 'borderBottom', 'borderLeft'];\n\n// TODO: Don't recreate styles if they haven't changed\nfunction indexBorders(style, index) {\n    const newStyle = { ...style };\n\n    if ('border' in newStyle) {\n        for (const borderType of borderTypes)\n            newStyle[borderType] = newStyle.border;\n        delete newStyle.border;\n    }\n\n    for (const borderType of borderTypes)\n        if (borderType in newStyle)\n            newStyle[borderType] = { ...newStyle[borderType], index };\n\n    return newStyle;\n}\n\nfunction mapFilter(filter) {\n    return {\n        by: {\n            type: filter.by.type,\n            key: stringifyId(filter.by.id)\n        },\n        condition: filter.condition\n    };\n}\n\nclass StyleGroup {\n    byKey = new Map();\n    byIndex = new Map(); // TODO: Should this be removed?\n    byMatch = new Map();\n};\n\nconst matchMapping = {\n    'HEADER': ['HEADER'],\n    'FILTER': ['FILTER'],\n    'DATA': ['DATA'],\n    'ANY': ['HEADER', 'DATA', 'FILTER'],\n    undefined: []\n};\n\n// TODO: Rename to FormatResolver\n// TODO: Optimize by not searching using keys that don't have correlated match rules\n// TODO: Accept both a function and an object as a style (where the object is a resolved style)\n// TODO: Consider removing index from the lookup\nexport default class FormattingRules {\n    constructor(rules) {\n        this.columnLookup = new StyleGroup();\n        this.rulesCount = 0;\n\n        for (const rule of rules)\n            this.addRule(rule);\n    }\n\n    addRule(rule) {\n        const columnLookup = this.columnLookup;\n        const index = this.rulesCount++;\n\n        const column = 'column' in rule\n            ? 'id' in rule.column\n                ? { key: stringifyId(rule.column.id) }\n                : rule.column\n            : { match: 'DATA' };\n        const row = 'row' in rule\n            ? 'id' in rule.row\n                ? { key: stringifyId(rule.row.id) }\n                : rule.row\n            : { match: 'DATA' };\n\n        const entry = {};\n        if ('condition' in rule)\n            entry.condition = rule.condition;\n        if ('style' in rule)\n            entry.style = typeof rule.style === 'function' ? rule.style : () => rule.style;\n        if ('value' in rule)\n            entry.value = typeof rule.value === 'function' ? rule.value : () => rule.value;\n        if ('text' in rule)\n            entry.text = typeof rule.text === 'function' ? rule.text : () => rule.text;\n        if ('edit' in rule)\n            entry.edit = rule.edit;\n        if ('draw' in rule)\n            entry.draw = rule.draw;\n        if ('filter' in rule)\n            entry.filter = mapFilter(rule.filter);\n\n        function addRowRule(lookup, key) {\n            if (!lookup.has(key))\n                lookup.set(key, []);\n\n            lookup.get(key).push({\n                index: index,\n                ...entry\n            });\n        }\n\n        function addColumnRule(lookup, key) {\n            if (!lookup.has(key))\n                lookup.set(key, new StyleGroup());\n\n            if ('key' in row)\n                addRowRule(lookup.get(key).byKey, row.key);\n            if ('index' in row)\n                addRowRule(lookup.get(key).byIndex, row.index);\n            for (const match of matchMapping[row.match])\n                addRowRule(lookup.get(key).byMatch, match);\n        }\n\n        if ('key' in column)\n            addColumnRule(columnLookup.byKey, column.key);\n        if ('index' in column)\n            addColumnRule(columnLookup.byIndex, column.index);\n        for (const match of matchMapping[column.match])\n            addColumnRule(columnLookup.byMatch, match);\n    }\n\n    resolve(data, rows, columns, row, column, edition, filtering) {\n        const columnLookup = this.columnLookup;\n\n        const rules = [];\n\n        function gatherRules(newRules) {\n            for (const rule of newRules)\n                rules.push(rule);\n        }\n\n        function gatherRowRules(lookup) {\n            if (lookup.byKey.has(row.key))\n                gatherRules(lookup.byKey.get(row.key));\n            if (lookup.byIndex.has(row.index))\n                gatherRules(lookup.byIndex.get(row.index));\n            if (lookup.byMatch.has(row.type))\n                gatherRules(lookup.byMatch.get(row.type));\n        }\n\n        if (columnLookup.byKey.has(column.key))\n            gatherRowRules(columnLookup.byKey.get(column.key));\n        if (columnLookup.byIndex.has(column.index))\n            gatherRowRules(columnLookup.byIndex.get(column.index));\n        if (columnLookup.byMatch.has(column.type))\n            gatherRowRules(columnLookup.byMatch.get(column.type));\n\n        rules.sort((a, b) => a.index - b.index);\n\n        let context = { data, rows, columns, row, column };\n        let style = {};\n        let draw = undefined;\n        let visible = true;\n\n        if (edition.hasValueByKey(row.key, column.key))\n            context = { ...context, newValue: edition.getValueByKey(row.key, column.key) };\n\n        for (const rule of rules) {\n            if ('condition' in rule && !rule.condition(context))\n                continue;\n\n            if ('value' in rule)\n                context = { ...context, value: rule.value(context) };\n            if ('style' in rule)\n                style = { ...style, ...indexBorders(rule.style(context), rule.index) };\n            if ('text' in rule)\n                context = { ...context, text: rule.text(context) };\n            if ('edit' in rule)\n                context = { ...context, edit: rule.edit };\n            if ('draw' in rule) {\n                const currentContext = context;\n                draw = (ctx) => rule.draw({ ...currentContext, ctx });\n            }\n            if ('filter' in rule && filtering.hasValueByKeyAndSelector(row.key, column.key, rule.filter.by)) {\n                const filterContext = { ...context, expression: filtering.getValueByKeyAndSelector(row.key, column.key, rule.filter.by) };\n                visible = visible && rule.filter.condition(filterContext);\n            }\n        }\n\n        const result = {\n            style,\n            visible\n        };\n\n        if ('value' in context)\n            result.value = context.value;\n        if ('edit' in context)\n            result.edit = context.edit;\n        if (draw !== undefined)\n            result.draw = draw;\n        if ('text' in context)\n            result.text = context.text;\n\n        return result;\n    }\n}",
-        "import stringifyId from \"./stringifyId\";\n\n// TODO: Extract the Edition class to a common base class\nexport default class Filtering {\n    constructor(filters) {\n        this.lookup = new Map();\n        this.filteredColumns = new Set();\n        this.filteredRows = new Set();\n\n        filters.forEach(cell => {\n            const rowKey = stringifyId(cell.rowId);\n            const columnKey = stringifyId(cell.columnId);\n\n            if (!this.lookup.has(rowKey))\n                this.lookup.set(rowKey, new Map());\n\n            this.lookup.get(rowKey).set(columnKey, cell.expression);\n            this.filteredColumns.add(columnKey);\n            this.filteredRows.add(rowKey);\n        });\n    }\n\n    hasRowFilters() {\n        return this.filteredRows.size > 0;\n    }\n\n    hasColumnFilters() {\n        return this.filteredColumns.size > 0;\n    }\n\n    hasRowFiltersByKey(rowKey) {\n        return this.filteredRows.has(rowKey);\n    }\n\n    hasColumnFiltersByKey(columnKey) {\n        return this.filteredColumns.has(columnKey);\n    }\n\n    hasValueByKey(rowKey, columnKey) {\n        return this.lookup.has(rowKey) && this.lookup.get(rowKey).has(columnKey);\n    }\n\n    getValueByKey(rowKey, columnKey) {\n        if (!this.hasValueByKey(rowKey, columnKey))\n            return undefined;\n\n        return this.lookup.get(rowKey).get(columnKey);\n    }\n\n    hasValueById(rowId, columnId) {\n        return this.hasValueByKey(stringifyId(rowId), stringifyId(columnId));\n    }\n\n    getValueById(rowId, columnId) {\n        return this.getValueByKey(stringifyId(rowId), stringifyId(columnId));\n    }\n\n    hasValueByKeyAndSelector(rowKey, columnKey, selector) {\n        if (selector.type === 'ROW')\n            return this.hasValueByKey(selector.key, columnKey);\n        if (selector.type === 'COLUMN')\n            return this.hasValueByKey(rowKey, selector.key);\n        return false;\n    }\n\n    getValueByKeyAndSelector(rowKey, columnKey, selector) {\n        if (selector.type === 'ROW')\n            return this.getValueByKey(selector.key, columnKey);\n        if (selector.type === 'COLUMN')\n            return this.getValueByKey(rowKey, selector.key);\n        return undefined;\n    }\n};",
-        "import Filtering from \"./Filtering\";\n\nexport default class FormatResolver {\n    constructor(formattingRules, data, rows, columns, edition) {\n        this.formattingRules = formattingRules;\n        this.data = data;\n        this.rows = rows;\n        this.columns = columns;\n        this.edition = edition;\n        this.filtering = new Filtering([]);\n    }\n\n    resolve(row, column) {\n        return this.formattingRules.resolve(\n            this.data,\n            this.rows,\n            this.columns,\n            row,\n            column,\n            this.edition,\n            this.filtering);\n    }\n}",
-        "import Edition from \"./Edition\";\n\nexport default class VisibilityResolver {\n    constructor(formattingRules, data, rows, columns, filtering) {\n        this.formattingRules = formattingRules;\n        this.data = data;\n        this.rows = rows;\n        this.columns = columns;\n        this.edition = new Edition([]);\n        this.filtering = filtering;\n    }\n\n    findVisibleColumns() {\n        if (!this.filtering.hasRowFilters())\n            return this.columns;\n\n        return this.columns.filter(column => {\n            return this.rows.every(row => {\n                if (!this.filtering.hasRowFiltersByKey(row.key))\n                    return true;\n\n                const cell = this.formattingRules.resolve(\n                    this.data,\n                    this.rows,\n                    this.columns,\n                    row,\n                    column,\n                    this.edition,\n                    this.filtering);\n\n                return cell.visible;\n            });\n        });\n    }\n\n    findVisibleRows() {\n        // TODO: don't include search columns in that check\n        if (!this.filtering.hasColumnFilters())\n            return this.rows;\n\n        return this.rows.filter(row => {\n            return this.columns.every(column => {\n                if (!this.filtering.hasColumnFiltersByKey(column.key))\n                    return true;\n\n                const cell = this.formattingRules.resolve(\n                    this.data,\n                    this.rows,\n                    this.columns,\n                    row,\n                    column,\n                    this.edition,\n                    this.filtering);\n\n                return cell.visible;\n            });\n        });\n    }\n}",
-        "import React, { createContext, useCallback, useEffect, useMemo } from \"react\";\nimport useInvoked from \"../hooks/useInvoked\";\nimport getRenderFormattingRules from \"../utils/getRenderFormattingRules\";\nimport Selection from \"../utils/Selection\";\nimport useChangeCallback from \"../hooks/useChangeCallback\";\nimport stringifyId from \"../utils/stringifyId\";\nimport getDataFormattingRules from \"../utils/getDataFormattingRules\";\nimport useDevicePixelRatio, { roundToPixels } from \"../hooks/useDevicePixelRatio\";\nimport getSections from \"../utils/getSections\";\nimport getInputFormattingRules from \"../utils/getInputFormattingRules\";\nimport Edition from \"../utils/Edition\";\nimport FormattingRules from \"../utils/FormattingRules\";\nimport FormatResolver from \"../utils/FormatResolver\";\nimport getVisibilityFormattingRules from \"../utils/getVisibilityFormattingRules\";\nimport Filtering from \"../utils/Filtering\";\nimport VisibilityResolver from \"../utils/VisibilityResolver\";\n\nfunction compareCells(oldCell, newCell) {\n    return stringifyId(oldCell) === stringifyId(newCell);\n}\n\nfunction compareSelectedCells(oldCells, newCells) {\n    if (oldCells.length !== newCells.length)\n        return false;\n\n    const selection = new Selection(oldCells);\n    return newCells.every(cell => selection.isIdSelected(cell.rowId, cell.columnId));\n}\n\nfunction compareEditedCells(oldCells, newCells) {\n    if (oldCells.length !== newCells.length)\n        return false;\n\n    const edition = new Edition(oldCells);\n    return newCells.every(cell => edition.getValueById(cell.rowId, cell.columnId) === cell.value);\n}\n\nfunction compareFilters(oldFilters, newFilters) {\n    if (oldFilters.length !== newFilters.length)\n        return false;\n\n    const filtering = new Filtering(oldFilters);\n    return newFilters.every(filter => filtering.getValueById(filter.rowId, filter.columnId) === filter.value);\n\n}\n\nfunction getPinned(index, length, pinnedBegin, pinnedEnd) {\n    if (index < pinnedBegin)\n        return \"BEGIN\";\n    if (index >= length - pinnedEnd)\n        return \"END\";\n    return undefined;\n}\n\nfunction useResolvedColumnsOrRows(elements, pinnedBegin, pinnedEnd) {\n    return useMemo(() => {\n        return elements.map((element, index) => {\n            return {\n                ...element,\n                type: element.type || \"DATA\",\n                index: index,\n                key: stringifyId(element.id),\n                pinned: getPinned(index, elements.length, pinnedBegin, pinnedEnd)\n            }\n        });\n    }, [elements, pinnedBegin, pinnedEnd]);\n}\n\nfunction usePlacedColumns(columns, devicePixelRatio, borderWidth) {\n    return useMemo(() => {\n        let left = borderWidth;\n\n        return columns.map((column, index) => {\n            const width = roundToPixels(column.width, devicePixelRatio);\n            const newColumn = {\n                ...column,\n                index: index,\n                width: width,\n                leftWithBorder: left - borderWidth,\n                left: left,\n                right: left + width,\n                rightWithBorder: left + width + borderWidth\n            }\n\n            left += newColumn.width + borderWidth;\n\n            return newColumn;\n        });\n    }, [borderWidth, columns, devicePixelRatio]);\n}\n\nfunction usePlacedRows(rows, devicePixelRatio, borderWidth) {\n    return useMemo(() => {\n        let top = borderWidth;\n\n        return rows.map((row, index) => {\n            const height = roundToPixels(row.height, devicePixelRatio);\n            const newRow = {\n                ...row,\n                index: index,\n                height: height,\n                topWithBorder: top - borderWidth,\n                top: top,\n                bottom: top + height,\n                bottomWithBorder: top + height + borderWidth\n            }\n\n            top += newRow.height + borderWidth;\n\n            return newRow;\n        });\n    }, [borderWidth, rows, devicePixelRatio]);\n}\n\nfunction useFormatResolver(dataFormatting, data, rows, columns, edition) {\n    const formattingRules = useMemo(() => new FormattingRules(dataFormatting), [dataFormatting]);\n    const formatResolver = useMemo(() => new FormatResolver(formattingRules, data, rows, columns, edition), [formattingRules, data, columns, rows, edition]);\n\n    return formatResolver;\n}\n\nfunction useVisibilityResolver(dataFormatting, data, rows, columns, filters) {\n    const formattingRules = useMemo(() => new FormattingRules(dataFormatting), [dataFormatting]);\n    const formatResolver = useMemo(() => new VisibilityResolver(formattingRules, data, rows, columns, filters), [formattingRules, data, columns, rows, filters]);\n\n    return formatResolver;\n}\n\nconst DataContext = createContext();\nconst ColumnsAndRowsContext = createContext();\nconst InteractionsContext = createContext();\nconst RenderingContext = createContext();\nconst SizeContext = createContext();\n\nexport function StateProvider(props) {\n    const devicePixelRatio = useDevicePixelRatio();\n    const borderWidth = props.borderWidth / devicePixelRatio;\n    const data = props.data;\n    const dataFormatting = useMemo(() => getDataFormattingRules(props.formatting, props.dataSelector), [props.formatting, props.dataSelector]);\n    const editedCellsAndFilters = useMemo(() => [...props.editedCells, ...props.filters.map(filter => ({ columnId: filter.columnId, rowId: filter.rowId, value: filter.expression }))], [props.editedCells, props.filters]);\n    const edition = useMemo(() => new Edition(editedCellsAndFilters), [editedCellsAndFilters]);\n    const filters = useMemo(() => new Filtering(props.filters), [props.filters]);\n    const unfilteredColumns = useResolvedColumnsOrRows(useInvoked(props.columns, [data]), props.pinnedLeft, props.pinnedRight); // TODO: Throw on duplicate ids\n    const unfilteredRows = useResolvedColumnsOrRows(useInvoked(props.rows, [data]), props.pinnedTop, props.pinnedBottom);\n    const visibilityFormatting = useMemo(() => getVisibilityFormattingRules(dataFormatting), [dataFormatting]);\n    const visibilityResolver = useVisibilityResolver(visibilityFormatting, data, unfilteredRows, unfilteredColumns, filters);\n    const filteredColumns = useMemo(() => visibilityResolver.findVisibleColumns(), [visibilityResolver]);\n    const filteredRows = useMemo(() => visibilityResolver.findVisibleRows(), [visibilityResolver]);\n    const columns = usePlacedColumns(filteredColumns, devicePixelRatio, borderWidth);\n    const rows = usePlacedRows(filteredRows, devicePixelRatio, borderWidth);\n    const sections = useMemo(() => getSections(columns, rows), [columns, rows]);\n    const selectedCells = props.selectedCells;\n    const selection = useMemo(() => new Selection(props.selectedCells), [props.selectedCells]);\n    const highlight = useMemo(() => new Selection(props.highlightedCells), [props.highlightedCells]);\n    const hoveredCell = props.hoveredCell;\n    const focusedCell = props.focusedCell;\n    // TODO: addDataFormattingRules and addRenderFormattingRules should remove unnecessary rules\n    const renderFormatting = useMemo(() => getRenderFormattingRules(dataFormatting, hoveredCell, focusedCell, selection, highlight, edition), [dataFormatting, hoveredCell, focusedCell, selection, highlight, edition]);\n    const renderFormatResolver = useFormatResolver(renderFormatting, data, rows, columns, edition);\n    const inputFormatting = useMemo(() => getInputFormattingRules(dataFormatting), [dataFormatting]);\n    const inputFormatResolver = useFormatResolver(inputFormatting, data, rows, columns, edition);\n    const fixedSize = useMemo(() => ({\n        top: sections.top.height,\n        bottom: sections.bottom.height,\n        left: sections.left.width,\n        right: sections.right.width\n    }), [sections.top.height, sections.bottom.height, sections.left.width, sections.right.width]);\n    const totalSize = useMemo(() => ({\n        width: columns.length ? columns.at(-1).rightWithBorder : 0,\n        height: rows.length ? rows.at(-1).bottomWithBorder : 0\n    }), [columns, rows]);\n\n    const setSelectedCells = useChangeCallback(props.selectedCells, props.onSelectedCellsChange, compareSelectedCells);\n    const setHighlightedCells = useChangeCallback(props.highlightedCells, props.onHighlightedCellsChange, compareSelectedCells);\n    const setEditedCells = useChangeCallback(props.editedCells, props.onEditedCellsChange, compareEditedCells);\n    const setHoveredCell = useChangeCallback(props.hoveredCell, props.onHoveredCellChange, compareCells);\n    const setFocusedCell = useChangeCallback(props.focusedCell, props.onFocusedCellChange, compareCells);\n    const setFilters = useChangeCallback(props.filters, props.onFiltersChange, compareFilters);\n    const addSelectedCells = useCallback(cells => setSelectedCells(oldSelectedCells => { // TODO: Should the selected cells include info about the section?\n        const selection = new Selection(cells);\n        return [...cells, ...oldSelectedCells.filter(cell => !selection.isIdSelected(cell.rowId, cell.columnId))];\n    }), [setSelectedCells]);\n    const addEditedCells = useCallback(cells => setEditedCells(oldEditedCells => {\n        const edition = new Edition(cells);\n        return [...cells, ...oldEditedCells.filter(cell => !edition.hasValueById(cell.rowId, cell.columnId))];\n    }), [setEditedCells]);\n    const addFilters = useCallback(filters => setFilters(oldFilters => {\n        const filtering = new Filtering(filters);\n        return [...filters, ...oldFilters.filter(filter => !filtering.hasValueById(filter.rowId, filter.columnId))];\n    }), [setFilters]);\n    const removeEditedCells = useCallback(cells => setEditedCells(oldEditedCells => {\n        const selection = new Selection(cells);\n        return oldEditedCells.filter(cell => !selection.isIdSelected(cell.rowId, cell.columnId));\n    }), [setEditedCells]);\n    const removeFilters = useCallback(cells => setFilters(oldFilters => {\n        const selection = new Selection(cells);\n        return oldFilters.filter(filter => !selection.isIdSelected(filter.rowId, filter.columnId));\n    }), [setFilters]);\n\n    useEffect(() => { console.log(props.selectedCells) }, [props.selectedCells]);\n\n    const contexts = [\n        [DataContext, useMemo(() => ({\n            data\n        }), [data])],\n        [ColumnsAndRowsContext, useMemo(() => ({\n            columns, rows, sections\n        }), [columns, rows, sections])],\n        [InteractionsContext, useMemo(() => ({\n            selectedCells, selection, hoveredCell, focusedCell, inputFormatResolver, setSelectedCells, setHighlightedCells, setHoveredCell, setEditedCells, setFocusedCell, addSelectedCells, addEditedCells, addFilters, removeEditedCells, removeFilters\n        }), [selectedCells, selection, hoveredCell, focusedCell, inputFormatResolver, setSelectedCells, setHighlightedCells, setHoveredCell, setEditedCells, setFocusedCell, addSelectedCells, addEditedCells, addFilters, removeEditedCells, removeFilters])],\n        [RenderingContext, useMemo(() => ({\n            renderFormatResolver\n        }), [renderFormatResolver])],\n        [SizeContext, useMemo(() => ({\n            fixedSize, totalSize, borderWidth\n        }), [fixedSize, totalSize, borderWidth])]\n    ];\n\n    return contexts.reduce((children, [Context, value]) => (\n        <Context.Provider value={value}>\n            {children}\n        </Context.Provider>\n    ), props.children);\n}\n\n// TODO: see if calling the useContext hook multiple times is a performance issue\nexport const useData = () => React.useContext(DataContext).data;\nexport const useColumns = () => React.useContext(ColumnsAndRowsContext).columns;\nexport const useRows = () => React.useContext(ColumnsAndRowsContext).rows;\nexport const useSections = () => React.useContext(ColumnsAndRowsContext).sections;\nexport const useSelectedCells = () => React.useContext(InteractionsContext).selectedCells;\nexport const useSelection = () => React.useContext(InteractionsContext).selection;\nexport const useHoveredCell = () => React.useContext(InteractionsContext).hoveredCell;\nexport const useFocusedCell = () => React.useContext(InteractionsContext).focusedCell;\nexport const useRenderFormatResolver = () => React.useContext(RenderingContext).renderFormatResolver;\nexport const useInputFormatResolver = () => React.useContext(InteractionsContext).inputFormatResolver;\nexport const useSetSelectedCells = () => React.useContext(InteractionsContext).setSelectedCells;\nexport const useSetHighlightedCells = () => React.useContext(InteractionsContext).setHighlightedCells;\nexport const useSetEditedCells = () => React.useContext(InteractionsContext).setEditedCells;\nexport const useSetHoveredCell = () => React.useContext(InteractionsContext).setHoveredCell;\nexport const useSetFocusedCell = () => React.useContext(InteractionsContext).setFocusedCell;\nexport const useAddSelectedCells = () => React.useContext(InteractionsContext).addSelectedCells;\nexport const useAddEditedCells = () => React.useContext(InteractionsContext).addEditedCells;\nexport const useAddFilters = () => React.useContext(InteractionsContext).addFilters;\nexport const useRemoveEditedCells = () => React.useContext(InteractionsContext).removeEditedCells;\nexport const useRemoveFilters = () => React.useContext(InteractionsContext).removeFilters;\nexport const useFixedSize = () => React.useContext(SizeContext).fixedSize;\nexport const useTotalSize = () => React.useContext(SizeContext).totalSize;\nexport const useBorderWidth = () => React.useContext(SizeContext).borderWidth;",
-        "export default function getDataFormattingRules(formatting, dataSelector) {\n    return [\n        {\n            column: { match: 'ANY' },\n            row: { match: 'HEADER' },\n            value: ({column}) => column.header\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'FILTER' },\n            value: ({newValue}) => newValue || '',\n            text: ({newValue}) => newValue || 'Search...',\n            edit: {\n                validate: () => true,\n                parse: ({ string }) => string,\n            },\n        },\n        {\n            column: { match: 'DATA' },\n            row: { match: 'DATA' },\n            value: dataSelector\n        },\n        ...formatting\n    ];\n}",
+        "export default function getCellType(column, row) {\n    if (column.type === 'FILTER' ^ row.type === 'FILTER')\n        return 'FILTER';\n    if (column.type === 'DATA' && row.type === 'DATA')\n        return 'DATA';\n    return 'OTHER';\n}",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\nimport getCellType from \"./getCellType.js\";\n\nexport default function getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup) {\n    return selectedCells.map(cell => {\n        const columnKey = stringifyId(cell.columnId);\n        const rowKey = stringifyId(cell.rowId);\n\n        if (!columnLookup.has(columnKey))\n            return null;\n        if (!rowLookup.has(rowKey))\n            return null;\n\n        const column = columnLookup.get(columnKey);\n        const row = rowLookup.get(rowKey);\n\n        return {\n            edit: formatResolver.resolve(row, column).edit,\n            cell: cell,\n            type: getCellType(column, row)\n        }\n    }).filter(cell => cell?.edit);\n}",
+        "const defaultFont = '12px Calibri';\nconst defaultPadding = { top: 2, right: 5, bottom: 2, left: 5 };\n\nexport { defaultFont, defaultPadding };",
+        "export default function roundToPixels(value, devicePixelRatio) {\n    return Math.round(value * devicePixelRatio) / devicePixelRatio;\n}",
+        "import { defaultFont } from \"../core-utils/defaults.js\";\nimport roundToPixels from \"../core-utils/roundToPixels.js\";\n\nfunction renderSection(context, vertical, horizontal) {\n    const state = context.state;\n    const canvas = context.canvases[`${vertical}-${horizontal}`];\n    const verticalSection = state.sections[vertical];\n    const horizontalSection = state.sections[horizontal];\n    const columns = horizontalSection.columns;\n    const rows = verticalSection.rows;\n\n    if (rows.length === 0 || columns.length === 0) {\n        if (canvas.parentElement)\n            canvas.parentElement.removeChild(canvas);\n        return;\n    }\n\n    if (!canvas.parentElement)\n        context.element.appendChild(canvas);\n\n    // Checking how often this is called\n    console.log('draw');\n\n    // TODO: Borders are still blurry after scrolling at high zoom-out levels\n\n    const ctx = canvas.getContext(\"2d\", { alpha: false });\n    // TODO: Make that \"1\" configurable as cell spacing\n    const scrollRect = state.scrollRect;\n    const textResolver = state.textResolver;\n    // TODO: Make sure those formatters are split based on the rule areas\n    const formatResolver = state.renderFormatResolver;\n    const borderWidth = state.borderWidth;\n    const sectionBorders = {\n        top: verticalSection.showTopBorder,\n        bottom: verticalSection.showBottomBorder,\n        left: horizontalSection.showLeftBorder,\n        right: horizontalSection.showRightBorder\n    };\n    const borderOffset = borderWidth / 2;\n    const rowCount = rows.length;\n    const columnCount = columns.length;\n    const horizontalBorderCount = rowCount - 1 + (sectionBorders.top ? 1 : 0) + (sectionBorders.bottom ? 1 : 0);\n    const verticalBorderCount = columnCount - 1 + (sectionBorders.left ? 1 : 0) + (sectionBorders.right ? 1 : 0);\n    const rowHeights = rows.map(row => row.height);\n    const columnWidths = columns.map(column => column.width);\n    const totalWidth = columnWidths.reduce((a, b) => a + b, 0) + verticalBorderCount * borderWidth;\n    const totalHeight = rowHeights.reduce((a, b) => a + b, 0) + horizontalBorderCount * borderWidth;\n\n    const left = horizontal === 'center'\n        ? scrollRect.left\n        : 0;\n    const top = vertical === 'middle'\n        ? scrollRect.top\n        : 0;\n    const width = horizontal === 'center'\n        ? scrollRect.width\n        : horizontalSection.width;\n    const height = vertical === 'middle'\n        ? scrollRect.height\n        : verticalSection.height;\n\n    // TODO: Move somewhere else\n    const horizontalOffsets = columnWidths.reduce((acc, width, index) => {\n        const prevOffset = acc[index];\n        const offset = prevOffset + width + borderWidth;\n        acc.push(offset);\n        return acc;\n    }, [sectionBorders.left ? borderWidth : 0]);\n    const verticalOffsets = rowHeights.reduce((acc, height, index) => {\n        const prevOffset = acc[index];\n        const offset = prevOffset + height + borderWidth;\n        acc.push(offset);\n        return acc;\n    }, [sectionBorders.top ? borderWidth : 0]);\n\n    const columnOffsets = horizontalOffsets.slice(0, -1);\n    const rowOffsets = verticalOffsets.slice(0, -1);\n\n    const minVisibleColumnIndex = Math.max(columnOffsets.findLastIndex(offset => offset <= left), 0);\n    const maxVisibleColumnIndex = columnOffsets.findLastIndex(offset => offset <= left + width);\n    const minVisibleRowIndex = Math.max(rowOffsets.findLastIndex(offset => offset <= top), 0);\n    const maxVisibleRowIndex = rowOffsets.findLastIndex(offset => offset <= top + height);\n\n    const minVisibleVerticalBorderIndex = Math.max(minVisibleColumnIndex, sectionBorders.left ? 0 : 1);\n    const maxVisibleVerticalBorderIndex = maxVisibleColumnIndex + (sectionBorders.right ? 1 : 0);\n    const minVisibleHorizontalBorderIndex = Math.max(minVisibleRowIndex, sectionBorders.top ? 0 : 1);\n    const maxVisibleHorizontalBorderIndex = maxVisibleRowIndex + (sectionBorders.bottom ? 1 : 0);\n\n    const cells = Array.from({ length: maxVisibleRowIndex - minVisibleRowIndex + 1 }, (_, rowIndex) => {\n        const row = rows[rowIndex + minVisibleRowIndex];\n        return Array.from({ length: maxVisibleColumnIndex - minVisibleColumnIndex + 1 }, (_, columnIndex) => {\n            const column = columns[columnIndex + minVisibleColumnIndex];\n            return formatResolver.resolve(row, column);\n        });\n    });\n    const getCell = (rowIndex, columnIndex) => cells[rowIndex - minVisibleRowIndex][columnIndex - minVisibleColumnIndex];\n\n    canvas.width = Math.round(width * devicePixelRatio);\n    canvas.height = Math.round(height * devicePixelRatio);\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n    canvas.style.marginLeft = `${left}px`;\n    canvas.style.marginTop = `${top}px`;\n    canvas.style.marginRight = `${totalWidth - width - left}px`;\n    canvas.style.marginBottom = `${totalHeight - height - top}px`;;\n\n    ctx.fillStyle = \"#E9E9E9\";\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    const setTransform = (x, y) => {\n        ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, (x - left) * devicePixelRatio, (y - top) * devicePixelRatio);\n    };\n    const setClip = (x, y, width, height) => {\n        ctx.beginPath();\n        ctx.rect(x, y, width, height);\n        ctx.clip();\n    };\n\n    // Draw cells\n    for (let columnIndex = minVisibleColumnIndex; columnIndex <= maxVisibleColumnIndex; columnIndex++) {\n        ctx.save();\n        setTransform(horizontalOffsets[columnIndex], 0);\n        setClip(0, 0, columnWidths[columnIndex], totalHeight);\n\n        for (let rowIndex = minVisibleRowIndex; rowIndex <= maxVisibleRowIndex; rowIndex++) {\n            const cell = getCell(rowIndex, columnIndex);\n            const style = cell.style;\n            const cellTop = verticalOffsets[rowIndex];\n            const cellLeft = horizontalOffsets[columnIndex];\n            const cellWidth = columnWidths[columnIndex];\n            const cellHeight = rowHeights[rowIndex];\n            const text = cell.text;\n            const textAlign = style.textAlign || 'left';\n            const textBaseline = style.textBaseline || 'middle';\n            const padding = cell.padding;\n\n            setTransform(cellLeft, cellTop);\n\n            ctx.fillStyle = style.background || 'white';\n            ctx.fillRect(0, 0, cellWidth, cellHeight);\n\n            if ('draw' in cell)\n                cell.draw(ctx);\n\n            if (style.highlight) {\n                ctx.fillStyle = style.highlight;\n                ctx.fillRect(0, 0, cellWidth, cellHeight);\n            }\n\n            if (style.corner) {\n                ctx.fillStyle = style.corner;\n                ctx.beginPath();\n                ctx.moveTo(cellWidth - 7, cellHeight);\n                ctx.lineTo(cellWidth, cellHeight);\n                ctx.lineTo(cellWidth, cellHeight - 7);\n                ctx.fill();\n            }\n\n            ctx.fillStyle = style.foreground || 'black';\n            ctx.font = style.font || defaultFont;\n            ctx.textAlign = textAlign;\n\n            const fontMetrics = textResolver.getFontMetrics(style.font);\n\n            // TODO: Make sure that values are rounded using devicePixelRatio\n            const textX = roundToPixels(\n                textAlign === 'left' ? padding.left :\n                    textAlign === 'center' ? cellWidth / 2 :\n                        textAlign === 'right' ? cellWidth - padding.right :\n                            0,\n                devicePixelRatio\n            );\n\n            const textY = roundToPixels(\n                textBaseline === 'top' ? fontMetrics.middle + fontMetrics.topOffset + padding.top :\n                    textBaseline === 'middle' ? cellHeight / 2 + fontMetrics.middle :\n                        textBaseline === 'bottom' ? cellHeight + fontMetrics.middle - fontMetrics.bottomOffset - padding.bottom :\n                            0,\n                devicePixelRatio\n            );\n\n            const fitsVertically = textY - fontMetrics.middle - fontMetrics.topOffset >= 0 && textY - fontMetrics.middle + fontMetrics.bottomOffset <= cellHeight;\n\n            if (fitsVertically) {\n                ctx.fillText(text, textX, textY);\n            }\n            else {\n                // TODO: Clip if the text is too high (and draw some indicator if you do)\n                ctx.strokeStyle = '#E9E9E9';\n                ctx.lineWidth = borderWidth;\n\n                ctx.beginPath();\n                ctx.moveTo(0, borderWidth + borderOffset);\n                ctx.lineTo(cellWidth, borderWidth + borderOffset);\n                ctx.moveTo(0, cellHeight - borderWidth - borderOffset);\n                ctx.lineTo(cellWidth, cellHeight - borderWidth - borderOffset);\n                ctx.stroke();\n\n                ctx.save();\n                setClip(0, 2 * borderWidth, cellWidth, cellHeight - 4 * borderWidth);\n\n                ctx.fillText(text, textX, textY);\n\n                ctx.restore();\n            }\n        }\n\n        ctx.restore();\n    }\n\n    setTransform(0, 0);\n\n    // Draw borders\n\n    // TODO: clip drawing area to the middle of neighboring columns/rows (might be useful for redrawing only the changed cells)\n    // TODO: move somewhere (?)\n    const drawBorder = (x1, y1, x2, y2, style) => {\n        if (!style)\n            return;\n\n        const width = style.width * borderWidth;\n\n        const isHorizontal = y1 === y2;\n\n        // TODO: Don't add offset if the border is not continued\n        const xa = x1 - (isHorizontal ? width / 2 : 0);\n        const ya = y1 - (!isHorizontal ? width / 2 : 0);\n        const xb = x2 + (isHorizontal ? width / 2 : 0);\n        const yb = y2 + (!isHorizontal ? width / 2 : 0);\n\n        ctx.strokeStyle = style.color || 'black'; // TODO: resolve this color earlier\n        ctx.lineWidth = width;\n\n        if (style.dash) {\n            ctx.setLineDash(style.dash.map(value => value / devicePixelRatio));\n            ctx.lineDashOffset = (isHorizontal ? xa : ya);\n        }\n        else {\n            ctx.setLineDash([]);\n        }\n\n        ctx.beginPath();\n        ctx.moveTo(xa, ya);\n        ctx.lineTo(xb, yb);\n        ctx.stroke();\n    }\n\n    const selectBorder = (borderStyleA, borderStyleB) => {\n        if (!borderStyleA)\n            return borderStyleB;\n\n        if (!borderStyleB)\n            return borderStyleA;\n\n        if (borderStyleA.index > borderStyleB.index)\n            return borderStyleA;\n\n        return borderStyleB;\n    }\n\n    // TODO: Move somewhere else (?)\n    for (let horizontalBorderIndex = minVisibleHorizontalBorderIndex; horizontalBorderIndex <= maxVisibleHorizontalBorderIndex; horizontalBorderIndex++) {\n        const topRowIndex = horizontalBorderIndex - 1;\n        const bottomRowIndex = horizontalBorderIndex;\n\n        for (let columnIndex = minVisibleColumnIndex; columnIndex <= maxVisibleColumnIndex; columnIndex++) {\n            const topBorderStyle = topRowIndex >= minVisibleRowIndex ? getCell(topRowIndex, columnIndex).style.borderBottom : null;\n            const bottomBorderStyle = bottomRowIndex <= maxVisibleRowIndex ? getCell(bottomRowIndex, columnIndex).style.borderTop : null;\n\n            const borderStyle = selectBorder(topBorderStyle, bottomBorderStyle);\n\n            drawBorder(\n                horizontalOffsets[columnIndex] - borderOffset,\n                verticalOffsets[bottomRowIndex] - borderOffset,\n                horizontalOffsets[columnIndex + 1] - borderOffset,\n                verticalOffsets[bottomRowIndex] - borderOffset,\n                borderStyle);\n        }\n    }\n\n    for (let verticalBorderIndex = minVisibleVerticalBorderIndex; verticalBorderIndex <= maxVisibleVerticalBorderIndex; verticalBorderIndex++) {\n        const leftColumnIndex = verticalBorderIndex - 1;\n        const rightColumnIndex = verticalBorderIndex;\n\n        for (let rowIndex = minVisibleRowIndex; rowIndex <= maxVisibleRowIndex; rowIndex++) {\n            const leftBorderStyle = leftColumnIndex >= minVisibleColumnIndex ? getCell(rowIndex, leftColumnIndex).style.borderRight : null;\n            const rightBorderStyle = rightColumnIndex <= maxVisibleColumnIndex ? getCell(rowIndex, rightColumnIndex).style.borderLeft : null;\n\n            const borderStyle = selectBorder(leftBorderStyle, rightBorderStyle);\n\n            drawBorder(\n                horizontalOffsets[rightColumnIndex] - borderOffset,\n                verticalOffsets[rowIndex] - borderOffset,\n                horizontalOffsets[rightColumnIndex] - borderOffset,\n                verticalOffsets[rowIndex + 1] - borderOffset,\n                borderStyle);\n        }\n    }\n}\n\nfunction renderInput(context) {\n    const element = context.element;\n    const input = context.input;\n    const state = context.state;\n    const inputPlacement = state.inputPlacement;\n\n    if (!inputPlacement) {\n        if (input.parentElement) {\n            const hasFocus = document.activeElement === input;\n            input.parentElement.removeChild(input);\n            if (hasFocus)\n                element.focus();\n        }\n        return;\n    }\n\n    if (!input.parentElement) {\n        const hasFocus = document.activeElement === element;\n        context.element.appendChild(input);\n        if (hasFocus)\n            input.focus();\n    }\n\n    input.style.left = `${inputPlacement.left}px`;\n    input.style.top = `${inputPlacement.top}px`;\n    input.style.width = `${inputPlacement.width}px`;\n    input.style.height = `${inputPlacement.height}px`;\n\n    input.style.backgroundColor = state.isTextValid ? 'white' : '#eb3434';\n}\n\nfunction renderCursor(context) {\n    const element = context.element;\n    const state = context.state;\n\n    if (state.resizableColumn && state.resizableRow)\n        element.style.cursor = 'nwse-resize';\n    else if (state.resizableColumn)\n        element.style.cursor = 'col-resize';\n    else if (state.resizableRow)\n        element.style.cursor = 'row-resize';\n    else\n        element.style.cursor = 'default';\n}\n\nfunction renderInternal(context) {\n    renderSection(context, 'top', 'left');\n    renderSection(context, 'top', 'center');\n    renderSection(context, 'top', 'right');\n    renderSection(context, 'middle', 'left');\n    renderSection(context, 'middle', 'center');\n    renderSection(context, 'middle', 'right');\n    renderSection(context, 'bottom', 'left');\n    renderSection(context, 'bottom', 'center');\n    renderSection(context, 'bottom', 'right');\n\n    renderInput(context);\n    renderCursor(context);\n}\n\nfunction renderError(context) {\n    const element = context.element;\n    const error = context.error;\n\n    element.style.backgroundColor = '#9f0000';\n    element.style.color = 'white';\n    element.style.padding = '20px';\n    element.style.display = 'flex';\n    element.style.flexDirection = 'column';\n    element.innerHTML = `\n        <div style=\"font-size: 16px;\">\n            An error occurred while rendering the grid, please contact the support.\n        </div>\n        <div style=\"font-size: 20px; font-weight: bold; padding: 20px 0;\">\n            ${error.message}\n        </div>\n        <div style=\"font-size: 16px; white-space: pre-wrap;\">${error.stack}</div>\n    `;\n}\n\nexport default function render(context) {\n    if (!context.error) {\n        try {\n            renderInternal(context);\n        }\n        catch (error) {\n            context.error = error;\n        }\n    }\n\n    if (context.error)\n        renderError(context);\n}",
+        "export default function getDataFormatting(formatting, dataSelector, sortBy) {\n    return [\n        {\n            column: { match: 'DATA' },\n            row: { match: 'HEADER' },\n            value: ({ column }) => column.header === undefined ? column.id : column.header\n        },\n        {\n            column: { match: 'HEADER' },\n            row: { match: 'DATA' },\n            value: ({ row }) => row.header === undefined ? row.id : row.header\n        },\n        {\n            column: { match: 'HEADER' },\n            row: { match: 'SPECIAL' },\n            value: ''\n        },\n        {\n            column: { match: 'SPECIAL' },\n            row: { match: 'HEADER' },\n            value: ''\n        },\n        ...sortBy.map(({ columnId, rowId, direction }, index) => ({\n            column: { id: columnId },\n            row: { id: rowId },\n            text: ({ column }) => `${sortBy.length > 1 ? index + 1 : ''}${direction === 'ASC' ? '\u21e3' : '\u21e1'} ${column.header}`\n        })),\n        {\n            column: { match: 'ANY' },\n            row: { match: 'FILTER' },\n            value: ({ newValue }) => newValue || '',\n            text: ({ newValue }) => newValue || 'Search...', // TODO: Move to render formatting?\n            edit: {\n                validate: () => true,\n                parse: ({ string }) => string,\n                autoCommit: true\n            },\n        },\n        {\n            column: { match: 'DATA' },\n            row: { match: 'DATA' },\n            value: dataSelector\n        },\n        ...formatting\n    ];\n}",
+        "export default function getInputFormatting(formatting) {\n    return formatting;\n}",
+        "import stringifyId from '../core-utils/stringifyId.js';\n\nfunction getHighlightColor(baseColor, isStrong) {\n    if (isStrong)\n        return baseColor + '99';\n    else\n        return baseColor + '33';\n}\n\nexport default function getRenderFormatting(formatting, hoveredCell, focusedCell, selection, highlight, edition, resizableColumn, resizableRow) {\n    const focusedColumnKey = focusedCell ? stringifyId(focusedCell.columnId) : null;\n    const focusedRowKey = focusedCell ? stringifyId(focusedCell.rowId) : null;\n    const isResizingColumn = resizableColumn !== null;\n    const isResizingRow = resizableRow !== null;\n    const isResizing = isResizingColumn || isResizingRow;\n\n    const isSelected = (rows, columns, rowIndex, columnIndex) => {\n        if (rowIndex < 0 || rowIndex >= rows.length)\n            return false;\n        if (columnIndex < 0 || columnIndex >= columns.length)\n            return false;\n\n        const rowKey = rows[rowIndex].key;\n        const columnKey = columns[columnIndex].key;\n\n        return selection.isKeySelected(rowKey, columnKey);\n    };\n\n    const optional = (condition, style) => {\n        if (condition)\n            return [style];\n        else\n            return [];\n    }\n\n    return [\n        {\n            column: { match: 'ANY' },\n            row: { match: 'FILTER' },\n            style: ({ newValue }) => ({ background: '#FBFBFB', foreground: newValue ? 'black' : '#cccccc', border: { width: 1, color: 'gray' } })\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'HEADER' },\n            style: { background: '#F5F5F5', border: { width: 1, color: 'gray' } }\n        },\n        {\n            column: { match: 'HEADER' },\n            row: { match: 'ANY' },\n            style: { background: '#F5F5F5', border: { width: 1, color: 'gray' } }\n        },\n        {\n            column: { match: 'HEADER' },\n            row: { match: 'HEADER' },\n            style: { background: '#E0E0E0' }\n        },\n        ...formatting,\n        ...optional(hoveredCell && !isResizingColumn, {\n            column: { id: hoveredCell?.columnId },\n            row: { match: 'ANY' },\n            style: { highlight: '#81948133' },\n        }),\n        ...optional(hoveredCell && !isResizingRow, {\n            column: { match: 'ANY' },\n            row: { id: hoveredCell?.rowId },\n            style: { highlight: '#81948133' },\n        }),\n        ...optional(hoveredCell && !isResizing, {\n            column: { id: hoveredCell?.columnId },\n            row: { id: hoveredCell?.rowId },\n            style: { highlight: '#81948188' },\n        }),\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ rows, columns, row, column }) => isSelected(rows, columns, row.index, column.index),\n            style: ({ rows, columns, row, column, edit }) => ({\n                ...(!isSelected(rows, columns, row.index - 1, column.index) ? { borderTop: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index + 1, column.index) ? { borderBottom: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index, column.index - 1) ? { borderLeft: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                ...(!isSelected(rows, columns, row.index, column.index + 1) ? { borderRight: { width: 3, color: '#596959', index: Number.MAX_SAFE_INTEGER } } : {}),\n                highlight: getHighlightColor(edit ? '#798d9c' : '#819481', focusedColumnKey !== column.key || focusedRowKey !== row.key)\n            }),\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => highlight.isKeySelected(row.key, column.key),\n            style: ({ row, column }) => ({\n                highlight: getHighlightColor('#93a8b8', focusedColumnKey !== column.key || focusedRowKey !== row.key)\n            })\n        },\n        ...optional(focusedCell, {\n            column: { id: focusedCell?.columnId },\n            row: { id: focusedCell?.rowId },\n            style: { highlight: '#ffffffaa' }\n        }),\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ edit }) => edit,\n            style: { corner: '#77777720' },\n        },\n        {\n            column: { match: 'ANY' },\n            row: { match: 'ANY' },\n            condition: ({ row, column }) => edition.hasValueByKey(row.key, column.key),\n            style: { corner: 'darkgreen' },\n        },\n        ...optional(resizableColumn, {\n            column: { id: resizableColumn },\n            row: { match: 'HEADER' },\n            style: { borderRight: { width: 5, color: 'cornflowerblue' } }\n        }),\n        ...optional(resizableRow, {\n            column: { match: 'HEADER' },\n            row: { id: resizableRow },\n            style: { borderBottom: { width: 5, color: 'cornflowerblue' } }\n        }),\n    ];\n}",
         "export default function getSections(columns, rows) {\n    const topLength = rows.filter(row => row.pinned === 'BEGIN').length; // TODO: optimize\n    const bottomLength = rows.filter(row => row.pinned === 'END').length;\n    const middleLength = rows.length - topLength - bottomLength;\n    const leftLength = columns.filter(column => column.pinned === 'BEGIN').length;\n    const rightLength = columns.filter(column => column.pinned === 'END').length;\n    const centerLength = columns.length - leftLength - rightLength;\n\n    const topRows = rows.slice(0, topLength);\n    const bottomRows = rows.slice(rows.length - bottomLength, rows.length);\n    const middleRows = rows.slice(topLength, rows.length - bottomLength);\n    const leftColumns = columns.slice(0, leftLength);\n    const rightColumns = columns.slice(columns.length - rightLength, columns.length);\n    const centerColumns = columns.slice(leftLength, columns.length - rightLength);\n\n    const hasTopRows = topLength > 0;\n    const hasBottomRows = bottomLength > 0;\n    const hasMiddleRows = middleLength > 0;\n    const hasLeftColumns = leftLength > 0;\n    const hasRightColumns = rightLength > 0;\n    const hasCenterColumns = centerLength > 0;\n\n    const topShowTopBorder = true;\n    const topShowBottomBorder = true;\n    const bottomShowTopBorder = hasMiddleRows || !hasTopRows;\n    const bottomShowBottomBorder = true;\n    const middleShowTopBorder = !hasTopRows;\n    const middleShowBottomBorder = !hasBottomRows;\n    const leftShowLeftBorder = true;\n    const leftShowRightBorder = true;\n    const rightShowLeftBorder = hasCenterColumns || !hasLeftColumns;\n    const rightShowRightBorder = true;\n    const centerShowLeftBorder = !hasLeftColumns;\n    const centerShowRightBorder = !hasRightColumns;\n\n    const getHeight = (rows, showTopBorder, showBottomBorder) => {\n        if (rows.length === 0)\n            return 0;\n\n        const top = showTopBorder ? rows.at(0).topWithBorder : rows.at(0).top;\n        const bottom = showBottomBorder ? rows.at(-1).bottomWithBorder : rows.at(-1).bottom;\n\n        return bottom - top;\n    }\n\n    const getWidth = (columns, showLeftBorder, showRightBorder) => {\n        if (columns.length === 0)\n            return 0;\n\n        const left = showLeftBorder ? columns.at(0).leftWithBorder : columns.at(0).left;\n        const right = showRightBorder ? columns.at(-1).rightWithBorder : columns.at(-1).right;\n\n        return right - left;\n    }\n\n    const topHeight = getHeight(topRows, topShowTopBorder, topShowBottomBorder);\n    const bottomHeight = getHeight(bottomRows, bottomShowTopBorder, bottomShowBottomBorder);\n    const middleHeight = getHeight(middleRows, middleShowTopBorder, middleShowBottomBorder);\n    const leftWidth = getWidth(leftColumns, leftShowLeftBorder, leftShowRightBorder);\n    const rightWidth = getWidth(rightColumns, rightShowLeftBorder, rightShowRightBorder);\n    const centerWidth = getWidth(centerColumns, centerShowLeftBorder, centerShowRightBorder);\n\n    return {\n        top: {\n            rows: topRows,\n            showTopBorder: topShowTopBorder,\n            showBottomBorder: topShowBottomBorder,\n            height: topHeight\n        },\n        bottom: {\n            rows: bottomRows,\n            showTopBorder: bottomShowTopBorder,\n            showBottomBorder: bottomShowBottomBorder,\n            height: bottomHeight\n        },\n        middle: {\n            rows: middleRows,\n            showTopBorder: middleShowTopBorder,\n            showBottomBorder: middleShowBottomBorder,\n            height: middleHeight\n        },\n        left: {\n            columns: leftColumns,\n            showLeftBorder: leftShowLeftBorder,\n            showRightBorder: leftShowRightBorder,\n            width: leftWidth\n        },\n        right: {\n            columns: rightColumns,\n            showLeftBorder: rightShowLeftBorder,\n            showRightBorder: rightShowRightBorder,\n            width: rightWidth\n        },\n        center: {\n            columns: centerColumns,\n            showLeftBorder: centerShowLeftBorder,\n            showRightBorder: centerShowRightBorder,\n            width: centerWidth\n        }\n    };\n}",
-        "export default class TextResolver\n{\n    constructor() {\n        this.canvas = document.createElement('canvas');\n        this.context = this.canvas.getContext('2d');\n        this.fontMetrics = new Map();\n    }\n\n    getFontMetrics(font) {\n        const key = font;\n\n        if (this.fontMetrics.has(key))\n            return this.fontMetrics.get(key);\n\n        const ctx = this.context;\n\n        // TODO: Set other font properties\n        ctx.font = font;\n\n        const textMetrics = ctx.measureText('X');\n\n        const middle = (textMetrics.actualBoundingBoxDescent - textMetrics.actualBoundingBoxAscent) / 2;\n        const topOffset = middle + textMetrics.fontBoundingBoxAscent;\n        const bottomOffset = textMetrics.fontBoundingBoxDescent - middle;\n\n        const fontMetrics = {\n            topOffset: topOffset,\n            middle: -middle,\n            bottomOffset: bottomOffset\n        };\n\n        this.fontMetrics.set(key, fontMetrics);\n\n        return fontMetrics;\n    }\n}",
-        "import { useMemo, useState } from \"react\";\n\nexport default function useDeepState(initialState, comparator) {\n    const [state, setState] = useState(initialState);\n\n    const setDeepState = useMemo(() => {\n        if (!comparator)\n            return setState;\n\n        return (newState) => {\n            setState(oldState => {\n                if (comparator(oldState, newState))\n                    return oldState;\n\n                return newState;\n            });\n        };\n    }, [comparator]);\n\n    return [state, setDeepState];\n}",
-        "/* eslint-disable react-hooks/exhaustive-deps */\n\nimport { useEffect } from \"react\";\n\n// TODO: add unit tests\nexport default function useEventListener(element, eventName, handler, deps) {\n    useEffect(() => {\n        if (!element)\n            return () => { };\n\n        element.addEventListener(eventName, handler);\n\n        return () => element.removeEventListener(eventName, handler);\n    }, [element, eventName, ...deps]);\n}",
-        "import React, { createContext, useContext, useMemo } from \"react\";\nimport useDeepState from \"../hooks/useDeepState\";\nimport useEventListener from \"../hooks/useEventListener\";\nimport useDomObserver from \"../hooks/useDomObserver\";\n\nconst SizeAndScrollContext = createContext();\n\nfunction compareScrollOffsets(oldScrollOffset, newScrollOffset) {\n    return oldScrollOffset.left === newScrollOffset.left && oldScrollOffset.top === newScrollOffset.top;\n}\n\nfunction compareSizes(oldSize, newSize) {\n    return oldSize.width === newSize.width && oldSize.height === newSize.height;\n}\n\nexport function SizeAndScrollProvider({ element, children }) {\n    const [scrollOffset, setScrollOffset] = useDeepState({ left: 0, top: 0 }, compareScrollOffsets);\n    const [size, setSize] = useDeepState({ width: 0, height: 0 }, compareSizes);\n    const [clientSize, setClientSize] = useDeepState({ width: 0, height: 0 }, compareSizes);\n\n    useEventListener(element, 'scroll', () => {\n        setScrollOffset({\n            left: element.scrollLeft,\n            top: element.scrollTop\n        });\n    }, [setScrollOffset]);\n\n    useDomObserver(element, ResizeObserver, () => {\n        setSize({\n            width: element.getBoundingClientRect().width,\n            height: element.getBoundingClientRect().height\n        });\n        setClientSize({\n            width: element.clientWidth,\n            height: element.clientHeight\n        });\n    }, [setSize]);\n\n    const value = useMemo(() => ({\n        scrollOffset,\n        size,\n        clientSize\n    }), [scrollOffset, size, clientSize]);\n\n    return (\n        <SizeAndScrollContext.Provider value={value}>\n            {children}\n        </SizeAndScrollContext.Provider>\n    );\n}\n\nexport const useScrollOffset = () => useContext(SizeAndScrollContext).scrollOffset;\nexport const useSize = () => useContext(SizeAndScrollContext).size;\nexport const useClientSize = () => useContext(SizeAndScrollContext).clientSize;",
-        "/* eslint-disable react-hooks/exhaustive-deps */\n\nimport { useEffect } from \"react\";\n\n// TODO: add unit tests is possible\nexport default function useDomObserver(element, ObserverClass, handler, deps) {\n    useEffect(() => {\n        console.count('useDomObserver');\n\n        if (!element)\n            return () => { };\n\n        const observer = new ObserverClass(handler);\n        observer.observe(element);\n\n        return () => observer.disconnect();\n    }, [element, ObserverClass, ...deps]);\n}",
+        "// TODO: Move\nexport default function getEditedCellsAndFilters(editedCells, filters) {\n    return [...editedCells, ...filters.map(filter => ({ columnId: filter.columnId, rowId: filter.rowId, value: filter.expression }))];\n}\n",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\n\n// TODO: write unit tests\nexport default class Edition {\n    constructor(editedCells) {\n        this.lookup = new Map();\n\n        editedCells.forEach(cell => {\n            const rowKey = stringifyId(cell.rowId);\n            const columnKey = stringifyId(cell.columnId);\n\n            if (!this.lookup.has(rowKey))\n                this.lookup.set(rowKey, new Map());\n\n            this.lookup.get(rowKey).set(columnKey, cell.value);\n        });\n    }\n\n    hasValueByKey(rowKey, columnKey) {\n        return this.lookup.has(rowKey) && this.lookup.get(rowKey).has(columnKey);\n    }\n\n    getValueByKey(rowKey, columnKey) {\n        if (!this.hasValueByKey(rowKey, columnKey))\n            return undefined;\n\n        return this.lookup.get(rowKey).get(columnKey);\n    }\n\n    hasValueById(rowId, columnId) {\n        return this.hasValueByKey(stringifyId(rowId), stringifyId(columnId));\n    }\n\n    getValueById(rowId, columnId) {\n        return this.getValueByKey(stringifyId(rowId), stringifyId(columnId));\n    }\n}",
+        "import Edition from \"../types/Edition.js\";\n\n// TODO: Move\nexport default function getEdition(editedCellsAndFilters) {\n    return new Edition(editedCellsAndFilters);\n}\n",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\n\nexport default class Selection {\n    constructor(selectedCells) {\n        this.lookup = new Map();\n\n        selectedCells.forEach(cell => {\n            const rowKey = stringifyId(cell.rowId);\n            const columnKey = stringifyId(cell.columnId);\n\n            if (!this.lookup.has(rowKey))\n                this.lookup.set(rowKey, new Set());\n\n            this.lookup.get(rowKey).add(columnKey);\n        });\n    }\n\n    isKeySelected(rowKey, columnKey) {\n        return this.lookup.has(rowKey) && this.lookup.get(rowKey).has(columnKey);\n    }\n\n    isIdSelected(rowId, columnId) {\n        return this.isKeySelected(stringifyId(rowId), stringifyId(columnId));\n    }\n}",
+        "import Selection from \"../types/Selection.js\";\n\nexport default function getSelection(selectedCells) {\n    return new Selection(selectedCells);\n}\n",
+        "export default function getInvoked(columnsOrRows, data) {\n    return typeof columnsOrRows === 'function'\n        ? columnsOrRows(data)\n        : columnsOrRows;\n}\n",
+        "// TODO: Move\nexport default function getPinned(index, length, pinnedBegin, pinnedEnd) {\n    if (index < pinnedBegin)\n        return \"BEGIN\";\n    if (index >= length - pinnedEnd)\n        return \"END\";\n    return undefined;\n}\n",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\nimport getPinned from \"./getPinned.js\";\n\nfunction getResolved(elements, pinnedBegin, pinnedEnd) {\n    return elements.map((element, index) => {\n        const id = 'id' in element ? element.id : element.type;\n        return {\n            ...element,\n            id: id,\n            type: element.type || \"DATA\",\n            index: index,\n            key: stringifyId(id),\n            pinned: getPinned(index, elements.length, pinnedBegin, pinnedEnd),\n            header: 'header' in element ? element.header : id,\n            labels: element.labels || []\n        };\n    });\n}\n\nexport function getResolvedColumns(columns, pinnedBegin, pinnedEnd, columnWidths) {\n    const widthsLookup = new Map(columnWidths.map(({ columnId, width }) => [stringifyId(columnId), width]));\n    const resolvedColumns = getResolved(columns, pinnedBegin, pinnedEnd);\n\n    return resolvedColumns.map(column => ({\n        ...column,\n        width: widthsLookup.has(column.key)\n            ? widthsLookup.get(column.key)\n            : column.width\n    }));\n}\n\nexport function getResolvedRows(rows, pinnedBegin, pinnedEnd, rowHeights) {\n    const heightsLookup = new Map(rowHeights.map(({ rowId, height }) => [stringifyId(rowId), height]));\n    const resolvedRows = getResolved(rows, pinnedBegin, pinnedEnd);\n\n    return resolvedRows.map(row => ({\n        ...row,\n        height: heightsLookup.has(row.key)\n            ? heightsLookup.get(row.key)\n            : row.height\n    }));\n}\n",
+        "import roundToPixels from \"../core-utils/roundToPixels.js\";\n\nexport function getPlacedColumns(columns, devicePixelRatio, borderWidth) {\n    let left = borderWidth;\n\n    return columns.map((column, index) => {\n        const assignedWidth = 'width' in column ? column.width : 100;\n        const width = roundToPixels(assignedWidth, devicePixelRatio);\n        const newColumn = {\n            ...column,\n            index: index,\n            width: width,\n            leftWithBorder: left - borderWidth,\n            left: left,\n            right: left + width,\n            rightWithBorder: left + width + borderWidth\n        };\n\n        left += newColumn.width + borderWidth;\n\n        return newColumn;\n    });\n}\n\nexport function getPlacedRows(rows, devicePixelRatio, borderWidth) {\n    let top = borderWidth;\n\n    return rows.map((row, index) => {\n        const assignedHeight = 'height' in row ? row.height : 20;\n        const height = roundToPixels(assignedHeight, devicePixelRatio);\n        const newRow = {\n            ...row,\n            index: index,\n            height: height,\n            topWithBorder: top - borderWidth,\n            top: top,\n            bottom: top + height,\n            bottomWithBorder: top + height + borderWidth\n        };\n\n        top += newRow.height + borderWidth;\n\n        return newRow;\n    });\n}\n",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\n\nconst matchMapping = {\n    'HEADER': ['HEADER'],\n    'FILTER': ['FILTER'],\n    'DATA': ['DATA'],\n    'CUSTOM': ['CUSTOM'],\n    'ANY': ['HEADER', 'DATA', 'FILTER', 'CUSTOM'],\n    'SPECIAL': ['HEADER', 'FILTER', 'CUSTOM'],\n    undefined: []\n};\n\nclass Lookup {\n    byKey = new Map();\n    byIndex = new Map(); // TODO: Should this be removed?\n    byLabel = new Map();\n    byMatch = new Map();\n}\n\nexport default class RulesLookup {\n    lookup = new Lookup();\n    hasRules = false;\n\n    addRule(column, row, rule) {\n        this.hasRules = true;\n\n        if (Array.isArray(column)) {\n            for (const c of column)\n                this.addRule(c, row, rule);\n            return;\n        }\n\n        if (Array.isArray(row)) {\n            for (const r of row)\n                this.addRule(column, r, rule);\n            return;\n        }\n\n        column = column\n            ? 'id' in column\n                ? { key: stringifyId(column.id) }\n                : column\n            : { match: 'DATA' };\n        row = row\n            ? 'id' in row\n                ? { key: stringifyId(row.id) }\n                : row\n            : { match: 'DATA' };\n\n        function addRowRule(lookup, key) {\n            if (!lookup.has(key))\n                lookup.set(key, []);\n\n            lookup.get(key).push(rule);\n        }\n\n        function addColumnRule(lookup, key) {\n            if (!lookup.has(key))\n                lookup.set(key, new Lookup());\n\n            if ('key' in row)\n                addRowRule(lookup.get(key).byKey, row.key);\n            if ('index' in row)\n                addRowRule(lookup.get(key).byIndex, row.index);\n            if ('label' in row)\n                addRowRule(lookup.get(key).byLabel, row.label);\n            for (const match of matchMapping[row.match])\n                addRowRule(lookup.get(key).byMatch, match);\n        }\n\n        if ('key' in column)\n            addColumnRule(this.lookup.byKey, column.key);\n        if ('index' in column)\n            addColumnRule(this.lookup.byIndex, column.index);\n        if ('label' in column)\n            addColumnRule(this.lookup.byLabel, column.label);\n        for (const match of matchMapping[column.match])\n            addColumnRule(this.lookup.byMatch, match);\n    }\n\n    getRules(column, row) {\n        const rules = [];\n\n        if (!this.hasRules)\n            return rules;\n\n        function gatherRules(newRules) {\n            for (const rule of newRules)\n                rules.push(rule);\n        }\n\n        function gatherRowRules(lookup) {\n            if (lookup.byKey.has(row.key))\n                gatherRules(lookup.byKey.get(row.key));\n            if (lookup.byIndex.has(row.index))\n                gatherRules(lookup.byIndex.get(row.index));\n            if (lookup.byMatch.has(row.type))\n                gatherRules(lookup.byMatch.get(row.type));\n            for (const label of row.labels) {\n                if (lookup.byLabel.has(label))\n                    gatherRules(lookup.byLabel.get(label));\n            }\n        }\n\n        if (this.lookup.byKey.has(column.key))\n            gatherRowRules(this.lookup.byKey.get(column.key));\n        if (this.lookup.byIndex.has(column.index))\n            gatherRowRules(this.lookup.byIndex.get(column.index));\n        if (this.lookup.byMatch.has(column.type))\n            gatherRowRules(this.lookup.byMatch.get(column.type));\n        for (const label of column.labels) {\n            if (this.lookup.byLabel.has(label))\n                gatherRowRules(this.lookup.byLabel.get(label));\n        }\n\n        return rules;\n    }\n};",
+        "import { defaultPadding } from \"../core-utils/defaults.js\";\nimport RulesLookup from \"./RulesLookup.js\";\n\nconst borderTypes = ['borderTop', 'borderRight', 'borderBottom', 'borderLeft'];\n\n// TODO: Don't recreate styles if they haven't changed\nfunction indexBorders(style, index) {\n    const newStyle = { ...style };\n\n    if ('border' in newStyle) {\n        for (const borderType of borderTypes)\n            newStyle[borderType] = newStyle.border;\n        delete newStyle.border;\n    }\n\n    for (const borderType of borderTypes)\n        if (borderType in newStyle)\n            newStyle[borderType] = { ...newStyle[borderType], index };\n\n    return newStyle;\n}\n\n// TODO: Rename to FormatResolver\n// TODO: Optimize by not searching using keys that don't have correlated match rules\n// TODO: Accept both a function and an object as a style (where the object is a resolved style)\n// TODO: Consider removing index from the lookup\nexport default class FormattingRules {\n    constructor(rules) {\n        this.rulesLookup = new RulesLookup();\n\n        for (const [index, rule] of rules.entries()) {\n            const entry = { index };\n    \n            if ('condition' in rule)\n                entry.condition = rule.condition;\n            if ('style' in rule)\n                entry.style = typeof rule.style === 'function' ? rule.style : () => rule.style;\n            if ('value' in rule)\n                entry.value = typeof rule.value === 'function' ? rule.value : () => rule.value;\n            if ('text' in rule)\n                entry.text = typeof rule.text === 'function' ? rule.text : () => rule.text;\n            if ('padding' in rule)\n                entry.padding = typeof rule.padding === 'function' ? rule.padding : () => rule.padding;\n            if ('edit' in rule)\n                entry.edit = rule.edit;\n            if ('draw' in rule)\n                entry.draw = rule.draw;\n    \n            this.rulesLookup.addRule(rule.column, rule.row, entry);\n        }\n    }\n\n    resolve(data, rows, columns, row, column, edition) {\n        const rules = this.rulesLookup\n            .getRules(column, row)\n            .sort((a, b) => a.index - b.index)\n            .filter((value, index, array) => value.index !== array[index - 1]?.index);\n\n        let context = { data, rows, columns, row, column };\n        let style = {};\n        let draw = undefined;\n        let visible = true;\n        let padding = defaultPadding;\n\n        if (edition.hasValueByKey(row.key, column.key))\n            context = { ...context, newValue: edition.getValueByKey(row.key, column.key) };\n\n        for (const rule of rules) {\n            if ('condition' in rule && !rule.condition(context))\n                continue;\n\n            // TODO: Don't actually add things like `edit` to the context\n            if ('value' in rule)\n                context = { ...context, value: rule.value(context) };\n            if ('style' in rule)\n                style = { ...style, ...indexBorders(rule.style(context), rule.index) };\n            if ('text' in rule)\n                context = { ...context, text: rule.text(context) };\n            if ('padding' in rule)\n                padding = { ...padding, ...rule.padding(context) };\n            if ('edit' in rule)\n                context = { ...context, edit: rule.edit && 'edit' in context ? { ...context.edit, ...rule.edit } : rule.edit };\n            if ('draw' in rule) {\n                const currentContext = context;\n                draw = (ctx) => rule.draw({ ...currentContext, ctx });\n            }\n\n            // TODO: Add StopPropagation\n        }\n\n        const text = 'text' in context ? context.text : `${context.value}`;\n        const result = {\n            style,\n            visible,\n            text,\n            padding\n        };\n\n        if ('value' in context)\n            result.value = context.value;\n        if ('edit' in context)\n            result.edit = context.edit;\n        if (draw !== undefined)\n            result.draw = draw;\n        if ('text' in context)\n            result.text = context.text;\n\n        return result;\n    }\n}",
+        "import FormattingRules from \"../types/FormattingRules.js\";\n\nexport default function getFormattingRules(dataFormatting) {\n    return new FormattingRules(dataFormatting);\n}\n",
+        "export default class FormatResolver {\n    constructor(formattingRules, data, rows, columns, edition) {\n        this.formattingRules = formattingRules;\n        this.data = data;\n        this.rows = rows;\n        this.columns = columns;\n        this.edition = edition;\n    }\n\n    resolve(row, column) {\n        return this.formattingRules.resolve(\n            this.data,\n            this.rows,\n            this.columns,\n            row,\n            column,\n            this.edition);\n    }\n}",
+        "import FormatResolver from \"../types/FormatResolver.js\";\n\nexport default function getFormatResolver(formattingRules, data, rows, columns, edition) {\n    return new FormatResolver(formattingRules, data, rows, columns, edition);\n}\n",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\n\nfunction getFilterLookup(filters, primaryKey, secondaryKey) {\n    const filterLookup = new Map();\n    for (const cell of filters) {\n        const primary = stringifyId(cell[primaryKey]);\n        const secondary = stringifyId(cell[secondaryKey]);\n\n        if (!filterLookup.has(primary))\n            filterLookup.set(primary, new Map());\n\n        filterLookup.get(primary).set(secondary, cell.expression);\n    }\n    return filterLookup;\n}\n\nexport function getFilteredRows(filters, filteringRules, formattingRules, data, rows, columns, edition) {\n    if (filters.length === 0)\n        return rows;\n\n    const filterLookup = getFilterLookup(filters, 'columnId', 'rowId');\n    const filteredColumns = columns.filter(column => column.type !== 'FILTER' && filterLookup.has(column.key));\n\n    if (filteredColumns.length === 0)\n        return rows;\n\n    return rows.filter(row => {\n        for (const column of filteredColumns) {\n            const cell = formattingRules.resolve(data, rows, columns, row, column, edition);\n            const columnFilters = filterLookup.get(column.key);\n            const visible = filteringRules.resolve(data, rows, columns, row, column, cell.value, cell.text, columnFilters);\n\n            if (!visible)\n                return false;\n        }\n        return true;\n    });\n}\n\nexport function getFilteredColumns(filters, filteringRules, formattingRules, data, rows, columns, edition) {\n    if (filters.length === 0)\n        return columns;\n\n    const filterLookup = getFilterLookup(filters, 'rowId', 'columnId');\n    const filteredRows = rows.filter(row => row.type !== 'FILTER' && filterLookup.has(row.key));\n\n    if (filteredRows.length === 0)\n        return columns;\n\n    return columns.filter(column => {\n        for (const row of filteredRows) {\n            const cell = formattingRules.resolve(data, rows, columns, row, column, edition);\n            const rowFilters = filterLookup.get(row.key);\n            const visible = filteringRules.resolve(data, rows, columns, row, column, cell.value, cell.text, rowFilters);\n\n            if (!visible)\n                return false;\n        }\n        return true;\n    });\n}",
+        "export default function getFixedSize(top, bottom, left, right) {\n    return {\n        top: top,\n        bottom: bottom,\n        left: left,\n        right: right\n    };\n}\n",
+        "export default function getTotalSize(columns, rows) {\n    return {\n        width: columns.length ? columns.at(-1).rightWithBorder : 0,\n        height: rows.length ? rows.at(-1).bottomWithBorder : 0\n    };\n}\n",
+        "import { defaultFont } from \"../core-utils/defaults.js\";\n\nexport default class TextResolver\n{\n    constructor() {\n        this.canvas = document.createElement('canvas');\n        this.context = this.canvas.getContext('2d');\n        this.fontMetrics = new Map();\n    }\n\n    measureWidth(text, font) {\n        const ctx = this.context;\n\n        ctx.font = font || defaultFont;\n\n        const textMetrics = ctx.measureText(text);\n\n        return textMetrics.width;\n    }\n\n    measureHeight(text, font) {\n        let lines = 1;\n        for (const char of text) {\n            if (char === '\\n')\n                lines++;\n        }\n\n        return lines * this.getFontMetrics(font).height;\n    }\n\n    getFontMetrics(font) {\n        const key = font;\n\n        if (this.fontMetrics.has(key))\n            return this.fontMetrics.get(key);\n\n        const ctx = this.context;\n\n        // TODO: Set other font properties\n        ctx.font = font || defaultFont;\n\n        const textMetrics = ctx.measureText('X');\n\n        const middle = (textMetrics.actualBoundingBoxDescent - textMetrics.actualBoundingBoxAscent) / 2;\n        const topOffset = middle + textMetrics.fontBoundingBoxAscent;\n        const bottomOffset = textMetrics.fontBoundingBoxDescent - middle;\n        const height = textMetrics.fontBoundingBoxAscent + textMetrics.fontBoundingBoxDescent;\n\n        const fontMetrics = {\n            topOffset: topOffset,\n            middle: -middle,\n            bottomOffset: bottomOffset,\n            height: height\n        };\n\n        this.fontMetrics.set(key, fontMetrics);\n\n        return fontMetrics;\n    }\n}",
+        "import TextResolver from \"../types/TextResolver.js\";\n\nexport default function getTextResolver() {\n    return new TextResolver();\n}\n",
         "export function contains(bounds, rect) {\n    return (\n        rect.top >= bounds.top &&\n        rect.left >= bounds.left &&\n        rect.top + rect.height <= bounds.top + bounds.height &&\n        rect.left + rect.width <= bounds.left + bounds.width\n    );\n}\n\nexport function clip(bounds, rect) {\n    const newRect = {\n        top: Math.max(bounds.top, rect.top),\n        left: Math.max(bounds.left, rect.left),\n        width: Math.min(bounds.left + bounds.width, rect.left + rect.width) - Math.max(bounds.left, rect.left),\n        height: Math.min(bounds.top + bounds.height, rect.top + rect.height) - Math.max(bounds.top, rect.top)\n    };\n\n    if (newRect.width >= 0 && newRect.height >= 0)\n        return newRect;\n\n    return {\n        top: bounds.top,\n        left: bounds.left,\n        width: 0,\n        height: 0\n    }\n}\n\nexport function expand(rect, margin) {\n    return {\n        top: rect.top - margin,\n        left: rect.left - margin,\n        width: rect.width + margin * 2,\n        height: rect.height + margin * 2\n    };\n}\n\nexport function area(rect) {\n    return rect.width * rect.height;\n}\n\nexport function subtract(rect, margin) {\n    return {\n        top: rect.top,\n        left: rect.left,\n        width: Math.max(0, rect.width - margin.left - margin.right),\n        height: Math.max(0, rect.height - margin.top - margin.bottom)\n    };\n}",
-        "import { createContext, useContext } from \"react\";\nimport { useFixedSize, useTotalSize } from \"./StateContext\";\nimport { useScrollOffset, useSize } from \"./SizeAndScrollContext\";\nimport useRefMemo from \"../hooks/useRefMemo\";\nimport { area, clip, contains, expand, subtract } from \"../utils/rect\";\n\nconst ScrollRectContext = createContext();\n\nconst requiredMargin = 200;\nconst preloadedMargin = 400;\nconst emptyRect = {\n    left: 0,\n    top: 0,\n    width: 0,\n    height: 0\n};\n\nexport function ScrollRectProvider({ children }) {\n    const totalSize = useTotalSize();\n    const fixedSize = useFixedSize();\n    const size = useSize();\n    const scrollOffset = useScrollOffset();\n\n    const scrollRect = useRefMemo(previous => {\n        const prevScrollRect = previous || emptyRect;\n\n        const totalRect = { left: 0, top: 0, ...totalSize };\n        const bounds = subtract(totalRect, fixedSize);\n        const scrollRect = subtract({ ...scrollOffset, ...size }, fixedSize);\n        const requiredScrollRect = clip(bounds, expand(scrollRect, requiredMargin));\n        const preloadedScrollRect = clip(bounds, expand(scrollRect, preloadedMargin));\n\n        if (!contains(bounds, prevScrollRect))\n            return preloadedScrollRect;\n\n        if (!contains(prevScrollRect, requiredScrollRect))\n            return preloadedScrollRect;\n\n        if (area(prevScrollRect) > 2 * area(preloadedScrollRect))\n            return preloadedScrollRect;\n\n        return prevScrollRect;\n    }, [fixedSize, size, scrollOffset]);\n\n    return (\n        <ScrollRectContext.Provider value={scrollRect}>\n            {children}\n        </ScrollRectContext.Provider>\n    )\n}\n\nexport const useScrollRect = () => useContext(ScrollRectContext);",
-        "import { useMemo, useRef } from \"react\";\n\nexport default function useRefMemo(factory, deps)\n{\n    const ref = useRef(undefined);\n\n    return useMemo(() => {\n        ref.current = factory(ref.current);\n        return ref.current;\n    }, deps);\n}",
-        "import { createContext, useContext, useMemo } from \"react\";\nimport { useSections } from \"./StateContext\";\nimport { useScrollRect } from \"./ScrollRectContext\";\n\nconst GridSectionContext = createContext();\n\nexport function GridSectionProvider({ children, horizontal, vertical }) {\n    const scrollRect = useScrollRect();\n    const sections = useSections();\n\n    const { rows, height, showTopBorder, showBottomBorder } = sections[vertical];\n    const { columns, width, showLeftBorder, showRightBorder } = sections[horizontal];\n\n    const top = vertical === 'middle'\n        ? scrollRect.top\n        : 0;\n    const left = horizontal === 'center'\n        ? scrollRect.left\n        : 0;\n\n    const actualHeight = vertical === 'middle'\n        ? scrollRect.height\n        : height;\n    const actualWidth = horizontal === 'center'\n        ? scrollRect.width\n        : width;\n\n    const sectionRect = useMemo(() => ({\n        left: left,\n        top: top,\n        width: actualWidth,\n        height: actualHeight\n    }), [left, top, actualWidth, actualHeight]);\n\n    const sectionBorders = useMemo(() => ({\n        top: showTopBorder,\n        bottom: showBottomBorder,\n        left: showLeftBorder,\n        right: showRightBorder\n    }), [showTopBorder, showBottomBorder, showLeftBorder, showRightBorder]);\n\n    const value = useMemo(() => ({\n        columns: columns,\n        rows: rows,\n        rect: sectionRect,\n        borders: sectionBorders\n    }), [columns, rows, sectionRect, sectionBorders]);\n\n    if (columns.length === 0 || rows.length === 0)\n        return null;\n\n    return (\n        <GridSectionContext.Provider value={value}>\n            {children}\n        </GridSectionContext.Provider>\n    );\n}\n\nexport const useSectionColumns = () => useContext(GridSectionContext).columns;\nexport const useSectionRows = () => useContext(GridSectionContext).rows;\nexport const useSectionRect = () => useContext(GridSectionContext).rect;\nexport const useSectionBorders = () => useContext(GridSectionContext).borders;\n",
-        "import React, { useEffect, useMemo, useState } from \"react\"\nimport TextResolver from \"../utils/TextResolver\";\nimport { roundToPixels } from \"../hooks/useDevicePixelRatio\";\nimport { useBorderWidth, useRenderFormatResolver } from \"../contexts/StateContext\";\nimport { useSectionBorders, useSectionColumns, useSectionRect, useSectionRows } from \"../contexts/GridSectionContext\";\n\n// TODO: Upgrade to react 18 for better performance\n/** TODO: update the arguments to reflect the real props\n * @param {{\n *   cells: {\n *     value: string\n *   }[][]\n *   rowHeight: number\n *   columnWidths: number[]\n *   showLeftBorder: bool // TODO: check if it's bool or boolean\n *   showTopBorder: bool\n * }} props\n */\nexport default function GridCanvas({\n    style,\n    devicePixelRatio\n}) {\n    const [canvas, setCanvas] = useState(null);\n    const textResolver = useMemo(() => new TextResolver(), []);\n    // TODO: Make sure those formatters are split based on the rule areas\n    const formatResolver = useRenderFormatResolver();\n    const columns = useSectionColumns();\n    const rows = useSectionRows();\n    const borderWidth = useBorderWidth();\n    const sectionRect = useSectionRect();\n    const sectionBorders = useSectionBorders();\n\n    // TODO: Read and apply: https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas?retiredLocale=pl\n    // TODO: Redraw only the cells that have actually changed\n    useEffect(() => {\n        const draw = () => {\n            if (!canvas)\n                return;\n\n            // Checking how often this is called\n            console.log('draw');\n\n            // TODO: Borders are still blurry after scrolling at high zoom-out levels\n\n            const ctx = canvas.getContext(\"2d\");\n            // TODO: Make that \"1\" configurable as cell spacing\n            const borderOffset = borderWidth / 2;\n            const rowCount = rows.length;\n            const columnCount = columns.length;\n            const horizontalBorderCount = rowCount - 1 + (sectionBorders.top ? 1 : 0) + (sectionBorders.bottom ? 1 : 0);\n            const verticalBorderCount = columnCount - 1 + (sectionBorders.left ? 1 : 0) + (sectionBorders.right ? 1 : 0);\n            const rowHeights = rows.map(row => row.height);\n            const columnWidths = columns.map(column => column.width);\n            const totalWidth = columnWidths.reduce((a, b) => a + b, 0) + verticalBorderCount * borderWidth;\n            const totalHeight = rowHeights.reduce((a, b) => a + b, 0) + horizontalBorderCount * borderWidth;\n            const left = sectionRect.left;\n            const top = sectionRect.top;\n            const width = sectionRect.width;\n            const height = sectionRect.height;\n\n            // TODO: Move somewhere else\n            const horizontalOffsets = columnWidths.reduce((acc, width, index) => {\n                const prevOffset = acc[index];\n                const offset = prevOffset + width + borderWidth;\n                acc.push(offset);\n                return acc;\n            }, [sectionBorders.left ? borderWidth : 0]);\n            const verticalOffsets = rowHeights.reduce((acc, height, index) => {\n                const prevOffset = acc[index];\n                const offset = prevOffset + height + borderWidth;\n                acc.push(offset);\n                return acc;\n            }, [sectionBorders.top ? borderWidth : 0]);\n\n            const columnOffsets = horizontalOffsets.slice(0, -1);\n            const rowOffsets = verticalOffsets.slice(0, -1);\n\n            const minVisibleColumnIndex = Math.max(columnOffsets.findLastIndex(offset => offset <= left), 0);\n            const maxVisibleColumnIndex = columnOffsets.findLastIndex(offset => offset <= left + width);\n            const minVisibleRowIndex = Math.max(rowOffsets.findLastIndex(offset => offset <= top), 0);\n            const maxVisibleRowIndex = rowOffsets.findLastIndex(offset => offset <= top + height);\n\n            const minVisibleVerticalBorderIndex = Math.max(minVisibleColumnIndex, sectionBorders.left ? 0 : 1);\n            const maxVisibleVerticalBorderIndex = maxVisibleColumnIndex + (sectionBorders.right ? 1 : 0);\n            const minVisibleHorizontalBorderIndex = Math.max(minVisibleRowIndex, sectionBorders.top ? 0 : 1);\n            const maxVisibleHorizontalBorderIndex = maxVisibleRowIndex + (sectionBorders.bottom ? 1 : 0);\n\n            const cells = Array.from({ length: maxVisibleRowIndex - minVisibleRowIndex + 1 }, (_, rowIndex) => {\n                const row = rows[rowIndex + minVisibleRowIndex];\n                return Array.from({ length: maxVisibleColumnIndex - minVisibleColumnIndex + 1 }, (_, columnIndex) => {\n                    const column = columns[columnIndex + minVisibleColumnIndex];\n                    return formatResolver.resolve(row, column);\n                });\n            });\n            const getCell = (rowIndex, columnIndex) => cells[rowIndex - minVisibleRowIndex][columnIndex - minVisibleColumnIndex];\n\n            canvas.width = Math.round(width * devicePixelRatio);\n            canvas.height = Math.round(height * devicePixelRatio);\n            canvas.style.width = `${width}px`;\n            canvas.style.height = `${height}px`;\n            canvas.style.marginLeft = `${left}px`;\n            canvas.style.marginTop = `${top}px`;\n            canvas.style.marginRight = `${totalWidth - width - left}px`;\n            canvas.style.marginBottom = `${totalHeight - height - top}px`;;\n\n            ctx.fillStyle = \"#E9E9E9\";\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n            const setTransform = (x, y) => {\n                ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, (x - left) * devicePixelRatio, (y - top) * devicePixelRatio);\n            };\n            const setClip = (x, y, width, height) => {\n                ctx.beginPath();\n                ctx.rect(x, y, width, height);\n                ctx.clip();\n            };\n\n            // Draw cells\n            for (let columnIndex = minVisibleColumnIndex; columnIndex <= maxVisibleColumnIndex; columnIndex++) {\n                ctx.save();\n                setTransform(horizontalOffsets[columnIndex], 0);\n                setClip(0, 0, columnWidths[columnIndex], totalHeight);\n\n                for (let rowIndex = minVisibleRowIndex; rowIndex <= maxVisibleRowIndex; rowIndex++) {\n                    const cell = getCell(rowIndex, columnIndex);\n                    const style = cell.style;\n                    const cellTop = verticalOffsets[rowIndex];\n                    const cellLeft = horizontalOffsets[columnIndex];\n                    const cellWidth = columnWidths[columnIndex];\n                    const cellHeight = rowHeights[rowIndex];\n                    const text = 'text' in cell ? cell.text : cell.value;\n                    const textAlign = style.textAlign || 'left';\n                    const textBaseline = style.textBaseline || 'middle';\n                    const paddingLeft = 'paddingLeft' in style ? style.paddingLeft : 5;\n                    const paddingRight = 'paddingRight' in style ? style.paddingRight : 5;\n                    const paddingTop = 'paddingTop' in style ? style.paddingTop : 2;\n                    const paddingBottom = 'paddingBottom' in style ? style.paddingBottom : 2;\n\n                    setTransform(cellLeft, cellTop);\n\n                    ctx.fillStyle = style.background || 'white';\n                    ctx.fillRect(0, 0, cellWidth, cellHeight);\n\n                    if ('draw' in cell) \n                        cell.draw(ctx);\n\n                    if (style.highlight) {\n                        ctx.fillStyle = style.highlight;\n                        ctx.fillRect(0, 0, cellWidth, cellHeight);\n                    }\n\n                    if (style.corner) {\n                        ctx.fillStyle = style.corner;\n                        ctx.beginPath();\n                        ctx.moveTo(cellWidth - 7, cellHeight);\n                        ctx.lineTo(cellWidth, cellHeight);\n                        ctx.lineTo(cellWidth, cellHeight - 7);\n                        ctx.fill();\n                    }\n\n                    ctx.fillStyle = style.foreground || 'black';\n                    ctx.font = style.font || '12px Calibri';\n                    ctx.textAlign = textAlign;\n\n                    const fontMetrics = textResolver.getFontMetrics(ctx.font);\n\n                    // TODO: Make sure that values are rounded using devicePixelRatio\n                    const textX = roundToPixels(\n                        textAlign === 'left' ? paddingLeft :\n                            textAlign === 'center' ? cellWidth / 2 :\n                                textAlign === 'right' ? cellWidth - paddingRight :\n                                    0,\n                        devicePixelRatio\n                    );\n\n                    const textY = roundToPixels(\n                        textBaseline === 'top' ? fontMetrics.middle + fontMetrics.topOffset + paddingTop :\n                            textBaseline === 'middle' ? cellHeight / 2 + fontMetrics.middle :\n                                textBaseline === 'bottom' ? cellHeight + fontMetrics.middle - fontMetrics.bottomOffset - paddingBottom :\n                                    0,\n                        devicePixelRatio\n                    );\n\n                    const fitsVertically = textY - fontMetrics.middle - fontMetrics.topOffset >= 0 && textY - fontMetrics.middle + fontMetrics.bottomOffset <= cellHeight;\n\n                    if (fitsVertically) {\n                        ctx.fillText(text, textX, textY);\n                    }\n                    else {\n                        // TODO: Clip if the text is too high (and draw some indicator if you do)\n                        ctx.strokeStyle = '#E9E9E9';\n                        ctx.lineWidth = borderWidth;\n\n                        ctx.beginPath();\n                        ctx.moveTo(0, borderWidth + borderOffset);\n                        ctx.lineTo(cellWidth, borderWidth + borderOffset);\n                        ctx.moveTo(0, cellHeight - borderWidth - borderOffset);\n                        ctx.lineTo(cellWidth, cellHeight - borderWidth - borderOffset);\n                        ctx.stroke();\n\n                        ctx.save();\n                        setClip(0, 2 * borderWidth, cellWidth, cellHeight - 4 * borderWidth);\n\n                        ctx.fillText(text, textX, textY);\n\n                        ctx.restore();\n                    }\n                }\n\n                ctx.restore();\n            }\n\n            setTransform(0, 0);\n\n            // Draw borders\n\n            // TODO: clip drawing area to the middle of neighboring columns/rows (might be useful for redrawing only the changed cells)\n            // TODO: move somewhere (?)\n            const drawBorder = (x1, y1, x2, y2, style) => {\n                if (!style)\n                    return;\n\n                const width = style.width * borderWidth;\n\n                const isHorizontal = y1 === y2;\n\n                // TODO: Don't add offset if the border is not continued\n                const xa = x1 - (isHorizontal ? width / 2 : 0);\n                const ya = y1 - (!isHorizontal ? width / 2 : 0);\n                const xb = x2 + (isHorizontal ? width / 2 : 0);\n                const yb = y2 + (!isHorizontal ? width / 2 : 0);\n\n                ctx.strokeStyle = style.color || 'black'; // TODO: resolve this color earlier\n                ctx.lineWidth = width;\n\n                if (style.dash) {\n                    ctx.setLineDash(style.dash.map(value => value / devicePixelRatio));\n                    ctx.lineDashOffset = (isHorizontal ? xa : ya);\n                }\n                else {\n                    ctx.setLineDash([]);\n                }\n\n                ctx.beginPath();\n                ctx.moveTo(xa, ya);\n                ctx.lineTo(xb, yb);\n                ctx.stroke();\n            }\n\n            const selectBorder = (borderStyleA, borderStyleB) => {\n                if (!borderStyleA)\n                    return borderStyleB;\n\n                if (!borderStyleB)\n                    return borderStyleA;\n\n                if (borderStyleA.index > borderStyleB.index)\n                    return borderStyleA;\n\n                return borderStyleB;\n            }\n\n            // TODO: Move somewhere else (?)\n            for (let horizontalBorderIndex = minVisibleHorizontalBorderIndex; horizontalBorderIndex <= maxVisibleHorizontalBorderIndex; horizontalBorderIndex++) {\n                const topRowIndex = horizontalBorderIndex - 1;\n                const bottomRowIndex = horizontalBorderIndex;\n\n                for (let columnIndex = minVisibleColumnIndex; columnIndex <= maxVisibleColumnIndex; columnIndex++) {\n                    const topBorderStyle = topRowIndex >= minVisibleRowIndex ? getCell(topRowIndex, columnIndex).style.borderBottom : null;\n                    const bottomBorderStyle = bottomRowIndex <= maxVisibleRowIndex ? getCell(bottomRowIndex, columnIndex).style.borderTop : null;\n\n                    const borderStyle = selectBorder(topBorderStyle, bottomBorderStyle);\n\n                    drawBorder(\n                        horizontalOffsets[columnIndex] - borderOffset,\n                        verticalOffsets[bottomRowIndex] - borderOffset,\n                        horizontalOffsets[columnIndex + 1] - borderOffset,\n                        verticalOffsets[bottomRowIndex] - borderOffset,\n                        borderStyle);\n                }\n            }\n\n            for (let verticalBorderIndex = minVisibleVerticalBorderIndex; verticalBorderIndex <= maxVisibleVerticalBorderIndex; verticalBorderIndex++) {\n                const leftColumnIndex = verticalBorderIndex - 1;\n                const rightColumnIndex = verticalBorderIndex;\n\n                for (let rowIndex = minVisibleRowIndex; rowIndex <= maxVisibleRowIndex; rowIndex++) {\n                    const leftBorderStyle = leftColumnIndex >= minVisibleColumnIndex ? getCell(rowIndex, leftColumnIndex).style.borderRight : null;\n                    const rightBorderStyle = rightColumnIndex <= maxVisibleColumnIndex ? getCell(rowIndex, rightColumnIndex).style.borderLeft : null;\n\n                    const borderStyle = selectBorder(leftBorderStyle, rightBorderStyle);\n\n                    drawBorder(\n                        horizontalOffsets[rightColumnIndex] - borderOffset,\n                        verticalOffsets[rowIndex] - borderOffset,\n                        horizontalOffsets[rightColumnIndex] - borderOffset,\n                        verticalOffsets[rowIndex + 1] - borderOffset,\n                        borderStyle);\n                }\n            }\n        };\n\n        const nextFrame = requestAnimationFrame(draw);\n\n        // Can this ever be starved out?\n        return () => cancelAnimationFrame(nextFrame);\n    }, [canvas, devicePixelRatio, rows, columns, sectionRect, borderWidth, formatResolver, textResolver, sectionBorders]);\n\n    // TODO: style={{imageRendering: 'pixelated'}} - is this even needed, though?\n    // TODO: memoize style\n    return (\n        <canvas ref={setCanvas} style={style} />\n    );\n}",
-        "import React, { createContext, useCallback, useContext, useMemo, useRef } from \"react\";\nimport useDeepState from \"../hooks/useDeepState\";\nimport useEventListener from \"../hooks/useEventListener\";\n\nconst MouseAndKeyboardContext = createContext();\n\nfunction compareMousePositions(oldMousePosition, newMousePosition) {\n    return oldMousePosition?.x === newMousePosition?.x && oldMousePosition?.y === newMousePosition?.y;\n}\n\nexport function MouseAndKeyboardProvider({ element, children }) {\n    const interactions = useRef({});\n    const [mousePosition, setMousePosition] = useDeepState(null, compareMousePositions);\n    const [isMouseDown, setIsMouseDown] = useDeepState(false);\n\n    useEventListener(element, 'mouseenter', (event) => {\n        setMousePosition({\n            x: event.clientX - element.offsetLeft,\n            y: event.clientY - element.offsetTop\n        });\n    }, [setMousePosition]);\n\n    useEventListener(element, 'mousemove', (event) => {\n        setMousePosition({\n            x: event.clientX - element.offsetLeft,\n            y: event.clientY - element.offsetTop\n        });\n    }, [setMousePosition]);\n\n    useEventListener(element, 'mouseleave', () => {\n        setMousePosition(null);\n    }, [setMousePosition]);\n\n    useEventListener(element, 'mousedown', (event) => {\n        setIsMouseDown(true);\n\n        if (interactions.current.mousedown)\n            interactions.current.mousedown(event);\n    }, []);\n\n    useEventListener(element, 'mouseup', (event) => {\n        setIsMouseDown(false);\n\n        if (interactions.current.mouseup)\n            interactions.current.mouseup(event);\n    }, []);\n\n    useEventListener(element, 'keydown', (event) => {\n        if (interactions.current.keydown)\n            interactions.current.keydown(event);\n    }, []);\n\n    useEventListener(element, 'click', (event) => {\n        if (interactions.current.click)\n            interactions.current.click(event);\n    }, []);\n\n    useEventListener(element, 'dblclick', (event) => {\n        if (interactions.current.dblclick)\n            interactions.current.dblclick(event);\n    }, []);\n\n    useEventListener(element, 'focus', (event) => {\n        if (interactions.current.focus)\n            interactions.current.focus(event);\n    }, []);\n\n    const focus = useCallback(() => {\n        element?.focus();\n    }, [element]);\n\n    const value = useMemo(() => ({\n        mousePosition,\n        isMouseDown,\n        focus,\n        interactions\n    }), [mousePosition, isMouseDown, focus]);\n\n    return (\n        <MouseAndKeyboardContext.Provider value={value}>\n            {children}\n        </MouseAndKeyboardContext.Provider>\n    );\n}\n\nexport function useInteraction(name, handler) {\n    useContext(MouseAndKeyboardContext).interactions.current[name] = handler;\n}\n\nexport const useMousePosition = () => useContext(MouseAndKeyboardContext).mousePosition;\nexport const useIsMouseDown = () => useContext(MouseAndKeyboardContext).isMouseDown;\nexport const useFocus = () => useContext(MouseAndKeyboardContext).focus;",
-        "import { forwardRef, useCallback, useEffect, useRef, useState } from \"react\";\nimport useEventListener from \"../hooks/useEventListener\";\n\nconst GridInput = forwardRef(({ text, onTextChange, placement, isValid }, ref) => {\n    const [element, setElement] = useState(null);\n    const internalText = useRef('');\n\n    useEventListener(element, 'mousedown', event => {\n        event.stopPropagation();\n    }, []);\n\n    useEventListener(element, 'keydown', event => {\n        switch (event.key) {\n            case 'Enter':\n            case 'Escape':\n                break;\n            case 'Delete':\n            case 'Backspace':\n                if (internalText.current !== '')\n                    event.stopPropagation();\n                break;\n            default:\n                event.stopPropagation();\n                break;\n        }\n    }, []);\n\n    useEventListener(element, 'click', event => {\n        event.stopPropagation();\n    }, []);\n\n    useEventListener(element, 'dblclick', event => {\n        event.stopPropagation();\n    }, []);\n\n    const setElementAndRef = useCallback(element => {\n        setElement(element);\n        ref?.(element);\n    }, [ref]);\n\n    const onChange = useCallback(event => {\n        internalText.current = event.target.value;\n        onTextChange(event.target.value);\n    }, [onTextChange]);\n\n    useEffect(() => {\n        if (text === internalText.current)\n            return;\n\n        internalText.current = text;\n        element?.select();\n    }, [text, element]);\n\n    if (!placement)\n        return <></>;\n\n    // TODO: It's currently not possible to clear the text as the input hides before the text is cleared.\n    return <input\n        ref={setElementAndRef}\n        autoFocus\n        style={{\n            position: 'absolute',\n            zIndex: 3, ...placement,\n            opacity: (text ? 1 : 0),\n            pointerEvents: text ? 'auto' : 'none',\n            outline: 'none',\n            border: 'none',\n            boxShadow: 'none',\n            padding: '0 5px',\n            fontSize: '12px',\n            fontFamily: 'Calibri',\n            backgroundColor: isValid ? 'white' : '#eb3434'\n        }}\n        placeholder='placeholder'\n        value={text}\n        onChange={onChange}\n        opacity={text === '' ? 1 : 0}\n    />\n});\n\nexport default GridInput;",
-        "import React, { useEffect, useMemo } from 'react';\nimport stringifyId from '../utils/stringifyId';\nimport { useFocus, useInteraction, useIsMouseDown, useMousePosition } from '../contexts/MouseAndKeyboardContext';\nimport { useAddEditedCells, useAddFilters, useAddSelectedCells, useBorderWidth, useColumns, useFixedSize, useFocusedCell, useHoveredCell, useInputFormatResolver, useRemoveEditedCells, useRemoveFilters, useRows, useSelectedCells, useSetEditedCells, useSetFilters, useSetFocusedCell, useSetHighlightedCells, useSetHoveredCell, useSetSelectedCells, useTotalSize } from '../contexts/StateContext';\nimport { useClientSize, useScrollOffset } from '../contexts/SizeAndScrollContext';\nimport { useState } from 'react';\nimport GridInput from './GridInput';\n\nfunction useColumnPlacement(columns, borderWidth) {\n    return useMemo(() => {\n        const placement = [];\n\n        columns.reduce((offset, column) => {\n            placement.push({\n                left: offset,\n                right: offset + column.width + borderWidth,\n                id: column.id\n            });\n\n            return offset + column.width + borderWidth;\n        }, 0);\n\n        return placement;\n    }, [columns, borderWidth]);\n}\n\nfunction useRowPlacement(rows, borderWidth) {\n    return useMemo(() => {\n        const placement = [];\n\n        rows.reduce((offset, row) => {\n            placement.push({\n                top: offset,\n                bottom: offset + row.height + borderWidth,\n                id: row.id\n            });\n\n            return offset + row.height + borderWidth;\n        }, 0);\n\n        return placement;\n    }, [rows, borderWidth]);\n}\n\nfunction findColumnIndex(placement, x) {\n    if (placement.length === 0)\n        return -1;\n    if (x < placement[0].left)\n        return -1;\n    if (x > placement[placement.length - 1].right)\n        return -1;\n\n    let iterA = 0;\n    let iterC = placement.length - 1;\n\n    while (iterA <= iterC) {\n        const iterB = Math.floor((iterA + iterC) / 2);\n\n        if (x < placement[iterB].left)\n            iterC = iterB - 1;\n        else if (x > placement[iterB].right)\n            iterA = iterB + 1;\n        else\n            return iterB;\n    }\n\n    return -1;\n}\n\nfunction findRowIndex(placement, y) {\n    if (placement.length === 0)\n        return -1;\n    if (y < placement[0].top)\n        return -1;\n    if (y > placement[placement.length - 1].bottom)\n        return -1;\n\n    let iterA = 0;\n    let iterC = placement.length - 1;\n\n    while (iterA <= iterC) {\n        const iterB = Math.floor((iterA + iterC) / 2);\n\n        if (y < placement[iterB].top)\n            iterC = iterB - 1;\n        else if (y > placement[iterB].bottom)\n            iterA = iterB + 1;\n        else\n            return iterB;\n    }\n\n    return -1;\n}\n\nfunction findHighlightedCells(focusedCell, hoveredCell, columns, rows, columnLookup, rowLookup) {\n    if (!hoveredCell)\n        return [];\n    if (!focusedCell)\n        return [];\n\n    const focusedColumnKey = stringifyId(focusedCell.columnId);\n    const focusedRowKey = stringifyId(focusedCell.rowId);\n    const hoveredColumnKey = stringifyId(hoveredCell.columnId);\n    const hoveredRowKey = stringifyId(hoveredCell.rowId);\n\n    if (!columnLookup.has(focusedColumnKey))\n        return [];\n    if (!rowLookup.has(focusedRowKey))\n        return [];\n    if (!columnLookup.has(hoveredColumnKey))\n        return [];\n    if (!rowLookup.has(hoveredRowKey))\n        return [];\n\n    const minColumnIndex = Math.min(columnLookup.get(focusedColumnKey).index, columnLookup.get(hoveredColumnKey).index);\n    const maxColumnIndex = Math.max(columnLookup.get(focusedColumnKey).index, columnLookup.get(hoveredColumnKey).index);\n    const minRowIndex = Math.min(rowLookup.get(focusedRowKey).index, rowLookup.get(hoveredRowKey).index);\n    const maxRowIndex = Math.max(rowLookup.get(focusedRowKey).index, rowLookup.get(hoveredRowKey).index);\n\n    return columns.slice(minColumnIndex, maxColumnIndex + 1).flatMap(column => {\n        return rows.slice(minRowIndex, maxRowIndex + 1).map(row => {\n            return {\n                rowId: row.id,\n                columnId: column.id\n            };\n        });\n    });\n}\n\nfunction getCellType(column, row) {\n    if (column.type === 'FILTER' ^ row.type === 'FILTER')\n        return 'FILTER';\n    if (column.type === 'DATA' && row.type === 'DATA')\n        return 'DATA';\n    return 'OTHER';\n}\n\nfunction getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup) {\n    return selectedCells.map(cell => {\n        const columnKey = stringifyId(cell.columnId);\n        const rowKey = stringifyId(cell.rowId);\n\n        if (!columnLookup.has(columnKey))\n            return null;\n        if (!rowLookup.has(rowKey))\n            return null;\n\n        const column = columnLookup.get(columnKey);\n        const row = rowLookup.get(rowKey);\n\n        return {\n            edit: formatResolver.resolve(row, column).edit,\n            cell: cell,\n            type: getCellType(column, row)\n        }\n    }).filter(cell => cell?.edit);\n}\n\nexport default function GridInteractions() {\n    // console.count('render GridInteractions');\n    const [text, setText] = useState('');\n    const [input, setInput] = useState(null);\n\n    const size = useClientSize();\n    const mousePosition = useMousePosition();\n    const isMouseDown = useIsMouseDown();\n    const focus = useFocus();\n    const scrollOffset = useScrollOffset();\n    const hoveredCell = useHoveredCell();\n    const focusedCell = useFocusedCell();\n    const borderWidth = useBorderWidth();\n\n    const selectedCells = useSelectedCells();\n    const setSelectedCells = useSetSelectedCells();\n    const setHighlightedCells = useSetHighlightedCells();\n    const setEditedCells = useSetEditedCells();\n    const setHoveredCell = useSetHoveredCell();\n    const setFocusedCell = useSetFocusedCell();\n    const addSelectedCells = useAddSelectedCells();\n    const addEditedCells = useAddEditedCells();\n    const addFilters = useAddFilters();\n    const removeEditedCells = useRemoveEditedCells();\n    const removeFilters = useRemoveFilters();\n\n    const columns = useColumns();\n    const rows = useRows();\n\n    const columnPlacement = useColumnPlacement(columns, borderWidth);\n    const rowPlacement = useRowPlacement(rows, borderWidth);\n\n    const fixedSize = useFixedSize();\n    const totalSize = useTotalSize();\n\n    const formatResolver = useInputFormatResolver();\n\n    const columnLookup = useMemo(() => columns.reduce((map, column) => map.set(column.key, column), new Map()), [columns]);\n    const rowLookup = useMemo(() => rows.reduce((map, row) => map.set(row.key, row), new Map()), [rows]);\n\n    const isTextValid = useMemo(() => {\n        const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n        return editableCells.every(cell => cell.edit.validate({ string: text }));\n    }, [selectedCells, formatResolver, columnLookup, rowLookup, text]);\n\n    // TODO: Invoke this function also directly on the mousemove event. Though leave it as a effect as well, so that it is invoked when the scrollOffset changes.\n    useEffect(() => {\n        if (!mousePosition) {\n            setHoveredCell(null);\n            return;\n        }\n\n        const x = mousePosition.x <= fixedSize.left\n            ? mousePosition.x\n            : mousePosition.x >= size.width - fixedSize.right\n                ? totalSize.width - size.width + mousePosition.x\n                : mousePosition.x + scrollOffset.left;\n        const y = mousePosition.y <= fixedSize.top\n            ? mousePosition.y\n            : mousePosition.y >= size.height - fixedSize.bottom\n                ? totalSize.height - size.height + mousePosition.y\n                : mousePosition.y + scrollOffset.top;\n\n        const hoverRowIndex = findRowIndex(rowPlacement, y);\n        const hoverColumnIndex = findColumnIndex(columnPlacement, x);\n\n        if (hoverRowIndex === -1 || hoverColumnIndex === -1) {\n            setHoveredCell(null);\n            return;\n        }\n\n        setHoveredCell({\n            rowId: rows[hoverRowIndex].id,\n            columnId: columns[hoverColumnIndex].id\n        });\n    }, [columnPlacement, columns, mousePosition, rowPlacement, rows, scrollOffset, setHoveredCell, size, fixedSize, totalSize]);\n\n    useEffect(() => {\n        // TODO: Make sure it behaves correctly when the mouse is moved outside the grid while the mouse button is down\n        if (!isMouseDown)\n            return;\n\n        setHighlightedCells(findHighlightedCells(focusedCell, hoveredCell, columns, rows, columnLookup, rowLookup));\n    }, [isMouseDown, hoveredCell, focusedCell, columns, rows, columnLookup, rowLookup, setHighlightedCells]);\n\n    useInteraction('mousedown', event => {\n        if (!hoveredCell)\n            return;\n\n        setText('');\n        setFocusedCell(hoveredCell);\n\n        if (!event.ctrlKey)\n            setSelectedCells([]);\n    });\n\n    useInteraction('mouseup', () => {\n        if (!focusedCell)\n            return;\n\n        addSelectedCells(findHighlightedCells(focusedCell, hoveredCell, columns, rows, columnLookup, rowLookup));\n        setHighlightedCells([]);\n    });\n\n    useInteraction('keydown', event => {\n        console.log('onKeyDown', event.key);\n\n        const arrowTo = (cell, event) => {\n            setFocusedCell(cell);\n\n            if (event.shiftKey)\n                addSelectedCells([cell]);\n            else\n                setSelectedCells([cell]);\n        };\n\n        const arrowHorizontally = (offset, event) => {\n            if (!focusedCell)\n                return;\n\n            const focusedColumnKey = stringifyId(focusedCell.columnId);\n            if (!columnLookup.has(focusedColumnKey))\n                return;\n\n            const focusedColumnIndex = columnLookup.get(focusedColumnKey).index;\n            const newColumnIndex = Math.max(0, Math.min(columns.length - 1, focusedColumnIndex + offset));\n            if (newColumnIndex === focusedColumnIndex)\n                return;\n\n            const newFocusedCell = { rowId: focusedCell.rowId, columnId: columns[newColumnIndex].id };\n\n            arrowTo(newFocusedCell, event);\n        }\n\n        const arrowVertically = (offset, event) => {\n            if (!focusedCell)\n                return;\n\n            const focusedRowKey = stringifyId(focusedCell.rowId);\n            if (!rowLookup.has(focusedRowKey))\n                return;\n\n            const focusedRowIndex = rowLookup.get(focusedRowKey).index;\n            const newRowIndex = Math.max(0, Math.min(rows.length - 1, focusedRowIndex + offset));\n            if (newRowIndex === focusedRowIndex)\n                return;\n\n            const newFocusedCell = { rowId: rows[newRowIndex].id, columnId: focusedCell.columnId };\n\n            arrowTo(newFocusedCell, event);\n        }\n\n        const preventDefault = () => {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n\n        const cancel = () => {\n            if (text !== '') {\n                setText('');\n            }\n            else if (focusedCell) {\n                setFocusedCell(null);\n                setSelectedCells([]);\n            }\n            else {\n                setEditedCells([]);\n            }\n        };\n\n        const accept = () => {\n            const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n\n            if (text === '')\n                return;\n            if (!editableCells.every(cell => cell.edit.validate({ string: text })))\n                return;\n\n            const dataCells = editableCells.filter(cell => cell.type === 'DATA');\n            const filterCells = editableCells.filter(cell => cell.type === 'FILTER');\n\n            addEditedCells(dataCells.map(cell => ({ ...cell.cell, value: cell.edit.parse({ string: text }) })));\n            addFilters(filterCells.map(cell => ({ ...cell.cell, expression: cell.edit.parse({ string: text }) })));\n\n            setText('');\n        };\n\n        const clear = () => {\n            removeEditedCells(selectedCells);\n            removeFilters(selectedCells);\n        }\n\n        switch (event.key) {\n            case 'Escape':\n                cancel();\n                break;\n            case 'Enter':\n                accept();\n                break;\n            case 'ArrowUp':\n                // TODO: When ctrl and shift are pressed together, select all cells between the focused cell and the new cell\n                // TODO: When shift is pressed, expand the current rect selection instead of moving the focused cell\n                preventDefault();\n                arrowVertically(event.ctrlKey ? -rows.length : -1, event);\n                break;\n            case 'ArrowDown':\n                preventDefault();\n                arrowVertically(event.ctrlKey ? rows.length : 1, event);\n                break;\n            case 'ArrowLeft':\n                preventDefault();\n                arrowHorizontally(event.ctrlKey ? -columns.length : -1, event);\n                break;\n            case 'ArrowRight':\n                preventDefault();\n                arrowHorizontally(event.ctrlKey ? columns.length : 1, event);\n                break;\n            case 'Delete':\n            case 'Backspace':\n                console.log('delete');\n                clear();\n                break;\n            default:\n                return;\n        }\n    });\n\n    useInteraction('dblclick', () => {\n        if (!focusedCell)\n            return;\n\n        const focusedColumnKey = stringifyId(focusedCell.columnId);\n        const focusedRowKey = stringifyId(focusedCell.rowId);\n\n        if (!columnLookup.has(focusedColumnKey))\n            return;\n        if (!rowLookup.has(focusedRowKey))\n            return;\n\n        const column = columnLookup.get(focusedColumnKey);\n        const row = rowLookup.get(focusedRowKey);\n        const cell = formatResolver.resolve(row, column);\n        const text = `${cell.value}` // TODO: Use the text, not value (???)\n\n        setText(text);\n    });\n\n    useInteraction('focus', () => {\n        console.log('refocusing on input');\n        input?.focus();\n    });\n\n    // TODO: Fix placement for fixed rows/columns\n    const inputPlacement = useMemo(() => {\n        if (!focusedCell)\n            return null;\n\n        const focusedColumnKey = stringifyId(focusedCell.columnId);\n        const focusedRowKey = stringifyId(focusedCell.rowId);\n\n        if (!columnLookup.has(focusedColumnKey))\n            return null;\n        if (!rowLookup.has(focusedRowKey))\n            return null;\n\n        const column = columnLookup.get(focusedColumnKey);\n        const row = rowLookup.get(focusedRowKey);\n        const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n\n        if (editableCells.length === 0)\n            return null;\n\n        return {\n            left: column.left,\n            top: row.top,\n            width: column.width,\n            height: row.height,\n            boxSizing: 'border-box',\n        };\n    }, [focusedCell, columnLookup, rowLookup, selectedCells, formatResolver]);\n\n    const inputHasFocus = input && document.activeElement === input;\n\n    useEffect(() => {\n        if (inputHasFocus && !inputPlacement)\n            focus();\n    }, [inputPlacement, inputHasFocus, focus]);\n\n    return (\n        <>\n            <GridInput ref={setInput} text={text} onTextChange={setText} placement={inputPlacement} isValid={isTextValid} />\n        </>\n    );\n}",
-        "/* eslint-disable import/prefer-default-export */\nimport React, { useState } from 'react';\nimport GridCanvas from './GridCanvas';\nimport GridInteractions from './GridInteractions';\nimport useDevicePixelRatio from '../hooks/useDevicePixelRatio';\nimport { MouseAndKeyboardProvider } from '../contexts/MouseAndKeyboardContext';\nimport { SizeAndScrollProvider } from '../contexts/SizeAndScrollContext';\nimport { ScrollRectProvider } from '../contexts/ScrollRectContext';\nimport { GridSectionProvider } from '../contexts/GridSectionContext';\n\n// TODO: Write description\nexport default function Grid() {\n    // TODO: Use intersection observer to only render the grid if it is in view\n    // TODO: Selected columns (selected rows): [{columnId: 'col1', headerId: 'default'}]\n    // TODO: Selected cells: [{rowId: 'row1', columnId: 'col1'}]\n    // TODO: Sorting: [{columnId: 'col1', headerId: 'default' , direction: 'ASC'}]\n    // TODO: Use headers (as well as fixed area boundaries) as separators and sort data only in between them\n    // TODO: Allow rows/columns to have parentId (or groupId?) to group them together and filter/sort them as a group\n    // TODO: wrap props into a function so that you can do setProps(prevProps => ...)\n\n    console.count('render Grid');\n\n    const [container, setContainer] = useState(null);\n\n    // TODO: Borders still seem to be blurry for large number of rows/columns\n    // TODO: Canvases should get this from the state context\n    const devicePixelRatio = useDevicePixelRatio();\n\n    // TODO: Display left/right/top/bottom borders for all fixed rows and display them for middle cells if no fixed rows/columns are present\n    // TODO: Memoize styles\n    // TODO: Remove hardcoded width/height\n    // TODO: Wrap the grid in another grid and set that grid's max width/height to the 100 vw/vh\n    return (\n        <div\n            className='spread-grid'\n            ref={setContainer}\n            tabIndex={0}\n            style={{ maxWidth: 'fit-content', maxHeight: 'fit-content', overflow: 'auto', display: 'grid', position: 'relative', gridTemplateColumns: 'auto auto auto', gridTemplateRows: 'auto auto auto', outline: 'none' }}\n        >\n            <SizeAndScrollProvider element={container}>\n                <ScrollRectProvider>\n                    <GridSectionProvider horizontal='left' vertical='top'>\n                        <GridCanvas\n                            style={{ position: 'sticky', left: 0, top: 0, zIndex: 2, gridRow: '1', gridColumn: '1' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n\n                    <GridSectionProvider horizontal='center' vertical='top'>\n                        <GridCanvas\n                            style={{ position: 'sticky', top: 0, zIndex: 1, gridRow: '1', gridColumn: '2' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n\n                    <GridSectionProvider horizontal='right' vertical='top'>\n                        <GridCanvas\n                            style={{ position: 'sticky', right: 0, top: 0, zIndex: 2, gridRow: '1', gridColumn: '3' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n\n                    <GridSectionProvider horizontal='left' vertical='middle'>\n                        <GridCanvas\n                            style={{ position: 'sticky', left: 0, zIndex: 1, gridRow: '2', gridColumn: '1' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n\n                    <GridSectionProvider horizontal='center' vertical='middle'>\n                        <GridCanvas\n                            style={{ gridRow: '2', gridColumn: '2' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n\n                    <GridSectionProvider horizontal='right' vertical='middle'>\n                        <GridCanvas\n                            style={{ position: 'sticky', right: 0, zIndex: 1, gridRow: '2', gridColumn: '3' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n\n                    <GridSectionProvider horizontal='left' vertical='bottom'>\n                        <GridCanvas\n                            style={{ position: 'sticky', left: 0, bottom: 0, zIndex: 2, gridRow: '3', gridColumn: '1' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n\n                    <GridSectionProvider horizontal='center' vertical='bottom'>\n                        <GridCanvas\n                            style={{ position: 'sticky', bottom: 0, zIndex: 1, gridRow: '3', gridColumn: '2' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n\n                    <GridSectionProvider horizontal='right' vertical='bottom'>\n                        <GridCanvas\n                            style={{ position: 'sticky', right: 0, bottom: 0, zIndex: 2, gridRow: '3', gridColumn: '3' }}\n                            devicePixelRatio={devicePixelRatio}\n                        />\n                    </GridSectionProvider>\n                </ScrollRectProvider>\n\n                <MouseAndKeyboardProvider element={container}>\n                    <GridInteractions />\n                </MouseAndKeyboardProvider>\n            </SizeAndScrollProvider>\n        </div>\n    );\n};\n",
-        "import React, { useState } from \"react\";\nimport { StateProvider } from \"../contexts/StateContext\";\nimport Grid from \"../fragments/Grid\";\n\nconst defaultData = [];\nconst defaultColumns = data => data.length > 0 ? Object.keys(data[0]).map(key => ({ id: key, width: 100 })) : [];\nconst defaultRows = data => [{ id: 'top-header', type: 'HEADER', height: 20 }, ...data.map((_, index) => ({ id: index, height: 20 }))];\nconst defaultFormatting = [];\nconst defaultDataSelector = ({data, row, column}) => data[row.id][column.id];\nconst defaultPinnedTop = 0;\nconst defaultPinnedBottom = 0;\nconst defaultPinnedLeft = 0;\nconst defaultPinnedRight = 0;\nconst defaultBorderWidth = 1;\n\nexport default function SpreadGrid(props) {\n    const [localSelectedCells, setLocalSelectedCells] = useState([]);\n    const [localHighlightedCells, setLocalHighlightedCells] = useState([]);\n    const [localEditedCells, setLocalEditedCells] = useState([]);\n    const [localFilters, setLocalFilters] = useState([]);\n    const [localHoveredCell, setLocalHoveredCell] = useState(null);\n    const [localFocusedCell, setLocalFocusedCell] = useState(null);\n\n    const data = 'data' in props ? props.data : defaultData;\n    const columns = 'columns' in props ? props.columns : defaultColumns;\n    const rows = 'rows' in props ? props.rows : defaultRows;\n    const formatting = 'formatting' in props ? props.formatting : defaultFormatting;\n    const dataSelector = 'dataSelector' in props ? props.dataSelector : defaultDataSelector;\n    const pinnedTop = 'pinnedTop' in props ? props.pinnedTop : defaultPinnedTop; // TODO: Throw error if pinnedTop + pinnedBottom > rows.length (and same for columns)\n    const pinnedBottom = 'pinnedBottom' in props ? props.pinnedBottom : defaultPinnedBottom;\n    const pinnedLeft = 'pinnedLeft' in props ? props.pinnedLeft : defaultPinnedLeft;\n    const pinnedRight = 'pinnedRight' in props ? props.pinnedRight : defaultPinnedRight;\n    const selectedCells = 'selectedCells' in props ? props.selectedCells : localSelectedCells;\n    const highlightedCells = 'highlightedCells' in props ? props.highlightedCells : localHighlightedCells;\n    const editedCells = 'editedCells' in props ? props.editedCells : localEditedCells;\n    const filters = 'filters' in props ? props.filters : localFilters;\n    const hoveredCell = 'hoveredCell' in props ? props.hoveredCell : localHoveredCell;\n    const focusedCell = 'focusedCell' in props ? props.focusedCell : localFocusedCell;\n    const borderWidth = 'borderWidth' in props ? props.borderWidth : defaultBorderWidth;\n\n    const onSelectedCellsChange = selectedCells => {\n        setLocalSelectedCells(selectedCells);\n        props.onSelectedCellsChange?.(selectedCells);\n    };\n    const onHighlightedCellsChange = highlightedCells => {\n        setLocalHighlightedCells(highlightedCells);\n        props.onHighlightedCellsChange?.(highlightedCells);\n    }\n    const onEditedCellsChange = editedCells => {\n        setLocalEditedCells(editedCells);\n        props.onEditedCellsChange?.(editedCells);\n    }\n    const onFiltersChange = filters => {\n        setLocalFilters(filters);\n        props.onFiltersChange?.(filters);\n    }\n    const onHoveredCellChange = hoveredCell => {\n        setLocalHoveredCell(hoveredCell);\n        props.onHoveredCellChange?.(hoveredCell);\n    }\n    const onFocusedCellChange = focusedCell => {\n        setLocalFocusedCell(focusedCell);\n        props.onFocusedCellChange?.(focusedCell);\n    }\n\n    return (\n        <StateProvider\n            data={data}\n            columns={columns}\n            rows={rows}\n            pinnedTop={pinnedTop}\n            pinnedBottom={pinnedBottom}\n            pinnedLeft={pinnedLeft}\n            pinnedRight={pinnedRight}\n            formatting={formatting}\n            dataSelector={dataSelector}\n            selectedCells={selectedCells}\n            highlightedCells={highlightedCells}\n            editedCells={editedCells}\n            filters={filters}\n            hoveredCell={hoveredCell}\n            focusedCell={focusedCell}\n            borderWidth={borderWidth}\n            onSelectedCellsChange={onSelectedCellsChange}\n            onHighlightedCellsChange={onHighlightedCellsChange}\n            onEditedCellsChange={onEditedCellsChange}\n            onFiltersChange={onFiltersChange}\n            onHoveredCellChange={onHoveredCellChange}\n            onFocusedCellChange={onFocusedCellChange}\n        >\n            <Grid />\n        </StateProvider>\n    );\n}",
-        "module.exports = window[\"PropTypes\"];",
-        "module.exports = window[\"React\"];",
+        "import { area, clip, contains, expand, subtract } from \"../core-utils/rect.js\";\n\nconst requiredMargin = 200;\nconst preloadedMargin = 400;\nconst emptyRect = {\n    left: 0,\n    top: 0,\n    width: 0,\n    height: 0\n};\n\nexport default function getScrollRect(previous, totalSize, fixedSize, element) {\n    // TODO: Is it optimal to use getBoundingClientRect()?\n    const size = {\n        width: element.getBoundingClientRect().width,\n        height: element.getBoundingClientRect().height\n    };\n    const scrollOffset = {\n        left: element.scrollLeft,\n        top: element.scrollTop\n    };\n\n    const prevScrollRect = previous || emptyRect;\n\n    const totalRect = { left: 0, top: 0, ...totalSize };\n    const bounds = subtract(totalRect, fixedSize);\n    const scrollRect = subtract({ ...scrollOffset, ...size }, fixedSize);\n    const requiredScrollRect = clip(bounds, expand(scrollRect, requiredMargin));\n    const preloadedScrollRect = clip(bounds, expand(scrollRect, preloadedMargin));\n\n    if (!contains(bounds, prevScrollRect))\n        return preloadedScrollRect;\n\n    if (!contains(prevScrollRect, requiredScrollRect))\n        return preloadedScrollRect;\n\n    if (area(prevScrollRect) > 2 * area(preloadedScrollRect))\n        return preloadedScrollRect;\n\n    return prevScrollRect;\n}\n",
+        "export default function getLookup(elements) {\n    return elements.reduce((lookup, element) => lookup.set(element.key, element), new Map());\n}\n",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\n\nexport default function getHighlightedCells(isMouseDown, isResizing, focusedCell, hoveredCell, columns, rows, columnLookup, rowLookup) {\n    if (!isMouseDown)\n        return [];\n    if (isResizing)\n        return [];\n    if (!hoveredCell)\n        return [];\n    if (!focusedCell)\n        return [];\n\n    const focusedColumnKey = stringifyId(focusedCell.columnId);\n    const focusedRowKey = stringifyId(focusedCell.rowId);\n    const hoveredColumnKey = stringifyId(hoveredCell.columnId);\n    const hoveredRowKey = stringifyId(hoveredCell.rowId);\n\n    if (!columnLookup.has(focusedColumnKey))\n        return [];\n    if (!rowLookup.has(focusedRowKey))\n        return [];\n    if (!columnLookup.has(hoveredColumnKey))\n        return [];\n    if (!rowLookup.has(hoveredRowKey))\n        return [];\n\n    const minColumnIndex = Math.min(columnLookup.get(focusedColumnKey).index, columnLookup.get(hoveredColumnKey).index);\n    const maxColumnIndex = Math.max(columnLookup.get(focusedColumnKey).index, columnLookup.get(hoveredColumnKey).index);\n    const minRowIndex = Math.min(rowLookup.get(focusedRowKey).index, rowLookup.get(hoveredRowKey).index);\n    const maxRowIndex = Math.max(rowLookup.get(focusedRowKey).index, rowLookup.get(hoveredRowKey).index);\n\n    return columns.slice(minColumnIndex, maxColumnIndex + 1).flatMap(column => {\n        return rows.slice(minRowIndex, maxRowIndex + 1).map(row => {\n            return {\n                rowId: row.id,\n                columnId: column.id\n            };\n        });\n    });\n}\n",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\n\nexport default function getInputPlacement(editableCells, focusedCell, columnLookup, rowLookup) {\n    if (!focusedCell)\n        return null;\n\n    const focusedColumnKey = stringifyId(focusedCell.columnId);\n    const focusedRowKey = stringifyId(focusedCell.rowId);\n\n    if (!columnLookup.has(focusedColumnKey))\n        return null;\n    if (!rowLookup.has(focusedRowKey))\n        return null;\n\n    const column = columnLookup.get(focusedColumnKey);\n    const row = rowLookup.get(focusedRowKey);\n\n    if (editableCells.length === 0)\n        return null;\n\n    return {\n        left: column.left,\n        top: row.top,\n        width: column.width,\n        height: row.height,\n        boxSizing: 'border-box',\n    };\n}\n",
+        "export default function getIsTextValid(text, editableCells) {\n    return editableCells.every(cell => cell.edit.validate({ string: text }));\n}\n",
+        "function getDefaultIds(elements) {\n    if (!Array.isArray(elements))\n        return Object.keys(elements);\n\n    return elements.map((_, index) => index);\n}\n\nfunction getDefaultRowIds(data) {\n    return getDefaultIds(data);\n}\n\nfunction getDefaultColumnIds(data) {\n    if (Array.isArray(data)) {\n        if (data.length > 0)\n            return Object.keys(data[0]);\n        return [];\n    } else {\n        const keys = Object.keys(data);\n        if (keys.length > 0)\n            return getDefaultIds(data[keys[0]]);\n        return [];\n    }\n}\n\nexport function getUnfoldedColumns(columns, data) {\n    const hasDataBlocks = columns.some(column => column.type === 'DATA-BLOCK');\n\n    if (!hasDataBlocks)\n        return columns;\n\n    const unfoldedColumns = [];\n\n    for (const column of columns) {\n        if (column.type === 'DATA-BLOCK') {\n            const ids = 'selector' in column\n                ? column.selector(data)\n                : getDefaultColumnIds(data);\n\n            for (const id of ids) {\n                unfoldedColumns.push({\n                    ...column,\n                    id,\n                    type: 'DATA'\n                });\n            }\n        } else {\n            unfoldedColumns.push(column);\n        }\n    }\n\n    return unfoldedColumns;\n}\n\nexport function getUnfoldedRows(rows, data) {\n    const hasDataBlocks = rows.some(row => row.type === 'DATA-BLOCK');\n\n    if (!hasDataBlocks)\n        return rows;\n\n    const unfoldedRows = [];\n\n    for (const row of rows) {\n        if (row.type === 'DATA-BLOCK') {\n            const ids = 'selector' in row\n                ? row.selector(data)\n                : getDefaultRowIds(data);\n\n            for (const id of ids) {\n                unfoldedRows.push({\n                    ...row,\n                    id,\n                    type: 'DATA'\n                });\n            }\n        } else {\n            unfoldedRows.push(row);\n        }\n    }\n\n    return unfoldedRows;\n}",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\nimport RulesLookup from \"./RulesLookup.js\";\n\nconst defaultCondition = ({ text, expression }) => text.includes(expression);\n\nexport default class FilteringRules {\n    constructor(rules) {\n        this.rulesLookup = new RulesLookup();\n\n        for (const rule of rules) {\n            const entry = {\n                by: stringifyId('by' in rule ? rule.by : 'FILTER'),\n                condition: rule.condition || defaultCondition\n            };\n\n            this.rulesLookup.addRule(rule.column, rule.row, entry);\n        }\n    }\n\n    resolve(data, rows, columns, row, column, value, text, filterLookup) {\n        const rules = this.rulesLookup.getRules(column, row);\n\n        if (rules.length === 0) {\n            if (row.type !== 'DATA')\n                return true;\n            if (column.type !== 'DATA')\n                return true;\n            if (!filterLookup.has('\"FILTER\"'))\n                return true;\n\n            return defaultCondition({ text, expression: filterLookup.get('\"FILTER\"') });\n        }\n\n        let context = { data, rows, columns, row, column, value, text };\n\n        for (const rule of rules) {\n            if (!filterLookup.has(rule.by))\n                continue;\n\n            const filterContext = { ...context, expression: filterLookup.get(rule.by) };\n\n            if (!rule.condition(filterContext))\n                return false;\n        }\n\n        return true;\n    }\n}",
+        "import FilteringRules from \"../types/FilteringRules.js\";\n\nexport default function getFilteringRules(filtering) {\n    return new FilteringRules(filtering);\n}",
+        "export default function getFilterFormatting(formatting) {\n    return formatting;\n}",
+        "export default function getMeasureFormatting(formatting) {\n    return formatting;\n}",
+        "import { defaultPadding } from \"../core-utils/defaults.js\";\n\n// TODO: add expand and expand-data\n\nexport function getMeasuredColumns(columns, rows, textResolver, formatResolver, measuringCache, presentKeys) {\n    if (columns.every(column => typeof column.width === 'number'))\n        return columns;\n\n    const measureColumn = column => {\n        const requestedWidth = 'width' in column ? column.width : 'fit-once';\n\n        if (typeof requestedWidth === 'number')\n            return requestedWidth;\n\n        if (measuringCache.has(column.key)) {\n            const cached = measuringCache.get(column.key);\n\n            if (requestedWidth === 'fit-once' && !cached.dataOnly)\n                return cached.width;\n            if (requestedWidth === 'fit-data-once' && cached.dataOnly)\n                return cached.width;\n        }\n\n        let width = 0;\n        for (const row of rows) {\n            if (row.type !== 'DATA' && requestedWidth === 'fit-data-once')\n                continue;\n            if (row.type !== 'DATA' && requestedWidth === 'fit-data')\n                continue;\n\n            const cell = formatResolver.resolve(row, column);\n            const text = cell.text;\n            const font = cell.font;\n            const padding = cell.padding.left + cell.padding.right;\n\n            const cellWidth = textResolver.measureWidth(text, font) + padding;\n\n            width = Math.max(width, cellWidth);\n        }\n\n        measuringCache.set(column.key, {\n            width,\n            dataOnly: requestedWidth === 'fit-data-once'\n        });\n\n        return width;\n    }\n\n    for (const key of measuringCache.keys()) {\n        if (!presentKeys.has(key))\n            measuringCache.delete(key);\n    }\n\n    return columns.map(column => ({\n        ...column,\n        width: measureColumn(column)\n    }));\n}\n\nexport function getMeasuredRows(columns, rows, textResolver, formatResolver, measuringCache, presentKeys) {\n    if (rows.every(row => typeof row.height === 'number'))\n        return rows;\n\n    const measureRow = row => {\n        const requestedHeight = 'height' in row ? row.height : 'fit-once';\n\n        if (typeof requestedHeight === 'number')\n            return requestedHeight;\n\n        if (measuringCache.has(row.key)) {\n            const cached = measuringCache.get(row.key);\n\n            if (requestedHeight === 'fit-once' && !cached.dataOnly)\n                return cached.height;\n            if (requestedHeight === 'fit-data-once' && cached.dataOnly)\n                return cached.height;\n        }\n\n        let height = 0;\n        for (const column of columns) {\n            if (column.type !== 'DATA' && requestedHeight === 'fit-data-once')\n                continue;\n            if (column.type !== 'DATA' && requestedHeight === 'fit-data')\n                continue;\n\n            const cell = formatResolver.resolve(row, column);\n            const text = cell.text;\n            const font = cell.font;\n            const padding = cell.padding.top + cell.padding.bottom;\n\n            const cellHeight = textResolver.measureHeight(text, font) + padding;\n\n            height = Math.max(height, cellHeight);\n        }\n\n        measuringCache.set(row.key, {\n            height,\n            dataOnly: requestedHeight === 'fit-data-once'\n        });\n\n        return height;\n    }\n\n    for (const key of measuringCache.keys()) {\n        if (!presentKeys.has(key))\n            measuringCache.delete(key);\n    }\n\n    return rows.map(row => ({\n        ...row,\n        height: measureRow(row)\n    }));\n}",
+        "export default function getKeys(entries) {\n    return new Set(entries.map(entry => entry.key));\n}\n",
+        "export default function getSortingFormatting(formatting) {\n    return formatting;\n}",
+        "import RulesLookup from \"./RulesLookup.js\";\n\nconst defaultComparatorAsc = (lhs, rhs) => lhs.value < rhs.value;\nconst defaultComparatorDesc = (lhs, rhs) => lhs.value > rhs.value;\n\nexport default class SortingRules {\n    constructor(rules) {\n        this.rulesLookup = new RulesLookup();\n\n        for (const rule of rules) {\n            const entry = {\n                by: stringifyId('by' in rule ? rule.by : 'HEADER'),\n                comparatorAsc: rule.comparator || defaultComparatorAsc,\n                comparatorDesc: (lhs, rhs) => -rule.comparator(lhs, rhs) || defaultComparatorDesc\n            };\n\n            this.rulesLookup.addRule(rule.column, rule.row, entry);\n        }\n    }\n\n    resolve(column, row, sortByLookup) {\n        const rules = this.rulesLookup.getRules(column, row);\n\n        if (rules.length === 0) {\n            if (row.type !== 'DATA')\n                return null;\n            if (column.type !== 'DATA')\n                return null;\n            if (!sortByLookup.has('\"HEADER\"'))\n                return null;\n\n            return sortByLookup.get('\"HEADER\"') === 'ASC'\n                ? defaultComparatorAsc\n                : defaultComparatorDesc;\n        }\n\n        if (rules.length > 1)\n            throw new Error('Multiple sorting rules for the same cell'); // TODO: add more context\n\n        const rule = rules[0];\n\n        return sortByLookup.get(rule.by) === 'ASC'\n            ? rule.comparatorAsc\n            : rule.comparatorDesc;\n    }\n}",
+        "import SortingRules from \"../types/SortingRules.js\";\n\nexport default function getSortingRules(sorting) {\n    return new SortingRules(sorting);\n}",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\n\nfunction getSortByLookup(sortBy, primaryKey, secondaryKey) {\n    const sortByLookup = new Map();\n    for (const cell of sortBy) {\n        const primary = stringifyId(cell[primaryKey]);\n        const secondary = stringifyId(cell[secondaryKey]);\n\n        if (!sortByLookup.has(primary))\n            sortByLookup.set(primary, new Map());\n\n        sortByLookup.get(primary).set(secondary, cell.direction);\n    }\n    return sortByLookup;\n}\n\nfunction flush(temp, result) {\n    temp.sort((lhs, rhs) => {\n        const result = lhs.comparator(lhs.cell, rhs.cell);\n        if (typeof result === 'number')\n            return result;\n        return result ? -1 : 1;\n    });\n    result.push(...temp.map(entry => entry.entity));\n    temp.length = 0;\n}\n\nexport function getSortedRows(sortBy, sortingRules, formattingRules, data, rows, columns, edition) {\n    if (sortBy.length === 0)\n        return rows;\n\n    const sortByLookup = getSortByLookup(sortBy, 'columnId', 'rowId');\n    const columnLookup = new Map(columns.map(column => [column.key, column]));\n    const sortedColumns = sortBy\n        .map(cell => stringifyId(cell.columnId))\n        .filter(key => columnLookup.has(key))\n        .map(key => columnLookup.get(key))\n        .reverse();\n\n    if (sortedColumns.length === 0)\n        return rows;\n\n    for (const column of sortedColumns) {\n        const result = [];\n        const temp = [];\n\n        for (const row of rows) {\n            const comparator = sortingRules.resolve(column, row, sortByLookup.get(column.key));\n\n            if (!comparator) {\n                flush(temp, result);\n                result.push(row);\n                continue;\n            }\n\n            const cell = formattingRules.resolve(data, rows, columns, row, column, edition);\n            const entry = { entity: row, comparator, cell };\n\n            if (temp.length === 0) {\n                temp.push(entry);\n                continue;\n            }\n\n            if (temp[0].comparator === comparator) {\n                temp.push(entry);\n                continue;\n            }\n\n            flush(temp, result);\n            temp.push(entry);\n        }\n\n        flush(temp, result);\n        rows = result;\n    }\n\n    return rows;\n}\n\nexport function getSortedColumns(sortBy, sortingRules, formattingRules, data, rows, columns, edition) {\n    if (sortBy.length === 0)\n        return columns;\n\n    const sortByLookup = getSortByLookup(sortBy, 'rowId', 'columnId');\n    const rowLookup = new Map(rows.map(row => [row.key, row]));\n    const sortedRows = sortBy\n        .map(cell => stringifyId(cell.rowId))\n        .filter(key => rowLookup.has(key))\n        .map(key => rowLookup.get(key))\n        .reverse();\n\n    if (sortedRows.length === 0)\n        return columns;\n\n    for (const row of sortedRows) {\n        const result = [];\n        const temp = [];\n\n        for (const column of columns) {\n            const comparator = sortingRules.resolve(column, row, sortByLookup.get(row.key));\n\n            if (!comparator) {\n                flush(temp, result);\n                result.push(column);\n                continue;\n            }\n\n            const cell = formattingRules.resolve(data, rows, columns, row, column, edition);\n            const entry = { entity: column, comparator, cell };\n\n            if (temp.length === 0) {\n                temp.push(entry);\n                continue;\n            }\n\n            if (temp[0].comparator === comparator) {\n                temp.push(entry);\n                continue;\n            }\n\n            flush(temp, result);\n            temp.push(entry);\n        }\n\n        flush(temp, result);\n        columns = result;\n    }\n\n    return columns;\n}",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\n\nconst grabOffset = 5;\n\n// TODO: not working when scrolled\n\nexport function getResizableColumn(columns, columnLookup, rowLookup, hoveredCell, mousePosition) {\n    if (!hoveredCell)\n        return null;\n\n    const column = columnLookup.get(stringifyId(hoveredCell.columnId));\n    const row = rowLookup.get(stringifyId(hoveredCell.rowId));\n    const x = mousePosition.x;\n\n    if (row.type !== 'HEADER')\n        return null;\n\n    if (x >= column.right - grabOffset && x <= column.right + grabOffset)\n        return column.id;\n\n    if (column.index === 0)\n        return null;\n    if (x < column.left - grabOffset || x > column.left + grabOffset)\n        return null;\n\n    return columns[column.index - 1].id;\n}\n\nexport function getResizableRow(rows, columnLookup, rowLookup, hoveredCell, mousePosition) {\n    if (!hoveredCell)\n        return null;\n\n    const column = columnLookup.get(stringifyId(hoveredCell.columnId));\n    const row = rowLookup.get(stringifyId(hoveredCell.rowId));\n    const y = mousePosition.y;\n\n    if (column.type !== 'HEADER')\n        return null;\n\n    if (y >= row.bottom - grabOffset && y <= row.bottom + grabOffset)\n        return row.id;\n\n    if (row.index === 0)\n        return null;\n    if (y < row.top - grabOffset || y > row.top + grabOffset)\n        return null;\n\n    return rows[row.index - 1].id;\n}",
+        "export default function getResolvedSortBy(sortBy) {\n    return sortBy.map(sort => ({\n        columnId: 'columnId' in sort ? sort.columnId : 'HEADER',\n        rowId: 'rowId' in sort ? sort.rowId : 'HEADER',\n        direction: sort.direction\n    }));\n}",
+        "import getEditableCells from \"../state-utils/getEditableCells.js\";\nimport getDataFormatting from \"../state-utils/getDataFormatting.js\";\nimport getInputFormatting from \"../state-utils/getInputFormatting.js\";\nimport getRenderFormatting from \"../state-utils/getRenderFormatting.js\";\nimport getSections from \"../state-utils/getSections.js\";\nimport getEditedCellsAndFilters from \"../state-utils/getEditedCellsAndFilters.js\";\nimport getEdition from \"../state-utils/getEdition.js\";\nimport getSelection from \"../state-utils/getSelection.js\";\nimport getInvoked from \"../state-utils/getInvoked.js\";\nimport { getResolvedColumns, getResolvedRows } from \"../state-utils/getResolved.js\";\nimport { getPlacedColumns, getPlacedRows } from \"../state-utils/getPlaced.js\";\nimport getFormattingRules from \"../state-utils/getFormattingRules.js\";\nimport getFormatResolver from \"../state-utils/getFormatResolver.js\";\nimport { getFilteredColumns as getFilteredColumns, getFilteredRows as getFilteredRows } from \"../state-utils/getFiltered.js\";\nimport getFixedSize from \"../state-utils/getFixedSize.js\";\nimport getTotalSize from \"../state-utils/getTotalSize.js\";\nimport getTextResolver from \"../state-utils/getTextResolver.js\";\nimport getScrollRect from \"../state-utils/getScrollRect.js\";\nimport getHoveredCell from \"../state-utils/getHoveredCell.js\";\nimport getLookup from \"../state-utils/getLookup.js\";\nimport getHighlightedCells from \"../state-utils/getHighlightedCells.js\";\nimport getInputPlacement from \"../state-utils/getInputPlacement.js\";\nimport getIsTextValid from \"../state-utils/getIsTextValid.js\";\nimport { getUnfoldedColumns, getUnfoldedRows } from \"../state-utils/getUnfolded.js\";\nimport getFilteringRules from \"../state-utils/getFilteringRules.js\";\nimport getFilterFormatting from \"../state-utils/getFilterFormatting.js\";\nimport getMeasureFormatting from \"../state-utils/getMeasureFormatting.js\";\nimport { getMeasuredColumns, getMeasuredRows } from \"../state-utils/getMeasured.js\";\nimport getKeys from \"../state-utils/getKeys.js\";\nimport getSortingFormatting from \"../state-utils/getSortingFormatting.js\";\nimport getSortingRules from \"../state-utils/getSortingRules.js\";\nimport { getSortedColumns, getSortedRows } from \"../state-utils/getSorted.js\";\nimport { getResizableColumn, getResizableRow } from \"../state-utils/getResizable.js\";\nimport getResolvedSortBy from \"../state-utils/getResolvedSortBy.js\";\n\n// TODO: write some test to check if the cache is working properly\nfunction updateStateInternal(context) {\n    console.count('updateState');\n\n    const options = { ...context.localOptions, ...context.externalOptions };\n    const memory = context.memory;\n    const previousState = context.state;\n\n    // TODO: Move to utils\n    function cache(key, func, dependencies) {\n        const previousDependencies = memory[key] && memory[key].dependencies;\n        if (!previousDependencies || dependencies.some((dependency, index) => dependency !== previousDependencies[index]))\n            memory[key] = { value: func(...dependencies), dependencies };\n        return memory[key].value;\n    }\n\n    const devicePixelRatio = window.devicePixelRatio; // TODO: Trigger update on devicePixelRatio change\n    const borderWidth = options.borderWidth / devicePixelRatio;\n    const data = options.data;\n    const text = context.input.value;\n    const sortBy = cache('sortBy', getResolvedSortBy, [options.sortBy]);\n    const textResolver = cache('textResolver', getTextResolver, []);\n    const dataFormatting = cache('dataFormatting', getDataFormatting, [options.formatting, options.dataSelector, sortBy]);\n    const editedCellsAndFilters = cache('editedCellsAndFilters', getEditedCellsAndFilters, [options.editedCells, options.filters]);\n    const edition = cache('edition', getEdition, [editedCellsAndFilters]);\n    const invokedColumns = cache('invokedColumns', getInvoked, [options.columns, data]);\n    const invokedRows = cache('invokedRows', getInvoked, [options.rows, data]);\n    // TODO: throw on duplicate ids\n    // TODO: throw on duplicate row/column filter ids\n    const unfoldedColumns = cache('unfoldedColumns', getUnfoldedColumns, [invokedColumns, data]);\n    const unfoldedRows = cache('unfoldedRows', getUnfoldedRows, [invokedRows, data]);\n    const unfilteredColumns = cache('unfilteredColumns', getResolvedColumns, [unfoldedColumns, options.pinnedLeft, options.pinnedRight, options.columnWidths]);\n    const unfilteredRows = cache('unfilteredRows', getResolvedRows, [unfoldedRows, options.pinnedTop, options.pinnedBottom, options.rowHeights]);\n    const unfilteredColumnKeys = cache('unfilteredColumnKeys', getKeys, [unfilteredColumns]);\n    const unfilteredRowKeys = cache('unfilteredRowKeys', getKeys, [unfilteredRows]);\n\n    // Filtering\n    const filterFormatting = cache('filterFormatting', getFilterFormatting, [dataFormatting]);\n    const filterFormattingRules = cache('filterFormattingRules', getFormattingRules, [filterFormatting]);\n    const filteringRules = cache('filteringRules', getFilteringRules, [options.filtering]);\n    const filteredColumns = cache('filteredColumns', getFilteredColumns, [options.filters, filteringRules, filterFormattingRules, data, unfilteredRows, unfilteredColumns, edition]);\n    const filteredRows = cache('filteredRows', getFilteredRows, [options.filters, filteringRules, filterFormattingRules, data, unfilteredRows, unfilteredColumns, edition]);\n\n    // Sorting\n    const sortingFormatting = cache('sortingFormatting', getSortingFormatting, [dataFormatting]);\n    const sortingFormattingRules = cache('sortingFormattingRules', getFormattingRules, [sortingFormatting]);\n    const sortingRules = cache('sortingRules', getSortingRules, [options.sorting]);\n    const sortedColumns = cache('sortedColumns', getSortedColumns, [sortBy, sortingRules, sortingFormattingRules, data, filteredRows, filteredColumns, edition]);\n    const sortedRows = cache('sortedRows', getSortedRows, [sortBy, sortingRules, sortingFormattingRules, data, filteredRows, filteredColumns, edition]);\n\n    // Shaping\n    const shapedColumns = sortedColumns;\n    const shapedRows = sortedRows;\n\n    // Measuring\n    const measureFormatting = cache('measureFormatting', getMeasureFormatting, [dataFormatting]);\n    const measureFormattingRules = cache('measureFormattingRules', getFormattingRules, [measureFormatting]);\n    const measureFormatResolver = cache('measureFormatResolver', getFormatResolver, [measureFormattingRules, data, shapedRows, shapedColumns, edition]);\n    const columnWidthCache = context.columnWidthCache;\n    const rowHeightCache = context.rowHeightCache;\n    const measuredColumns = cache('measuredColumns', getMeasuredColumns, [shapedColumns, shapedRows, textResolver, measureFormatResolver, columnWidthCache, unfilteredColumnKeys]);\n    const measuredRows = cache('measuredRows', getMeasuredRows, [shapedColumns, shapedRows, textResolver, measureFormatResolver, rowHeightCache, unfilteredRowKeys]);\n\n    // Placement\n    const columns = cache('columns', getPlacedColumns, [measuredColumns, devicePixelRatio, borderWidth]);\n    const rows = cache('rows', getPlacedRows, [measuredRows, devicePixelRatio, borderWidth]);\n    const columnLookup = cache('columnLookup', getLookup, [columns]);\n    const rowLookup = cache('rowLookup', getLookup, [rows]);\n    const focusedCell = options.focusedCell;\n    const sections = cache('sections', getSections, [columns, rows]);\n    const selectedCells = options.selectedCells;\n    const fixedSize = cache('fixedSize', getFixedSize, [sections.top.height, sections.bottom.height, sections.left.width, sections.right.width]);\n    const totalSize = cache('totalSize', getTotalSize, [columns, rows]);\n    // TODO: do some proper caching, so that if value is not changed, the old value is returned (currently not working because of scrolling)\n    const hoveredCell = getHoveredCell(context.element, context.mousePosition, rows, columns, fixedSize, totalSize);\n    const resizableColumn = context.resizingColumn || cache('resizableColumn', getResizableColumn, [columns, columnLookup, rowLookup, hoveredCell, context.mousePosition]);\n    const resizableRow = context.resizingRow || cache('resizableRow', getResizableRow, [rows, columnLookup, rowLookup, hoveredCell, context.mousePosition]);\n    const isMouseDown = context.isMouseDown;\n    const isResizing = !!resizableColumn || !!resizableRow;\n    const highlightedCells = cache('highlightedCells', getHighlightedCells, [isMouseDown, isResizing, focusedCell, hoveredCell, columns, rows, columnLookup, rowLookup]);\n    const selection = cache('selection', getSelection, [selectedCells]);\n    const highlight = cache('highlight', getSelection, [highlightedCells]);\n    // TODO: addDataFormattingRules and addRenderFormattingRules should remove unnecessary rules\n    const renderFormatting = cache('renderFormatting', getRenderFormatting, [dataFormatting, hoveredCell, focusedCell, selection, highlight, edition, resizableColumn, resizableRow]);\n    const renderFormattingRules = cache('renderFormattingRules', getFormattingRules, [renderFormatting]);\n    const renderFormatResolver = cache('renderFormatResolver', getFormatResolver, [renderFormattingRules, data, rows, columns, edition]);\n    const inputFormatting = cache('inputFormatting', getInputFormatting, [dataFormatting]);\n    const inputFormattingRules = cache('inputFormattingRules', getFormattingRules, [inputFormatting]);\n    const inputFormatResolver = cache('inputFormatResolver', getFormatResolver, [inputFormattingRules, data, rows, columns, edition]);\n    const editableCells = cache('editableCells', getEditableCells, [selectedCells, inputFormatResolver, columnLookup, rowLookup]);\n    const inputPlacement = cache('inputPlacement', getInputPlacement, [editableCells, focusedCell, columnLookup, rowLookup]);\n    const isTextValid = cache('isTextValid', getIsTextValid, [text, editableCells]);\n\n    // cache result, but not call\n    const scrollRect = getScrollRect(previousState?.scrollRect, totalSize, fixedSize, context.element);\n\n    context.state = {\n        options,\n        devicePixelRatio,\n        borderWidth,\n        data,\n        dataFormatting,\n        edition,\n        filteredColumns,\n        filteredRows,\n        columns,\n        rows,\n        sections,\n        selectedCells,\n        selection,\n        highlight,\n        hoveredCell,\n        focusedCell,\n        renderFormatting,\n        renderFormatResolver,\n        inputFormatting,\n        inputFormatResolver,\n        fixedSize,\n        totalSize,\n        textResolver,\n        scrollRect,\n        highlightedCells,\n        inputPlacement,\n        columnLookup,\n        rowLookup,\n        text,\n        isTextValid,\n        resizableColumn,\n        resizableRow,\n    };\n}\n\nexport default function updateState(context) {\n    if (!context.error) {\n        try {\n            updateStateInternal(context);\n        } catch (error) {\n            context.error = error;\n        }\n    }\n}",
+        "import getColumnIndex from \"./getColumnIndex.js\";\nimport getRowIndex from \"./getRowIndex.js\";\n\nexport default function getHoveredCell(element, mousePosition, rows, columns, fixedSize, totalSize) {\n    // TODO: sometimes mousePosition is outside of bounds and it crashes the click events\n\n    if (!mousePosition)\n        return null;\n    if (mousePosition.x < 0 || mousePosition.y < 0 || mousePosition.x > totalSize.width || mousePosition.y > totalSize.height)\n        return null;\n\n    const scrollOffset = {\n        left: element.scrollLeft,\n        top: element.scrollTop\n    };\n\n    const clientSize = {\n        width: element.clientWidth,\n        height: element.clientHeight\n    };\n\n    const x = mousePosition.x <= fixedSize.left\n        ? mousePosition.x\n        : mousePosition.x >= clientSize.width - fixedSize.right\n            ? totalSize.width - clientSize.width + mousePosition.x\n            : mousePosition.x + scrollOffset.left;\n    const y = mousePosition.y <= fixedSize.top\n        ? mousePosition.y\n        : mousePosition.y >= clientSize.height - fixedSize.bottom\n            ? totalSize.height - clientSize.height + mousePosition.y\n            : mousePosition.y + scrollOffset.top;\n\n    const hoverRowIndex = getRowIndex(rows, y);\n    const hoverColumnIndex = getColumnIndex(columns, x);\n\n    if (hoverRowIndex === -1 || hoverColumnIndex === -1)\n        return null;\n\n    return {\n        rowId: rows[hoverRowIndex].id,\n        columnId: columns[hoverColumnIndex].id\n    };\n}\n",
+        "export default function getRowIndex(rows, y) {\n    if (rows.length === 0)\n        return -1;\n    if (y < rows[0].topWithBorder)\n        return -1;\n    if (y > rows[rows.length - 1].bottomWithBorder)\n        return -1;\n\n    let iterA = 0;\n    let iterC = rows.length - 1;\n\n    while (iterA <= iterC) {\n        const iterB = Math.floor((iterA + iterC) / 2);\n\n        if (y < rows[iterB].topWithBorder)\n            iterC = iterB - 1;\n        else if (y > rows[iterB].bottomWithBorder)\n            iterA = iterB + 1;\n\n        else\n            return iterB;\n    }\n\n    return -1;\n}\n",
+        "export default function getColumnIndex(columns, x) {\n    if (columns.length === 0)\n        return -1;\n    if (x < columns[0].leftWithBorder)\n        return -1;\n    if (x > columns[columns.length - 1].rightWithBorder)\n        return -1;\n\n    let iterA = 0;\n    let iterC = columns.length - 1;\n\n    while (iterA <= iterC) {\n        const iterB = Math.floor((iterA + iterC) / 2);\n\n        if (x < columns[iterB].leftWithBorder)\n            iterC = iterB - 1;\n        else if (x > columns[iterB].rightWithBorder)\n            iterA = iterB + 1;\n\n        else\n            return iterB;\n    }\n\n    return -1;\n}\n",
+        "import Selection from \"../types/Selection.js\";\n\nexport default function getCombinedCells(previousCells, newCells) {\n    const selection = new Selection(newCells);\n    return [...newCells, ...previousCells.filter(cell => !selection.isIdSelected(cell.rowId, cell.columnId))];\n}\n",
+        "import Selection from \"../types/Selection.js\";\n\nexport default function getReducedCells(previousCells, cellsToRemove) {\n    const selection = new Selection(cellsToRemove);\n    return previousCells.filter(cell => !selection.isIdSelected(cell.rowId, cell.columnId));\n}\n",
+        "export default function getMousePosition(event) {\n    const element = event.currentTarget;\n    const rect = element.getBoundingClientRect();\n    return {\n        x: event.clientX - rect.left,\n        y: event.clientY - rect.top\n    };\n}",
+        "import getEditableCells from \"./state-utils/getEditableCells.js\";\nimport stringifyId from \"./core-utils/stringifyId.js\";\nimport render from \"./core/render.js\";\nimport updateState from \"./core/state.js\";\nimport getCombinedCells from \"./state-utils/getCombinedCells.js\";\nimport getReducedCells from \"./state-utils/getReducedCells.js\";\nimport getMousePosition from \"./state-utils/getMousePosition.js\";\nimport getNewSortBy from \"./state-utils/getNewSortBy.js\";\nimport getClipboardData from \"./state-utils/getClipboardData.js\";\n\nfunction initialize(element) {\n    if ('spread-grid-context' in element) return;\n\n    console.log('initialize');\n\n    const canvases = {\n        'top-left': document.createElement('canvas'),\n        'top-center': document.createElement('canvas'),\n        'top-right': document.createElement('canvas'),\n        'middle-left': document.createElement('canvas'),\n        'middle-center': document.createElement('canvas'),\n        'middle-right': document.createElement('canvas'),\n        'bottom-left': document.createElement('canvas'),\n        'bottom-center': document.createElement('canvas'),\n        'bottom-right': document.createElement('canvas')\n    };\n    const input = document.createElement('input');\n\n    element.setAttribute('tabindex', '0');\n    element.setAttribute('style', 'max-width: 100vw; max-height: 100vh; overflow: auto; display: grid; position: relative; grid-template-columns: fit-content(0) fit-content(0) fit-content(0); grid-template-rows: fit-content(0) fit-content(0) fit-content(0); outline: none; user-select: none;');\n    element.classList.add('spread-grid');\n    canvases['top-left'].setAttribute('style', 'position: sticky; left: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 1;');\n    canvases['top-center'].setAttribute('style', 'position: sticky; top: 0; z-index: 1; grid-row: 1; grid-column: 2;');\n    canvases['top-right'].setAttribute('style', 'position: sticky; right: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 3;');\n    canvases['middle-left'].setAttribute('style', 'position: sticky; left: 0; z-index: 1; grid-row: 2; grid-column: 1;');\n    canvases['middle-center'].setAttribute('style', 'grid-row: 2; grid-column: 2;');\n    canvases['middle-right'].setAttribute('style', 'position: sticky; right: 0; z-index: 1; grid-row: 2; grid-column: 3;');\n    canvases['bottom-left'].setAttribute('style', 'position: sticky; left: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 1;');\n    canvases['bottom-center'].setAttribute('style', 'position: sticky; bottom: 0; z-index: 1; grid-row: 3; grid-column: 2;');\n    canvases['bottom-right'].setAttribute('style', 'position: sticky; right: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 3;');\n    input.setAttribute('style', 'position: absolute; z-index: 3; outline: none; border: none; box-shadow: none; padding: 0 5px; font-size: 12px; font-family: Calibri; background-color: white; box-sizing: border-box; opacity: 0; pointer-events: none;');\n\n    const context = {\n        externalOptions: {},\n        state: null,\n        memory: {},\n        element: element,\n        canvases: canvases,\n        input: input,\n        renderRequested: false,\n        mousePosition: null,\n        isMouseDown: false,\n        columnWidthCache: new Map(),\n        rowHeightCache: new Map(),\n    };\n\n    context.requestNewRender = () => {\n        if (context.renderRequested) return;\n        context.renderRequested = true;\n        requestAnimationFrame(() => {\n            context.renderRequested = false;\n            updateState(context);\n            render(context);\n        });\n    };\n\n    context.addEventListener = (element, type, listener) => {\n        element.addEventListener(type, (event) => {\n            try {\n                listener(event);\n            }\n            catch (error) {\n                error.message = `[${type} event]: ${error.message}`;\n                context.error = error;\n                context.requestNewRender();\n            }\n        });\n    }\n\n    context.localOptions = {\n        data: [],\n        columns: [{ type: 'DATA-BLOCK' }],\n        rows: [{ type: 'HEADER' }, { type: 'DATA-BLOCK' }],\n        formatting: [],\n        filtering: [],\n        sorting: [],\n        dataSelector: ({ data, row, column }) => data[row.id][column.id],\n        pinnedTop: 0,\n        pinnedBottom: 0,\n        pinnedLeft: 0,\n        pinnedRight: 0,\n        borderWidth: 1,\n        focusedCell: null,\n        onFocusedCellChange: (focusedCell) => {\n            context.localOptions.focusedCell = focusedCell;\n            context.requestNewRender();\n        },\n        selectedCells: [],\n        onSelectedCellsChange: (selectedCells) => {\n            context.localOptions.selectedCells = selectedCells;\n            context.requestNewRender();\n        },\n        highlightedCells: [],\n        editedCells: [],\n        onEditedCellsChange: (editedCells) => {\n            // TODO: optimize by coalescing\n            context.localOptions.editedCells = editedCells;\n            context.requestNewRender();\n        },\n        filters: [],\n        onFiltersChange: (filters) => {\n            context.localOptions.filters = filters;\n            context.requestNewRender();\n        },\n        sortBy: [],\n        onSortByChange: (sortBy) => {\n            context.localOptions.sortBy = sortBy;\n            context.requestNewRender();\n        },\n        onCellClick: () => { },\n        onCustomCellClick: () => { },\n        columnWidths: [],\n        onColumnWidthsChange: (columnWidths) => {\n            context.localOptions.columnWidths = columnWidths;\n            context.requestNewRender();\n        },\n        rowHeights: [],\n        onRowHeightsChange: (rowHeights) => {\n            context.localOptions.rowHeights = rowHeights;\n            context.requestNewRender();\n        }\n    };\n\n    element['spread-grid-context'] = context;\n\n    const setText = (text) => {\n        input.value = text;\n        input.dispatchEvent(new Event('input'));\n    }\n\n    const accept = (autoCommit) => {\n        const selectedCells = context.state.options.selectedCells;\n        const formatResolver = context.state.inputFormatResolver;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const text = context.state.text;\n        const isTextValid = context.state.isTextValid;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const setFilters = context.state.options.onFiltersChange;\n        const addEditedCells = (cells) => setEditedCells(getCombinedCells(context.state.options.editedCells, cells));\n        const addFilters = (cells) => setFilters(getCombinedCells(context.state.options.filters, cells));\n        const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n\n        if (text === '')\n            return;\n        if (!isTextValid)\n            return;\n        if (autoCommit && !editableCells.every(cell => cell.edit.autoCommit))\n            return;\n\n        const dataCells = editableCells.filter(cell => cell.type === 'DATA');\n        const filterCells = editableCells.filter(cell => cell.type === 'FILTER');\n\n        addEditedCells(dataCells.map(cell => ({ ...cell.cell, value: cell.edit.parse({ string: text }) })));\n        addFilters(filterCells.map(cell => ({ ...cell.cell, expression: cell.edit.parse({ string: text }) })));\n\n        if (!autoCommit)\n            setText('');\n    };\n\n    const clear = (autoCommit) => {\n        const selectedCells = context.state.options.selectedCells;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const setFilters = context.state.options.onFiltersChange;\n        const removeEditedCells = (cells) => setEditedCells(getReducedCells(context.state.options.editedCells, cells));\n        const removeFilters = (cells) => setFilters(getReducedCells(context.state.options.filters, cells));\n        const formatResolver = context.state.inputFormatResolver;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const editableCells = getEditableCells(selectedCells, formatResolver, columnLookup, rowLookup);\n\n        if (autoCommit && !editableCells.every(cell => cell.edit.autoCommit))\n            return;\n\n        removeEditedCells(selectedCells);\n        removeFilters(selectedCells);\n    }\n\n    // TODO: Move other input functions here as well\n\n    context.addEventListener(element, 'scroll', (event) => {\n        // TODO: only request new render if scroll position changed outside of the scope\n        // TODO: how to: calculate the new scrollRect here and compare it to the one in the state\n        // TODO: Also don't forget to check if the highlighted cell did change\n        // TODO: Consider forcing a new render when visible scrollRect changes (without waiting for the next render frame)\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseenter', (event) => {\n        context.mousePosition = getMousePosition(event);\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mousemove', (event) => {\n        context.mousePosition = getMousePosition(event);\n\n        if (context.resizingColumn) {\n            const column = context.state.columnLookup.get(stringifyId(context.resizingColumn));\n            const columnWidth = column.width;\n            const columnRight = column.right;\n            const mousePosition = context.mousePosition.x;\n            const newColumnWidth = Math.max(10, mousePosition - columnRight + columnWidth);\n            const previousColumnWidths = context.state.options.columnWidths;\n            const newColumnWidths = previousColumnWidths\n                .filter(columnWidth => stringifyId(columnWidth.columnId) !== column.key)\n                .concat([{ columnId: column.id, width: newColumnWidth }]);\n            context.state.options.onColumnWidthsChange(newColumnWidths);\n        }\n        if (context.resizingRow) {\n            const row = context.state.rowLookup.get(stringifyId(context.resizingRow));\n            const rowHeight = row.height;\n            const rowBottom = row.bottom;\n            const mousePosition = context.mousePosition.y;\n            const newRowHeight = Math.max(10, mousePosition - rowBottom + rowHeight);\n            const previousRowHeights = context.state.options.rowHeights;\n            const newRowHeights = previousRowHeights\n                .filter(rowHeight => stringifyId(rowHeight.rowId) !== row.key)\n                .concat([{ rowId: row.id, height: newRowHeight }]);\n            context.state.options.onRowHeightsChange(newRowHeights);\n        }\n\n        // TODO: only request new render if hovered cell changed\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseleave', () => {\n        context.mousePosition = null;\n        context.requestNewRender();\n    });\n\n    // TODO: update mouse position on resize\n\n    context.addEventListener(element, 'mousedown', (event) => {\n        updateState(context);\n        setText('');\n\n        context.isMouseDown = true;\n        context.mouseDownPosition = context.mousePosition;\n        context.mouseDownCell = context.state.hoveredCell;\n\n        if (context.state.resizableColumn) {\n            context.resizingColumn = context.state.resizableColumn;\n        }\n        if (context.state.resizableRow) {\n            context.resizingRow = context.state.resizableRow;\n        }\n        if (!context.state.resizableColumn && !context.state.resizableRow) {\n            context.state.options.onFocusedCellChange(context.state.hoveredCell);\n        }\n\n        if (!event.ctrlKey)\n            context.state.options.onSelectedCellsChange([]);\n\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'mouseup', (event) => {\n        updateState(context);\n\n        context.isMouseDown = false;\n        context.resizingColumn = null;\n        context.resizingRow = null;\n\n        context.state.options.onSelectedCellsChange(getCombinedCells(context.state.options.selectedCells, context.state.highlightedCells));\n        context.requestNewRender();\n    });\n\n    context.addEventListener(element, 'pointerdown', (event) => {\n        context.element.setPointerCapture(event.pointerId);\n    });\n\n    context.addEventListener(element, 'pointerup', (event) => {\n        context.element.releasePointerCapture(event.pointerId);\n    });\n\n    context.addEventListener(element, 'click', (event) => {\n        updateState(context);\n\n        const cell = context.state.hoveredCell;\n        const mouseDownCell = context.mouseDownCell;\n\n        if (context.state.resizableColumn || context.state.resizableRow)\n            return;\n        if (cell === null)\n            return;\n        if (stringifyId(cell.columnId) !== stringifyId(mouseDownCell.columnId))\n            return;\n        if (stringifyId(cell.rowId) !== stringifyId(mouseDownCell.rowId))\n            return;\n\n        const column = context.state.columnLookup.get(stringifyId(cell.columnId));\n        const row = context.state.rowLookup.get(stringifyId(cell.rowId));\n        const sortBy = context.state.options.sortBy;\n\n        if (column.type === 'DATA' && row.type === 'DATA') {\n            context.state.options.onCellClick(context.state.hoveredCell);\n        } else if (column.type === 'CUSTOM' || row.type === 'CUSTOM') {\n            context.state.options.onCustomCellClick(context.state.hoveredCell);\n        } else if (column.type === 'HEADER' || row.type === 'HEADER') {\n            const newSortBy = getNewSortBy(sortBy, column, row, event.ctrlKey);\n            context.state.options.onSortByChange(newSortBy);\n            context.state.options.onSelectedCellsChange([]);\n        }\n    });\n\n    context.addEventListener(element, 'dblclick', (event) => {\n        updateState(context);\n\n        if (context.state.resizableColumn) {\n            const resizableColumnKey = stringifyId(context.state.resizableColumn);\n            const newColumnWidths = context.state.options.columnWidths.filter(columnWidth => stringifyId(columnWidth.columnId) !== resizableColumnKey);\n            context.state.options.onColumnWidthsChange(newColumnWidths);\n            context.columnWidthCache.delete(resizableColumnKey);\n        }\n        if (context.state.resizableRow) {\n            const resizableRowKey = stringifyId(context.state.resizableRow);\n            const newRowHeights = context.state.options.rowHeights.filter(rowHeight => stringifyId(rowHeight.rowId) !== resizableRowKey);\n            context.state.options.onRowHeightsChange(newRowHeights);\n            context.rowHeightCache.delete(resizableRowKey);\n        }\n\n        const focusedCell = context.state.focusedCell;\n        if (focusedCell === null)\n            return;\n\n        const focusedColumnKey = stringifyId(focusedCell.columnId);\n        const focusedRowKey = stringifyId(focusedCell.rowId);\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const formatResolver = context.state.inputFormatResolver;\n\n        if (!columnLookup.has(focusedColumnKey))\n            return;\n        if (!rowLookup.has(focusedRowKey))\n            return;\n\n        const column = columnLookup.get(focusedColumnKey);\n        const row = rowLookup.get(focusedRowKey);\n        const cell = formatResolver.resolve(row, column);\n        const text = cell.text; // TODO: Make it configurable\n\n        setText(text);\n        input?.select();\n    });\n\n    context.addEventListener(element, 'focus', () => {\n        if (input.parentElement)\n            input.focus();\n    });\n\n    context.addEventListener(element, 'keydown', (event) => {\n        // TODO: make sure it's not invoked on keydown of the input\n        updateState(context);\n\n        const focusedCell = context.state.focusedCell;\n        const columnLookup = context.state.columnLookup;\n        const rowLookup = context.state.rowLookup;\n        const selectedCells = context.state.options.selectedCells;\n        const setSelectedCells = context.state.options.onSelectedCellsChange;\n        const addSelectedCells = (cells) => setSelectedCells(getCombinedCells(selectedCells, cells));\n        const setFocusedCell = context.state.options.onFocusedCellChange;\n        const editedCells = context.state.options.editedCells;\n        const setEditedCells = context.state.options.onEditedCellsChange;\n        const columns = context.state.columns;\n        const rows = context.state.rows;\n        const text = context.state.text;\n        const inputFormatResolver = context.state.inputFormatResolver;\n\n        const arrowTo = (cell, event) => {\n            setFocusedCell(cell);\n\n            if (event.shiftKey)\n                addSelectedCells([cell]);\n            else\n                setSelectedCells([cell]);\n        };\n\n        const arrowHorizontally = (offset, event) => {\n            if (!focusedCell)\n                return;\n\n            const focusedColumnKey = stringifyId(focusedCell.columnId);\n            if (!columnLookup.has(focusedColumnKey))\n                return;\n\n            const focusedColumnIndex = columnLookup.get(focusedColumnKey).index;\n            const newColumnIndex = Math.max(0, Math.min(columns.length - 1, focusedColumnIndex + offset));\n            if (newColumnIndex === focusedColumnIndex)\n                return;\n\n            const newFocusedCell = { rowId: focusedCell.rowId, columnId: columns[newColumnIndex].id };\n\n            arrowTo(newFocusedCell, event);\n        }\n\n        const arrowVertically = (offset, event) => {\n            if (!focusedCell)\n                return;\n\n            const focusedRowKey = stringifyId(focusedCell.rowId);\n            if (!rowLookup.has(focusedRowKey))\n                return;\n\n            const focusedRowIndex = rowLookup.get(focusedRowKey).index;\n            const newRowIndex = Math.max(0, Math.min(rows.length - 1, focusedRowIndex + offset));\n            if (newRowIndex === focusedRowIndex)\n                return;\n\n            const newFocusedCell = { rowId: rows[newRowIndex].id, columnId: focusedCell.columnId };\n\n            arrowTo(newFocusedCell, event);\n        }\n\n        const preventDefault = () => {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n\n        const cancel = () => {\n            if (text !== '') {\n                setText('');\n            }\n            else if (selectedCells.length > 1) {\n                setSelectedCells([focusedCell]);\n            }\n            else if (editedCells.length > 0) {\n                setEditedCells([]);\n            }\n            else {\n                setFocusedCell(null);\n                setSelectedCells([]);\n            }\n        };\n\n        const copyToClipboard = (event) => {\n            if (!event.ctrlKey)\n                return;\n\n            const clipboardData = getClipboardData(selectedCells, columns, rows, inputFormatResolver);\n            navigator.clipboard.writeText(clipboardData);\n        }\n\n        switch (event.key) {\n            case 'Escape':\n                cancel();\n                break;\n            case 'Enter':\n                accept();\n                break;\n            case 'ArrowUp':\n                // TODO: When ctrl and shift are pressed together, select all cells between the focused cell and the new cell\n                // TODO: When shift is pressed, expand the current rect selection instead of moving the focused cell\n                preventDefault();\n                arrowVertically(event.ctrlKey ? -rows.length : -1, event);\n                break;\n            case 'ArrowDown':\n                preventDefault();\n                arrowVertically(event.ctrlKey ? rows.length : 1, event);\n                break;\n            case 'ArrowLeft':\n                preventDefault();\n                arrowHorizontally(event.ctrlKey ? -columns.length : -1, event);\n                break;\n            case 'ArrowRight':\n                preventDefault();\n                arrowHorizontally(event.ctrlKey ? columns.length : 1, event);\n                break;\n            case 'Delete':\n            case 'Backspace':\n                clear();\n                break;\n            case 'c':\n                copyToClipboard(event);\n                break;\n            default:\n                break;\n        }\n    });\n\n    new ResizeObserver(() => {\n        context.requestNewRender();\n    }).observe(element);\n\n    context.addEventListener(input, 'input', (event) => {\n        // TODO: check performance of this (if it's ok to update the state on every input event)\n        updateState(context);\n\n        if (event.target.value) {\n            accept(true);\n\n            input.style.opacity = 1;\n            input.style.pointerEvents = 'auto';\n        }\n        else {\n            if (event.isTrusted)\n                clear(true);\n\n            input.style.opacity = 0;\n            input.style.pointerEvents = 'none';\n        }\n    });\n\n    context.addEventListener(input, 'click', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'dblclick', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'mousedown', (event) => {\n        event.stopPropagation();\n    });\n\n    context.addEventListener(input, 'keydown', (event) => {\n        switch (event.key) {\n            case 'Enter':\n            case 'Escape':\n                break;\n            case 'Delete':\n            case 'Backspace':\n            case 'ArrowUp':\n            case 'ArrowDown':\n            case 'ArrowLeft':\n            case 'ArrowRight':\n                if (input.value !== '') {\n                    event.stopPropagation();\n                    context.requestNewRender();\n                }\n                break;\n            default:\n                event.stopPropagation();\n                // TODO: maybe only check if the new text is valid\n                context.requestNewRender();\n                break;\n        }\n    });\n}\n\nexport default function createGrid(element, options) {\n    console.log('createGrid');\n\n    initialize(element);\n\n    const context = element['spread-grid-context'];\n    context.externalOptions = options;\n\n    if (context.state === null) {\n        updateState(context);\n        // TODO: only render if the state has sufficiently changed\n        render(context);\n    }\n    else {\n        context.requestNewRender();\n    }\n}",
+        "import stringifyId from '../core-utils/stringifyId.js';\n\nexport default function getNewSortBy(sortBy, column, row, ctrlKey) {\n    // TODO: better support for multi-row sorting\n\n    function isCurrentRule(rule) {\n        return column.key === stringifyId(rule.columnId || 'HEADER') && row.key === stringifyId(rule.rowId || 'HEADER');\n    }\n\n    const directionLoop = ['ASC', 'DESC', undefined];\n    const currentRule = sortBy.find(isCurrentRule);\n    const directionIndex = directionLoop.indexOf(currentRule?.direction);\n    const newDirection = directionLoop[(directionIndex + 1) % directionLoop.length];\n    const isLastRule = sortBy.indexOf(currentRule) === sortBy.length - 1;\n    const shouldKeepOld = ctrlKey && (isLastRule || !currentRule);\n    const rulesToKeep = shouldKeepOld ? sortBy.filter(rule => !isCurrentRule(rule)) : [];\n    const newRules = newDirection ? [{ columnId: column.id, rowId: row.id, direction: newDirection }] : [];\n\n    return [...rulesToKeep, ...newRules];\n}",
+        "import stringifyId from \"../core-utils/stringifyId.js\";\nimport Selection from \"../types/Selection.js\";\n\nexport default function getClipboardData(selectedCells, columns, rows, formatResolver) {\n    const columnLookup = new Map(columns.map(column => [column.key, column]));\n    const rowLookup = new Map(rows.map(row => [row.key, row]));\n    const selectedCellKeys = selectedCells.map(cell => ({\n        columnKey: stringifyId(cell.columnId),\n        rowKey: stringifyId(cell.rowId)\n    })).filter(cell => columnLookup.has(cell.columnKey) && rowLookup.has(cell.rowKey));\n    const selectedColumns = new Set(selectedCellKeys.map(cell => cell.columnKey));\n    const selectedRows = new Set(selectedCellKeys.map(cell => cell.rowKey));\n\n    if (selectedCellKeys.length === 0)\n        return '';\n\n    const selection = new Selection(selectedCells);\n    const minColumnIndex = Math.min(...selectedCellKeys.map(cell => columnLookup.get(cell.columnKey).index));\n    const maxColumnIndex = Math.max(...selectedCellKeys.map(cell => columnLookup.get(cell.columnKey).index));\n    const minRowIndex = Math.min(...selectedCellKeys.map(cell => rowLookup.get(cell.rowKey).index));\n    const maxRowIndex = Math.max(...selectedCellKeys.map(cell => rowLookup.get(cell.rowKey).index));\n\n    const stringBuilder = [];\n\n    for (let rowIndex = minRowIndex; rowIndex <= maxRowIndex; rowIndex++) {\n        const row = rows[rowIndex];\n        const rowKey = row.key;\n\n        if (!selectedRows.has(rowKey))\n            continue;\n\n        for (let columnIndex = minColumnIndex; columnIndex <= maxColumnIndex; columnIndex++) {\n            const column = columns[columnIndex];\n            const columnKey = column.key;\n\n            if (!selectedColumns.has(columnKey))\n                continue;\n\n            if (selection.isKeySelected(rowKey, columnKey)) {\n                const cellData = formatResolver.resolve(row, column).text;\n                stringBuilder.push(cellData);\n            }\n\n            if (columnIndex < maxColumnIndex)\n                stringBuilder.push('\\t');\n        }\n\n        if (rowIndex < maxRowIndex)\n            stringBuilder.push('\\n');\n    }\n\n    return stringBuilder.join('');\n}",
         "// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n",
         "// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};",
         "// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};",
         "__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))",
         "// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};",
-        "var getCurrentScript = function() {\n    var script = document.currentScript;\n    if (!script) {\n        /* Shim for IE11 and below */\n        /* Do not take into account async scripts and inline scripts */\n\n        var doc_scripts = document.getElementsByTagName('script');\n        var scripts = [];\n\n        for (var i = 0; i < doc_scripts.length; i++) {\n            scripts.push(doc_scripts[i]);\n        }\n\n        scripts = scripts.filter(function(s) { return !s.async && !s.text && !s.textContent; });\n        script = scripts.slice(-1)[0];\n    }\n\n    return script;\n};\n\nvar isLocalScript = function(script) {\n    return /\\/_dash-component-suites\\//.test(script.src);\n};\n\nObject.defineProperty(__webpack_require__, 'p', {\n    get: (function () {\n        var script = getCurrentScript();\n\n        var url = script.src.split('/').slice(0, -1).join('/') + '/';\n\n        return function() {\n            return url;\n        };\n    })()\n});\n\nif (typeof jsonpScriptSrc !== 'undefined') {\n    var __jsonpScriptSrc__ = jsonpScriptSrc;\n    jsonpScriptSrc = function(chunkId) {\n        var script = getCurrentScript();\n        var isLocal = isLocalScript(script);\n\n        var src = __jsonpScriptSrc__(chunkId);\n\n        if(!isLocal) {\n            return src;\n        }\n\n        var srcFragments = src.split('/');\n        var fileFragments = srcFragments.slice(-1)[0].split('.');\n\n        fileFragments.splice(1, 0, \"v0_0_1m1705586879\");\n        srcFragments.splice(-1, 1, fileFragments.join('.'))\n\n        return srcFragments.join('/');\n    };\n}\n"
+        "var getCurrentScript = function() {\n    var script = document.currentScript;\n    if (!script) {\n        /* Shim for IE11 and below */\n        /* Do not take into account async scripts and inline scripts */\n\n        var doc_scripts = document.getElementsByTagName('script');\n        var scripts = [];\n\n        for (var i = 0; i < doc_scripts.length; i++) {\n            scripts.push(doc_scripts[i]);\n        }\n\n        scripts = scripts.filter(function(s) { return !s.async && !s.text && !s.textContent; });\n        script = scripts.slice(-1)[0];\n    }\n\n    return script;\n};\n\nvar isLocalScript = function(script) {\n    return /\\/_dash-component-suites\\//.test(script.src);\n};\n\nObject.defineProperty(__webpack_require__, 'p', {\n    get: (function () {\n        var script = getCurrentScript();\n\n        var url = script.src.split('/').slice(0, -1).join('/') + '/';\n\n        return function() {\n            return url;\n        };\n    })()\n});\n\nif (typeof jsonpScriptSrc !== 'undefined') {\n    var __jsonpScriptSrc__ = jsonpScriptSrc;\n    jsonpScriptSrc = function(chunkId) {\n        var script = getCurrentScript();\n        var isLocal = isLocalScript(script);\n\n        var src = __jsonpScriptSrc__(chunkId);\n\n        if(!isLocal) {\n            return src;\n        }\n\n        var srcFragments = src.split('/');\n        var fileFragments = srcFragments.slice(-1)[0].split('.');\n\n        fileFragments.splice(1, 0, \"v0_0_2m1712389557\");\n        srcFragments.splice(-1, 1, fileFragments.join('.'))\n\n        return srcFragments.join('/');\n    };\n}\n"
     ],
     "version": 3
 }
```

### Comparing `dash_spread_grid-0.0.1/dash_spread_grid/metadata.json` & `dash_spread_grid-0.0.2/dash_spread_grid/metadata.json`

 * *Files 26% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9607747395833333%*

 * *Differences: {"'src/lib/components/DashSpreadGrid.jsx'": "{'props': {'data': {'type': {'name': 'any'}}, "*

 * *                                            "'columns': {'defaultValue': {'value': '[{ "*

 * *                                            '"type": "DATA-BLOCK" }]\'}}, \'rows\': '*

 * *                                            '{\'defaultValue\': {\'value\': \'[{ "type": "HEADER" '*

 * *                                            '}, { "type": "DATA-BLOCK" }]\'}}, \'setProps\': '*

 * *                                            "Orde […]*

```diff
@@ -1,46 +1,156 @@
 {
     "src/lib/components/DashSpreadGrid.jsx": {
         "description": "",
         "displayName": "DashSpreadGrid",
         "methods": [],
         "props": {
-            "columns": {
+            "borderWidth": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "1"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "number"
+                }
+            },
+            "clicked_cell": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "null"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "object"
+                }
+            },
+            "clicked_custom_cell": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "null"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "object"
+                }
+            },
+            "columnWidths": {
                 "defaultValue": {
                     "computed": false,
                     "value": "[]"
                 },
                 "description": "",
                 "required": false,
                 "type": {
                     "name": "array"
                 }
             },
+            "columns": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "[{ \"type\": \"DATA-BLOCK\" }]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "array"
+                }
+            },
             "data": {
                 "defaultValue": {
                     "computed": false,
                     "value": "[]"
                 },
                 "description": "",
                 "required": false,
                 "type": {
+                    "name": "any"
+                }
+            },
+            "dataSelector": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "\"data[row.id][column.id]\""
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "string"
+                }
+            },
+            "editedCells": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "[]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "array"
+                }
+            },
+            "filtering": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "[]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "array"
+                }
+            },
+            "filters": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "[]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
                     "name": "array"
                 }
             },
+            "focusedCell": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "null"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "object"
+                }
+            },
             "formatting": {
                 "defaultValue": {
                     "computed": false,
                     "value": "[]"
                 },
                 "description": "",
                 "required": false,
                 "type": {
                     "name": "array"
                 }
             },
+            "highlightedCells": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "[]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "array"
+                }
+            },
             "id": {
                 "description": "",
                 "required": false,
                 "type": {
                     "name": "string"
                 }
             },
@@ -84,17 +194,68 @@
                 },
                 "description": "",
                 "required": false,
                 "type": {
                     "name": "number"
                 }
             },
+            "rowHeights": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "[]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "array"
+                }
+            },
             "rows": {
                 "defaultValue": {
                     "computed": false,
+                    "value": "[{ \"type\": \"HEADER\" }, { \"type\": \"DATA-BLOCK\" }]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "array"
+                }
+            },
+            "selectedCells": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "[]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "array"
+                }
+            },
+            "setProps": {
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "func"
+                }
+            },
+            "sortBy": {
+                "defaultValue": {
+                    "computed": false,
+                    "value": "[]"
+                },
+                "description": "",
+                "required": false,
+                "type": {
+                    "name": "array"
+                }
+            },
+            "sorting": {
+                "defaultValue": {
+                    "computed": false,
                     "value": "[]"
                 },
                 "description": "",
                 "required": false,
                 "type": {
                     "name": "array"
                 }
```

### Comparing `dash_spread_grid-0.0.1/dash_spread_grid/package-info.json` & `dash_spread_grid-0.0.2/dash_spread_grid/package-info.json`

 * *Files 16% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.8645833333333333%*

 * *Differences: {"'dependencies'": "{'js-spread-grid': 'file:../lib'}",*

 * * "'devDependencies'": "{'npm-watch': '^0.11.0'}",*

 * * "'scripts'": "{'build': 'npm run build:js && npm run build:backends', 'watch': 'npm-watch', "*

 * *              "delete: ['copy-source']}",*

 * * "'version'": "'0.0.2'",*

 * * "'watch'": "OrderedDict([('build', OrderedDict([('patterns', ['../lib/**/*', "*

 * *            "'./src/lib/**/*'])]))])"}*

```diff
@@ -1,13 +1,14 @@
 {
     "author": "Tomasz Rewak <tomasz.rewak@gmail.com>",
     "bugs": {
         "url": "https://github.com/https://github.com/TomaszRewak/js-spread-grid/dash-spread-grid/issues"
     },
     "dependencies": {
+        "js-spread-grid": "file:../lib",
         "ramda": "^0.26.1"
     },
     "description": "Fast grid for Dash applications",
     "devDependencies": {
         "@babel/core": "^7.22.1",
         "@babel/plugin-proposal-object-rest-spread": "^7.20.7",
         "@babel/preset-env": "^7.22.2",
@@ -18,14 +19,15 @@
         "babel-loader": "^9.1.2",
         "copyfiles": "^2.1.1",
         "css-loader": "^6.8.1",
         "eslint": "^6.0.1",
         "eslint-config-prettier": "^6.0.0",
         "eslint-plugin-import": "^2.18.0",
         "eslint-plugin-react": "^7.14.2",
+        "npm-watch": "^0.11.0",
         "prop-types": "^15.8.1",
         "react": "^16.8.6",
         "react-docgen": "^5.4.3",
         "react-dom": "^16.8.6",
         "style-loader": "^3.3.3",
         "styled-jsx": "^5.1.2",
         "webpack": "^5.84.1",
@@ -41,19 +43,27 @@
     "main": "build/index.js",
     "name": "dash_spread_grid",
     "repository": {
         "type": "git",
         "url": "git://github.com/https://github.com/TomaszRewak/js-spread-grid/dash-spread-grid.git"
     },
     "scripts": {
-        "build": "npm run copy-source && npm run build:js && npm run build:backends",
+        "build": "npm run build:js && npm run build:backends",
         "build:activated": "npm run build:js && npm run build:backends-activated",
         "build:backends": "dash-generate-components ./src/lib/components dash_spread_grid -p package-info.json --r-prefix '' --jl-prefix '' --ignore \\.test\\.",
         "build:backends-activated": "(. venv/bin/activate || venv\\scripts\\activate && npm run build:backends)",
         "build:js": "webpack --mode production",
-        "copy-source": "rsync -a --delete ./../lib/src/ ./src/lib/lib",
         "prepublishOnly": "npm run validate-init",
         "start": "webpack serve --config ./webpack.serve.config.js --open",
-        "validate-init": "python _validate_init.py"
+        "validate-init": "python _validate_init.py",
+        "watch": "npm-watch"
     },
-    "version": "0.0.1"
+    "version": "0.0.2",
+    "watch": {
+        "build": {
+            "patterns": [
+                "../lib/**/*",
+                "./src/lib/**/*"
+            ]
+        }
+    }
 }
```

### Comparing `dash_spread_grid-0.0.1/package.json` & `dash_spread_grid-0.0.2/package.json`

 * *Files 16% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.8645833333333333%*

 * *Differences: {"'dependencies'": "{'js-spread-grid': 'file:../lib'}",*

 * * "'devDependencies'": "{'npm-watch': '^0.11.0'}",*

 * * "'scripts'": "{'build': 'npm run build:js && npm run build:backends', 'watch': 'npm-watch', "*

 * *              "delete: ['copy-source']}",*

 * * "'version'": "'0.0.2'",*

 * * "'watch'": "OrderedDict([('build', OrderedDict([('patterns', ['../lib/**/*', "*

 * *            "'./src/lib/**/*'])]))])"}*

```diff
@@ -1,13 +1,14 @@
 {
     "author": "Tomasz Rewak <tomasz.rewak@gmail.com>",
     "bugs": {
         "url": "https://github.com/https://github.com/TomaszRewak/js-spread-grid/dash-spread-grid/issues"
     },
     "dependencies": {
+        "js-spread-grid": "file:../lib",
         "ramda": "^0.26.1"
     },
     "description": "Fast grid for Dash applications",
     "devDependencies": {
         "@babel/core": "^7.22.1",
         "@babel/plugin-proposal-object-rest-spread": "^7.20.7",
         "@babel/preset-env": "^7.22.2",
@@ -18,14 +19,15 @@
         "babel-loader": "^9.1.2",
         "copyfiles": "^2.1.1",
         "css-loader": "^6.8.1",
         "eslint": "^6.0.1",
         "eslint-config-prettier": "^6.0.0",
         "eslint-plugin-import": "^2.18.0",
         "eslint-plugin-react": "^7.14.2",
+        "npm-watch": "^0.11.0",
         "prop-types": "^15.8.1",
         "react": "^16.8.6",
         "react-docgen": "^5.4.3",
         "react-dom": "^16.8.6",
         "style-loader": "^3.3.3",
         "styled-jsx": "^5.1.2",
         "webpack": "^5.84.1",
@@ -41,19 +43,27 @@
     "main": "build/index.js",
     "name": "dash_spread_grid",
     "repository": {
         "type": "git",
         "url": "git://github.com/https://github.com/TomaszRewak/js-spread-grid/dash-spread-grid.git"
     },
     "scripts": {
-        "build": "npm run copy-source && npm run build:js && npm run build:backends",
+        "build": "npm run build:js && npm run build:backends",
         "build:activated": "npm run build:js && npm run build:backends-activated",
         "build:backends": "dash-generate-components ./src/lib/components dash_spread_grid -p package-info.json --r-prefix '' --jl-prefix '' --ignore \\.test\\.",
         "build:backends-activated": "(. venv/bin/activate || venv\\scripts\\activate && npm run build:backends)",
         "build:js": "webpack --mode production",
-        "copy-source": "rsync -a --delete ./../lib/src/ ./src/lib/lib",
         "prepublishOnly": "npm run validate-init",
         "start": "webpack serve --config ./webpack.serve.config.js --open",
-        "validate-init": "python _validate_init.py"
+        "validate-init": "python _validate_init.py",
+        "watch": "npm-watch"
     },
-    "version": "0.0.1"
+    "version": "0.0.2",
+    "watch": {
+        "build": {
+            "patterns": [
+                "../lib/**/*",
+                "./src/lib/**/*"
+            ]
+        }
+    }
 }
```

